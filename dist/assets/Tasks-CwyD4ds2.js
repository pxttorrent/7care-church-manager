import{j as e}from"./ui-CM4P41nz.js";import{r as a}from"./vendor-v6ZOr5pf.js";import{u as s}from"./useQuery-Ch0dz-gl.js";import{l as t,j as r,k as i,B as l,e as n,R as o,E as d,L as c,I as h,p as m,q as x,r as u,s as p,t as g,C as j,c as f,a4 as v,z as y,N as w,a5 as b,v as N}from"./index-wQAh2xV3.js";import{D as k,e as _,a as C,b as S,c as T}from"./dialog-CosrN6Qx.js";import{T as E}from"./textarea-DRMoHGlL.js";import{T as D,a as z,b as O,c as P}from"./tabs-DndNxMBw.js";import{C as L}from"./checkbox-B6VJZFwT.js";import{n as M}from"./notificationService-Bb4GK-tC.js";import{S as I}from"./search-c4lXAa39.js";import{T as F}from"./trash-2-CQjjeqgH.js";import{C as $}from"./clock-BP2d947I.js";import{C as B}from"./circle-alert-nQs_Z4xR.js";import"./charts-56rtB2he.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=t("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),A=t("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]),q=t("SquareCheck",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),J=t("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),R=t("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),K=t("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),H={high:{color:"bg-red-50 text-red-700 border-red-200",icon:e.jsx(B,{className:"h-3 w-3"}),label:"Alta"},medium:{color:"bg-yellow-50 text-yellow-700 border-yellow-200",icon:e.jsx($,{className:"h-3 w-3"}),label:"Média"},low:{color:"bg-green-50 text-green-700 border-green-200",icon:e.jsx(v,{className:"h-3 w-3"}),label:"Baixa"}},W={pending:{color:"bg-gray-50 text-gray-700 border-gray-200",icon:e.jsx(v,{className:"h-3 w-3"}),label:"Pendente"},in_progress:{color:"bg-blue-50 text-blue-700 border-blue-200",icon:e.jsx($,{className:"h-3 w-3"}),label:"Em Progresso"},completed:{color:"bg-green-50 text-green-700 border-green-200",icon:e.jsx(w,{className:"h-3 w-3"}),label:"Concluída"}},G="/api/google-sheets/proxy",U="1i-x-0KiciwACRztoKX-YHlXT4FsrAzaKwuH-hHkD8go",X="tarefas";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function Q(){r();const[t,B]=a.useState(""),[Q,Y]=a.useState("all"),[Z,ee]=a.useState("all"),[ae,se]=a.useState("date"),[te,re]=a.useState(!1),[ie,le]=a.useState(!1),[ne,oe]=a.useState(null),[de,ce]=a.useState([]),[he,me]=a.useState({title:"",description:"",priority:"medium",due_date:"",assigned_to:"none",church:"",tags:[]}),[xe,ue]=a.useState(navigator.onLine),{data:pe,isLoading:ge,refetch:je}=s({queryKey:["tasks"],queryFn:async()=>{const e=await fetch(G,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify({action:"getTasks",spreadsheetId:U,sheetName:X})});if(!e.ok)throw new Error("Erro ao buscar tarefas do Google Sheets");return((await e.json()).tasks||[]).map(e=>({id:e.id,title:e.titulo||"",description:e.descricao||"",status:"Concluída"===e.status?"completed":"Em Progresso"===e.status?"in_progress":"pending",priority:"Alta"===e.prioridade?"high":"Baixa"===e.prioridade?"low":"medium",assigned_to_name:e.responsavel||"",created_by_name:e.criador||"",church:e.igreja||"",created_at:e.data_criacao?new Date(e.data_criacao.split("/").reverse().join("-")).toISOString():(new Date).toISOString(),updated_at:(new Date).toISOString(),due_date:e.data_vencimento||"",completed_at:e.data_conclusao||"",tags:e.tags?e.tags.split(",").filter(Boolean):[]}))},staleTime:12e4,refetchInterval:3e5,refetchOnWindowFocus:!1}),fe=pe||[];a.useEffect(()=>{const e=()=>ue(!0),a=()=>ue(!1);return window.addEventListener("online",e),window.addEventListener("offline",a),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",a)}},[]),a.useEffect(()=>{ce([])},[t,Q,Z]);const ve=async e=>{if(xe)try{const a={id:e.id,titulo:e.title,descricao:e.description||"",status:"completed"===e.status?"Concluída":"in_progress"===e.status?"Em Progresso":"Pendente",prioridade:"high"===e.priority?"Alta":"low"===e.priority?"Baixa":"Média",responsavel:e.assigned_to_name||"Sistema",criador:e.created_by_name||"App",igreja:e.church||"",data_criacao:new Date(e.created_at).toLocaleDateString("pt-BR"),data_vencimento:e.due_date?new Date(e.due_date).toLocaleDateString("pt-BR"):"",data_conclusao:e.completed_at?new Date(e.completed_at).toLocaleDateString("pt-BR"):"",tags:e.tags?.join(",")||""},s=await fetch(G,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify({action:"addTask",spreadsheetId:U,sheetName:X,taskData:a})});if(s.ok){(await s.json()).success}}catch(a){}},ye=async e=>{if(xe)try{const a=await fetch("/api/tasks",{headers:{"x-user-id":"1"}});if(a.ok){const s=(await a.json()).tasks||[];if(!s.find(a=>a.id===e.id))return}await fetch(G,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify({action:"deleteTask",spreadsheetId:U,sheetName:X,taskId:e.id})});await ve(e)}catch(a){}},we=async e=>{if(xe)try{const a=await fetch(G,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify({action:"deleteTask",spreadsheetId:U,sheetName:X,taskId:e})});if(a.ok){(await a.json()).success}}catch(a){}},be=e=>{ce(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])},{data:Ne}=s({queryKey:["tasks-users"],queryFn:async()=>{const e=await fetch("/api/tasks/users",{headers:{"x-user-id":"1"}});if(!e.ok)throw new Error("Erro ao buscar usuários");return e.json()}}),ke=Ne?.users||[],_e=[...fe.filter(e=>{if(!e||!e.id)return!1;const a=(e.title||"").toLowerCase().includes(t.toLowerCase())||(e.description||"").toLowerCase().includes(t.toLowerCase())||(e.assigned_to_name||"").toLowerCase().includes(t.toLowerCase())||(e.church||"").toLowerCase().includes(t.toLowerCase()),s="all"===Z||e.status===Z,r="all"===Q||e.priority===Q;return a&&s&&r})].sort((e,a)=>{if("priority"===ae){const s={high:3,medium:2,low:1};return s[a.priority]-s[e.priority]}{const s=new Date(e.created_at||0).getTime();return new Date(a.created_at||0).getTime()-s}}),Ce=_e.filter(e=>"pending"===e.status),Se=_e.filter(e=>"in_progress"===e.status),Te=_e.filter(e=>"completed"===e.status),Ee=({task:a})=>{const s=!1===a._synced||!0===a._localCreated,t=de.includes(a.id);return e.jsxs(j,{className:`group relative overflow-hidden bg-white border-0 shadow-sm hover:shadow-md transition-shadow duration-200 mb-4 ${s?"border-l-4 border-l-yellow-400":""} ${t?"ring-2 ring-blue-500 shadow-xl":""}`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-50/50 to-white opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx(f,{className:"p-6 relative z-10",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("button",{onClick:()=>(async e=>{const a="completed"===e.status?"pending":"completed";try{if(!(await fetch(`/api/tasks/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify({status:a,completed_at:"completed"===a?(new Date).toISOString():void 0})})).ok)throw new Error("Erro ao atualizar");const s={...e,status:a,completed_at:"completed"===a?(new Date).toISOString():void 0};await ye(s),await je()}catch(s){y.error("Erro ao alterar status")}})(a),className:"flex-shrink-0 transition-all duration-200 hover:scale-110",children:"completed"===a.status?e.jsx(w,{className:"h-5 w-5 text-green-500"}):e.jsx(v,{className:"h-5 w-5 text-gray-300 hover:text-gray-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:a.title}),s&&e.jsxs(l,{className:"bg-yellow-100 text-yellow-700 border-yellow-200 text-xs",children:[e.jsx(b,{className:"h-2 w-2 mr-1"}),"Offline"]})]}),a.description&&e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsxs(l,{className:`${W[a.status].color} border`,children:[W[a.status].icon,e.jsx("span",{className:"ml-1",children:W[a.status].label})]}),e.jsxs(l,{className:`${H[a.priority].color} border`,children:[H[a.priority].icon,e.jsx("span",{className:"ml-1",children:H[a.priority].label})]}),a.assigned_to_name&&e.jsxs(l,{className:"bg-blue-50 text-blue-700 border-blue-200",children:[e.jsx(N,{className:"h-3 w-3 mr-1"}),a.assigned_to_name]}),a.church&&e.jsxs(l,{className:"bg-purple-50 text-purple-700 border-purple-200",children:["🏛️ ",a.church]})]}),a.tags&&a.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:a.tags.map((a,s)=>e.jsxs(l,{variant:"outline",className:"text-xs",children:[e.jsx(J,{className:"h-2 w-2 mr-1"}),a]},s))})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(n,{onClick:()=>(e=>{oe(e),le(!0)})(a),variant:"ghost",size:"sm",className:"h-9 px-3 text-gray-600 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200",children:[e.jsx(A,{className:"h-4 w-4 mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Editar"})]}),e.jsxs(n,{onClick:()=>(async e=>{if(confirm("Tem certeza que deseja deletar esta tarefa?"))try{const a=await fetch(`/api/tasks/${e}`,{method:"DELETE",headers:{"x-user-id":"1"}});if(!a.ok&&404!==a.status)throw new Error("Erro ao deletar tarefa");await we(e),await je(),y.success("Tarefa deletada!")}catch(a){y.error(`Erro ao deletar: ${a.message}`)}})(a.id),variant:"ghost",size:"sm",className:"h-9 px-3 text-gray-600 hover:text-red-600 hover:bg-red-50 transition-all duration-200",children:[e.jsx(F,{className:"h-4 w-4 mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Deletar"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-md hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>be(a.id),children:[e.jsx("span",{className:"text-sm text-gray-600 hidden sm:inline",children:"Selecionar"}),e.jsx(L,{checked:t,onCheckedChange:()=>be(a.id),className:"flex-shrink-0","aria-label":`Selecionar tarefa ${a.title}`,onClick:e=>e.stopPropagation()})]})]})]})})]})},De=({icon:a,title:s,description:t})=>e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex p-4 rounded-full bg-gray-100 mb-4",children:e.jsx(a,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:s}),e.jsx("p",{className:"text-gray-500 max-w-sm mx-auto",children:t})]});return ge?e.jsx(i,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})})})}):e.jsx(i,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-6 mb-8",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent",children:"Tarefas"}),xe?e.jsxs(l,{className:"bg-green-100 text-green-700 border-green-200 flex items-center gap-1",children:[e.jsx(K,{className:"h-3 w-3"}),"Online"]}):e.jsxs(l,{className:"bg-yellow-100 text-yellow-700 border-yellow-200 flex items-center gap-1",children:[e.jsx(R,{className:"h-3 w-3"}),"Offline"]})]}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Organize e acompanhe suas tarefas"})]}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>(async(e=!1)=>{if(xe)try{e&&y.info("Sincronizando..."),await je(),e&&y.success("Sincronizado!")}catch(a){e&&y.error("Erro ao sincronizar")}else e&&y.error("Você está offline")})(!0),className:"flex items-center gap-2 bg-green-50 hover:bg-green-100 text-green-700 border-green-200",title:"Sincronizar do Google Sheets manualmente",children:[e.jsx(o,{className:"h-4 w-4"}),"Sincronizar"]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>window.open("/settings","_blank"),className:"flex items-center gap-2",children:[e.jsx(d,{className:"h-4 w-4"}),"Configurar"]}),e.jsxs(k,{open:te,onOpenChange:re,children:[e.jsx(_,{asChild:!0,children:e.jsxs(n,{className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white shadow-lg hover:shadow-xl transition-all duration-300 px-6 py-3",children:[e.jsx(V,{className:"h-5 w-5 mr-2"}),"Nova Tarefa"]})}),e.jsxs(C,{className:"max-w-md",children:[e.jsx(S,{children:e.jsx(T,{className:"text-xl font-semibold",children:"Nova Tarefa"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"title",children:"Título *"}),e.jsx(h,{id:"title",value:he.title,onChange:e=>me({...he,title:e.target.value}),placeholder:"Digite o título da tarefa",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"description",children:"Descrição"}),e.jsx(E,{id:"description",value:he.description,onChange:e=>me({...he,description:e.target.value}),placeholder:"Descreva a tarefa em detalhes",className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"priority",children:"Prioridade"}),e.jsxs(m,{value:he.priority,onValueChange:e=>me({...he,priority:e}),children:[e.jsx(x,{className:"mt-1",children:e.jsx(u,{})}),e.jsxs(p,{children:[e.jsx(g,{value:"low",children:"Baixa"}),e.jsx(g,{value:"medium",children:"Média"}),e.jsx(g,{value:"high",children:"Alta"})]})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"due_date",children:"Vencimento"}),e.jsx(h,{id:"due_date",type:"date",value:he.due_date,onChange:e=>me({...he,due_date:e.target.value}),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"assigned_to",children:"Responsável"}),e.jsxs(m,{value:he.assigned_to,onValueChange:e=>me({...he,assigned_to:e}),children:[e.jsx(x,{className:"mt-1",children:e.jsx(u,{placeholder:"Selecione"})}),e.jsxs(p,{children:[e.jsx(g,{value:"none",children:"Sem responsável"}),ke.map(a=>e.jsx(g,{value:a.id.toString(),children:a.name},a.id))]})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"church",children:"Igreja"}),e.jsx(h,{id:"church",value:he.church,onChange:e=>me({...he,church:e.target.value}),placeholder:"Digite o nome da igreja",className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(n,{variant:"outline",onClick:()=>re(!1),children:"Cancelar"}),e.jsx(n,{onClick:async()=>{if(he.title.trim())try{const a={title:he.title,description:he.description,priority:he.priority,due_date:he.due_date||void 0,assigned_to:he.assigned_to&&"none"!==he.assigned_to?parseInt(he.assigned_to):void 0,church:he.church||void 0,status:"pending",created_by:1,tags:he.tags},s=await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify(a)});if(!s.ok)throw new Error("Erro ao criar tarefa");const t=await s.json(),r=t.task||t;if(r&&await ve(r),await je(),re(!1),me({title:"",description:"",priority:"medium",due_date:"",assigned_to:"none",church:"",tags:[]}),y.success("Tarefa criada!"),he.assigned_to&&"none"!==he.assigned_to)try{await M.notifyTaskCreated(he.title,parseInt(he.assigned_to))}catch(e){}}catch(e){y.error("Erro ao criar tarefa")}else y.error("Título é obrigatório")},className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:"Criar Tarefa"})]})]})]})]})]})]}),e.jsx(j,{className:"mb-8 border-0 shadow-sm",children:e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx(h,{placeholder:"Buscar tarefas...",value:t,onChange:e=>B(e.target.value),className:"pl-12 h-12 text-base"})]})}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsxs(m,{value:Z,onValueChange:ee,children:[e.jsx(x,{className:"w-40",children:e.jsx(u,{placeholder:"Status"})}),e.jsxs(p,{children:[e.jsx(g,{value:"all",children:"Todos"}),e.jsx(g,{value:"pending",children:"Pendentes"}),e.jsx(g,{value:"in_progress",children:"Em Progresso"}),e.jsx(g,{value:"completed",children:"Concluídas"})]})]}),e.jsxs(m,{value:Q,onValueChange:Y,children:[e.jsx(x,{className:"w-40",children:e.jsx(u,{placeholder:"Prioridade"})}),e.jsxs(p,{children:[e.jsx(g,{value:"all",children:"Todas"}),e.jsx(g,{value:"high",children:"Alta"}),e.jsx(g,{value:"medium",children:"Média"}),e.jsx(g,{value:"low",children:"Baixa"})]})]}),e.jsxs(m,{value:ae,onValueChange:se,children:[e.jsx(x,{className:"w-48",children:e.jsx(u,{placeholder:"Ordenar por"})}),e.jsxs(p,{children:[e.jsx(g,{value:"date",children:"Data de Lançamento"}),e.jsx(g,{value:"priority",children:"Prioridade"})]})]})]})]})})}),_e.length>0&&e.jsx(j,{className:"mb-6 border-blue-200 bg-gradient-to-r from-blue-50 to-white shadow-md",children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{checked:de.length===_e.length&&_e.length>0,onCheckedChange:()=>{de.length===_e.length?ce([]):ce(_e.map(e=>e.id))},className:"flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:de.length>0?`${de.length} selecionada${de.length>1?"s":""}`:"Selecionar todas"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[_e.length," tarefa",_e.length>1?"s":""," disponível",_e.length>1?"is":""]})]})]}),de.length>0&&e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>ce([]),className:"flex-1 sm:flex-none",children:"Desmarcar"}),e.jsxs(n,{variant:"destructive",size:"sm",onClick:async()=>{if(0===de.length)return void y.error("Selecione pelo menos uma tarefa");const e=de.length;if(confirm(`Deletar ${e} tarefa${e>1?"s":""}?`))try{for(const e of de)await fetch(`/api/tasks/${e}`,{method:"DELETE",headers:{"x-user-id":"1"}}),await we(e);await je(),ce([]),y.success(`${e} tarefa${e>1?"s deletadas":" deletada"}!`)}catch(a){y.error(`Erro: ${a.message}`)}},className:"flex-1 sm:flex-none bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Deletar (",de.length,")"]})]})]})})}),e.jsxs(D,{defaultValue:"pending",className:"space-y-6",children:[e.jsxs(z,{className:"grid w-full grid-cols-3 bg-white border shadow-sm",children:[e.jsxs(O,{value:"pending",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700",children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),"Pendentes (",Ce.length,")"]}),e.jsxs(O,{value:"in_progress",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Em Progresso (",Se.length,")"]}),e.jsxs(O,{value:"completed",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Concluídas (",Te.length,")"]})]}),e.jsx(P,{value:"pending",className:"space-y-4",children:0===Ce.length?e.jsx(De,{icon:v,title:"Nenhuma tarefa pendente",description:"Crie uma nova tarefa para começar"}):Ce.map(a=>e.jsx(Ee,{task:a},a.id))}),e.jsx(P,{value:"in_progress",className:"space-y-4",children:0===Se.length?e.jsx(De,{icon:$,title:"Nenhuma tarefa em progresso",description:"Mova tarefas pendentes para começar"}):Se.map(a=>e.jsx(Ee,{task:a},a.id))}),e.jsx(P,{value:"completed",className:"space-y-4",children:0===Te.length?e.jsx(De,{icon:q,title:"Nenhuma tarefa concluída",description:"Complete tarefas para vê-las aqui"}):Te.map(a=>e.jsx(Ee,{task:a},a.id))})]}),e.jsx(k,{open:ie,onOpenChange:le,children:e.jsxs(C,{className:"max-w-md",children:[e.jsx(S,{children:e.jsx(T,{className:"text-xl font-semibold",children:"Editar Tarefa"})}),ne&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"edit-title",children:"Título *"}),e.jsx(h,{id:"edit-title",value:ne.title,onChange:e=>oe({...ne,title:e.target.value}),placeholder:"Digite o título",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"edit-description",children:"Descrição"}),e.jsx(E,{id:"edit-description",value:ne.description||"",onChange:e=>oe({...ne,description:e.target.value}),placeholder:"Descreva a tarefa",className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"edit-priority",children:"Prioridade"}),e.jsxs(m,{value:ne.priority,onValueChange:e=>oe({...ne,priority:e}),children:[e.jsx(x,{className:"mt-1",children:e.jsx(u,{})}),e.jsxs(p,{children:[e.jsx(g,{value:"low",children:"Baixa"}),e.jsx(g,{value:"medium",children:"Média"}),e.jsx(g,{value:"high",children:"Alta"})]})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"edit-due_date",children:"Vencimento"}),e.jsx(h,{id:"edit-due_date",type:"date",value:ne.due_date?ne.due_date.split("T")[0]:"",onChange:e=>oe({...ne,due_date:e.target.value}),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"edit-status",children:"Status"}),e.jsxs(m,{value:ne.status,onValueChange:e=>oe({...ne,status:e}),children:[e.jsx(x,{className:"mt-1",children:e.jsx(u,{})}),e.jsxs(p,{children:[e.jsx(g,{value:"pending",children:"Pendente"}),e.jsx(g,{value:"in_progress",children:"Em Progresso"}),e.jsx(g,{value:"completed",children:"Concluída"})]})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"edit-assigned_to",children:"Responsável"}),e.jsxs(m,{value:ne.assigned_to?.toString()||"none",onValueChange:e=>oe({...ne,assigned_to:"none"===e?void 0:parseInt(e)}),children:[e.jsx(x,{className:"mt-1",children:e.jsx(u,{placeholder:"Selecione"})}),e.jsxs(p,{children:[e.jsx(g,{value:"none",children:"Sem responsável"}),ke.map(a=>e.jsx(g,{value:a.id.toString(),children:a.name},a.id))]})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"edit-church",children:"Igreja"}),e.jsx(h,{id:"edit-church",value:ne.church||"",onChange:e=>oe({...ne,church:e.target.value}),placeholder:"Digite o nome da igreja",className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(n,{variant:"outline",onClick:()=>le(!1),children:"Cancelar"}),e.jsx(n,{onClick:async()=>{if(ne)try{const e={title:ne.title,description:ne.description,priority:ne.priority,due_date:ne.due_date,assigned_to:ne.assigned_to,church:ne.church,status:ne.status};if(!(await fetch(`/api/tasks/${ne.id}`,{method:"PUT",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify(e)})).ok)throw new Error("Erro ao atualizar tarefa");await ye(ne),await je(),le(!1),oe(null),y.success("Tarefa atualizada!")}catch(e){y.error("Erro ao atualizar tarefa")}},className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:"Salvar"})]})]})]})})]})})})}export{Q as default};
