import{j as e}from"./ui-CjtgSbkP.js";import{r as s}from"./vendor-v6ZOr5pf.js";import{o as a,f as i,g as r,m as t,u as n,n as d,e as l,R as o,C as c,c as m,U as u,I as x,s as h,t as p,v as j,w as v,x as g,B as f,G as y,_ as b,ad as N,M as w,X as q,H as k,a as C,b as I,a5 as E}from"./index-CigaphnB.js";import{A as S,a as z,b as K}from"./avatar-CprZfyfA.js";import{u as M}from"./useQuery-BlPiZsKJ.js";import{u as A}from"./useMutation-Dh0yXmv-.js";import{M as Q,d as D,e as F}from"./mount-icon-qvX6CSGq.js";import{C as R}from"./circle-alert-BDqDehei.js";import{S as B}from"./search-CbGxZwFP.js";import{C as L}from"./clock-Bk5l3R-k.js";import{M as T}from"./map-pin-BGwQ5IID.js";import{T as P}from"./target-DNLWPx7i.js";import{C as $}from"./circle-x-L5fN3HvX.js";import"./charts-56rtB2he.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=a("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);function U(){const{user:a}=i(),{toast:U}=r(),V=t(),G=n(),[H,J]=s.useState(""),[_,W]=s.useState("all"),[X,Y]=s.useState("my"),[Z,ee]=s.useState(!1),[se,ae]=s.useState(null),[ie,re]=s.useState(""),[te,ne]=s.useState("all"),[de,le]=s.useState(!1),[oe,ce]=s.useState(null),[me,ue]=s.useState(""),{data:xe=[],isLoading:he}=M({queryKey:["church-interested",a?.id],queryFn:async()=>{if(!a?.id)return[];const e=await fetch("/api/my-interested",{headers:{"x-user-id":a.id.toString()}});if(!e.ok)throw new Error("Erro ao buscar interessados da igreja");return e.json()},enabled:!!a?.id&&"admin"!==a?.role}),{data:pe=[],isLoading:je}=M({queryKey:["my-relationships",a?.id],queryFn:async()=>{if(!a?.id)return[];const e=await fetch(`/api/relationships?missionaryId=${a.id}`);if(!e.ok)throw new Error("Erro ao buscar relacionamentos");return e.json()},enabled:!!a?.id}),{data:ve=[],isLoading:ge}=M({queryKey:["my-discipleship-requests",a?.id],queryFn:async()=>{if(!a?.id)return[];const e=await fetch(`/api/discipleship-requests?missionaryId=${a.id}`);if(!e.ok)throw new Error("Erro ao buscar solicitações");return e.json()},enabled:!!a?.id}),{data:fe=[],isLoading:ye}=M({queryKey:["all-discipleship-requests"],queryFn:async()=>{const e=await fetch("/api/discipleship-requests");if(!e.ok)throw new Error("Erro ao buscar solicitações");return e.json()}}),{data:be=[],isLoading:Ne}=M({queryKey:["all-relationships"],queryFn:async()=>{const e=await fetch("/api/relationships");if(!e.ok)throw new Error("Erro ao buscar relacionamentos");return e.json()}}),{data:we=[],isLoading:qe}=M({queryKey:["all-users"],queryFn:async()=>{const e=await fetch("/api/users");if(!e.ok)throw new Error("Erro ao buscar usuários");return e.json()}}),ke="admin"===a?.role,Ce=ke?(we||[]).filter(e=>"interested"===e.role):xe||[],Ie=Array.from(new Set((Ce||[]).map(e=>e.church).filter(Boolean))).sort((e,s)=>String(e).localeCompare(String(s),"pt-BR",{sensitivity:"base"})),Ee=A({mutationFn:async e=>{const s=await fetch("/api/discipleship-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw new Error("Erro ao criar solicitação");return s.json()},onSuccess:()=>{V.invalidateQueries({queryKey:["discipleship-requests"]}),V.invalidateQueries({queryKey:["all-discipleship-requests"]}),U({title:"✅ Solicitação enviada!",description:"Aguarde a aprovação do administrador."}),ee(!1),ae(null),re("")},onError:e=>{U({title:"❌ Erro ao enviar solicitação",description:e.message||"Não foi possível enviar a solicitação.",variant:"destructive"})}}),Se=A({mutationFn:async({requestId:e,status:s,adminNotes:i})=>{const r=await fetch(`/api/discipleship-requests/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s,adminNotes:i,processedBy:a?.id||1})});if(!r.ok)throw new Error("Erro ao atualizar solicitação");return r.json()},onSuccess:()=>{V.invalidateQueries({queryKey:["discipleship-requests"]}),V.invalidateQueries({queryKey:["relationships"]}),V.invalidateQueries({queryKey:["church-interested"]}),V.invalidateQueries({queryKey:["my-interested"]}),U({title:"✅ Solicitação processada!",description:"A solicitação foi processada com sucesso."}),le(!1),ce(null),ue("")},onError:e=>{U({title:"❌ Erro ao processar",description:e.message||"Não foi possível processar a solicitação.",variant:"destructive"})}}),ze=Ce.filter(e=>{const s=e.name.toLowerCase().includes(H.toLowerCase())||e.email.toLowerCase().includes(H.toLowerCase()),a="all"===_||e.status===_,i=!ke||"all"===te||e.church===te;return s&&a&&i}),Ke=ke?[]:pe.map(e=>{const s=Ce.find(s=>s.id===e.interestedId);return s?{...s,relationship:e}:null}).filter(Boolean),Me=Ke.sort((e,s)=>e.name.localeCompare(s.name,"pt-BR",{sensitivity:"base"})),Ae=ze.sort((e,s)=>e.name.localeCompare(s.name,"pt-BR",{sensitivity:"base"})),Qe=e=>fe.some(s=>s.interestedId===e&&"pending"===s.status),De=e=>{oe&&Se.mutate({requestId:oe.id,status:e,adminNotes:me.trim()})},Fe=e=>{const s=Ce.find(s=>s.id===e)||we.find(s=>s.id===e);return s?s.name:`Usuário ${e}`},Re=e=>{const s=be.filter(s=>s.interestedId===e&&"active"===s.status).map(e=>e.missionaryName?e.missionaryName.split(" ")[0]:`Usuário ${e.missionaryId}`);return Array.from(new Set(s))},Be=e=>{switch(e){case"novo":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"contato-inicial":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"estudando":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"batizado":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},Le=e=>{switch(e){case"novo":return"Novo";case"contato-inicial":return"Contato Inicial";case"estudando":return"Estudando";case"batizado":return"Batizado";case"inativo":return"Inativo";default:return e}},Te=e=>be.some(s=>s.interestedId===e&&"active"===s.status),Pe=e=>fe.some(s=>s.interestedId===e&&"approved"===s.status),$e={totalMy:Me.length,totalChurch:Ae.length,pendingRequests:ve.filter(e=>"pending"===e.status).length,approvedRequests:ve.filter(e=>"approved"===e.status).length};s.useEffect(()=>{ke&&"church"!==X&&Y("church")},[ke,X]);const Oe=async e=>{try{const s=await fetch(`/api/users/${e}/points-details`);if(s.ok){return(await s.json()).points||0}}catch(s){}return 0},{data:Ue={},isLoading:Ve}=M({queryKey:["interested-points",Ke.map(e=>e?.id).filter(Boolean)],queryFn:async()=>{const e={};for(const s of Ke)if(s){const a=await Oe(s.id);e[s.id]=a}return e},enabled:Ke.length>0,staleTime:3e5});return a?e.jsxs(d,{children:[e.jsxs("div",{className:"container mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Meus Interessados"}),e.jsx("p",{className:"text-muted-foreground",children:"Gerencie seus relacionamentos de discipulado"})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{V.invalidateQueries({queryKey:["discipleship-requests"]}),V.invalidateQueries({queryKey:["all-discipleship-requests"]}),V.invalidateQueries({queryKey:["relationships"]}),V.invalidateQueries({queryKey:["all-relationships"]}),V.invalidateQueries({queryKey:["my-interested"]}),V.invalidateQueries({queryKey:["church-interested"]}),V.invalidateQueries({queryKey:["all-users"]})},className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-4 w-4"}),"Atualizar"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(c,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:$e.totalMy}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Meus"})]})}),e.jsx(c,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:$e.totalChurch}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Da Igreja"})]})}),e.jsx(c,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:$e.pendingRequests}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Pendentes"})]})}),e.jsx(c,{children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:$e.approvedRequests}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Aprovados"})]})})]}),e.jsxs("div",{className:"flex gap-2 border-b",children:[e.jsxs(l,{variant:"my"===X?"default":"ghost",onClick:()=>Y("my"),className:"rounded-none border-b-2 border-transparent data-[state=active]:border-primary",children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),"Meus Interessados (",$e.totalMy,")"]}),e.jsxs(l,{variant:"church"===X?"default":"ghost",onClick:()=>Y("church"),className:"rounded-none border-b-2 border-transparent data-[state=active]:border-primary",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Da Igreja (",$e.totalChurch,")"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(x,{placeholder:"Buscar interessados...",value:H,onChange:e=>J(e.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[e.jsx(l,{variant:"all"===_?"default":"outline",size:"sm",onClick:()=>W("all"),children:"Todos"}),e.jsx(l,{variant:"novo"===_?"default":"outline",size:"sm",onClick:()=>W("novo"),children:"Novos"}),e.jsx(l,{variant:"estudando"===_?"default":"outline",size:"sm",onClick:()=>W("estudando"),children:"Estudando"}),e.jsx(l,{variant:"batizado"===_?"default":"outline",size:"sm",onClick:()=>W("batizado"),children:"Batizados"})]}),ke&&e.jsx("div",{className:"w-full md:w-80",children:e.jsxs(h,{value:te,onValueChange:ne,children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Filtrar por igreja"})}),e.jsxs(v,{children:[e.jsx(g,{value:"all",children:"Todas as igrejas"}),Ie.map(s=>e.jsx(g,{value:s,children:s},s))]})]})}),(he||je||ge||Ve)&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Carregando..."})]}),!he&&!je&&!ge&&!Ve&&e.jsx("div",{className:"space-y-4",children:("my"===X?Me:Ae).map(s=>{const i=(e=>{const s=pe.find(s=>s.interestedId===e&&"active"===s.status);if(s)return{label:"Discipulando",color:"bg-green-100 text-green-800",icon:b,missionaryId:s.missionaryId,type:"active",isMyRelationship:!0};const i=fe.find(s=>s.interestedId===e&&"approved"===s.status&&s.missionaryId===Number(a?.id));if(i)return{label:"Aprovado",color:"bg-blue-100 text-blue-800",icon:b,missionaryId:i.missionaryId,type:"approved",isMyRelationship:!0};const r=fe.find(s=>s.interestedId===e&&"pending"===s.status&&s.missionaryId===Number(a?.id));return r?{label:"Solicitado",color:"bg-yellow-100 text-yellow-800",icon:L,missionaryId:r.missionaryId,type:"pending",isMyRelationship:!0}:null})(s.id);var r;r=s.id,fe.some(e=>e.interestedId===r&&e.missionaryId===Number(a?.id)&&"pending"===e.status)||(e=>fe.some(s=>s.interestedId===e&&s.missionaryId===Number(a?.id)&&"approved"===s.status))(s.id)||(e=>{pe.some(s=>s.interestedId===e&&"active"===s.status)})(s.id);const t="my"===X;return e.jsx(c,{className:"hover:shadow-md transition-shadow",children:e.jsx(m,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(S,{children:[e.jsx(z,{src:""}),e.jsx(K,{className:"bg-primary text-white",children:s.name.charAt(0)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:s.name}),t&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 items-end",children:[t&&e.jsx(f,{className:Be(s.status),children:Le(s.status)}),i&&e.jsxs(f,{className:i.color,children:[e.jsx(i.icon,{className:"h-3 w-3 mr-1"}),i.label]}),"church"===X&&e.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[Te(s.id)&&e.jsxs("div",{className:"mb-1 flex items-center gap-1 justify-end",children:[e.jsx("span",{className:"font-medium mr-1",children:"Discipulado por:"}),Re(s.id).map((s,a)=>e.jsx(f,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:s},a))]}),Pe(s.id)&&!Te(s.id)&&e.jsx("div",{className:"mb-1",children:e.jsx("span",{className:"font-medium",children:"Aprovado para discipulado"})}),fe.some(e=>e.interestedId===s.id&&"pending"===e.status)&&e.jsx("div",{className:"mb-1",children:e.jsx("span",{className:"font-medium",children:"Solicitação pendente"})}),!Te(s.id)&&!Pe(s.id)&&!fe.some(e=>e.interestedId===s.id&&"pending"===e.status)&&e.jsx("div",{className:"mb-1",children:e.jsx("span",{className:"font-medium",children:"Disponível para discipulado"})})]}),"admin"===a?.role&&Qe(s.id)&&e.jsxs(f,{className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-200 cursor-pointer",onClick:()=>{const e=fe.find(e=>e.interestedId===s.id);e&&(e=>{ce(e),ue(e.adminNotes||""),le(!0)})(e)},children:[e.jsx(L,{className:"h-3 w-3 mr-1"}),"Autorizar"]})]})]}),t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{children:s.phone})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx("span",{children:s.address})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Igreja:"})," ",s.church]}),s.studiesCompleted>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Progresso dos Estudos"}),e.jsxs("span",{children:[s.studiesCompleted,"/",s.totalStudies]})]}),e.jsx("div",{className:"bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:s.studiesCompleted/s.totalStudies*100+"%"}})})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.interests?.map((s,a)=>e.jsx(f,{variant:"outline",className:"text-xs",children:s},a))}),s.notes&&e.jsxs("div",{className:"text-sm text-muted-foreground bg-muted p-2 rounded",children:[e.jsx("strong",{children:"Observações:"})," ",s.notes]}),s.lastContact&&e.jsxs("div",{className:"text-xs text-muted-foreground border-t pt-2",children:["Último contato: ",(n=s.lastContact,new Date(n).toLocaleDateString("pt-BR"))]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[!i&&e.jsxs(l,{variant:"default",size:"sm",onClick:()=>(e=>{ae(e),ee(!0)})(s),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(P,{className:"h-3 w-3 mr-1"}),"Discipular"]}),"pending"===i?.type&&e.jsxs(l,{variant:"outline",size:"sm",disabled:!0,className:"bg-yellow-50 border-yellow-200 text-yellow-700 cursor-not-allowed",children:[e.jsx(L,{className:"h-3 w-3 mr-1"}),"Solicitado"]}),"approved"===i?.type&&e.jsxs(l,{variant:"outline",size:"sm",disabled:!0,className:"bg-blue-50 border-blue-200 text-blue-700 cursor-not-allowed",children:[e.jsx(b,{className:"h-3 w-3 mr-1"}),"Aprovado"]}),"active"===i?.type&&e.jsxs(l,{variant:"outline",size:"sm",disabled:!0,className:"bg-green-50 border-green-200 text-green-700 cursor-not-allowed",children:[e.jsx(u,{className:"h-3 w-3 mr-1"}),"Discipulando"]}),t&&e.jsxs(e.Fragment,{children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>((e,s)=>{const a=`https://wa.me/55${e.replace(/\D/g,"")}?text=Olá ${s}! Tudo bem?`;window.open(a,"_blank")})(s.phone,s.name),className:"bg-green-50 hover:bg-green-100 border-green-200 text-green-700",children:[e.jsx(N,{className:"h-3 w-3 mr-1"}),"WhatsApp"]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>((e,s)=>{G(`/chat?user=${e}&name=${encodeURIComponent(s)}`)})(s.id,s.name),className:"bg-blue-50 hover:bg-blue-100 border-blue-200 text-blue-700",children:[e.jsx(w,{className:"h-3 w-3 mr-1"}),"Mensagem"]}),"active"===i?.type&&e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>(async e=>{try{const s=pe.find(s=>s.interestedId===e&&"active"===s.status);if(!s)return void U({title:"❌ Erro",description:"Relacionamento não encontrado.",variant:"destructive"});if(!confirm("Tem certeza que deseja desvincular este interessado? Esta ação não pode ser desfeita."))return;if(!(await fetch(`/api/relationships/${s.id}`,{method:"DELETE"})).ok)throw new Error("Erro ao desvincular relacionamento");V.invalidateQueries({queryKey:["relationships"]}),V.invalidateQueries({queryKey:["my-interested"]}),V.invalidateQueries({queryKey:["church-interested"]}),V.invalidateQueries({queryKey:["all-discipleship-requests"]}),U({title:"✅ Desvinculado com sucesso!",description:"O interessado foi desvinculado do seu discipulado."})}catch(s){U({title:"❌ Erro ao desvincular",description:s.message||"Não foi possível desvincular o relacionamento.",variant:"destructive"})}})(s.id),className:"bg-red-50 hover:bg-red-100 border-red-200 text-red-700",children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),"Desvincular"]})]})]}),t&&e.jsx("div",{className:"mt-4 p-3 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg border border-purple-200",children:Ve?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-purple-200 rounded animate-pulse"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-purple-200 rounded animate-pulse mb-1"}),e.jsx("div",{className:"h-3 bg-purple-200 rounded animate-pulse w-20"})]}),e.jsx("div",{className:"h-5 w-12 bg-purple-200 rounded animate-pulse"})]}):e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{iconType:D(Ue[s.id]||0),className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-purple-700",children:F(Ue[s.id]||0)}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[Ue[s.id]||0," pontos"]})]}),e.jsx(f,{variant:"outline",className:"text-xs border-purple-300 text-purple-700",children:"Monte"})]})})]})})},s.id);var n})}),!he&&!je&&!ge&&!Ve&&0===("my"===X?Me:Ae).length&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(k,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"my"===X?"Nenhum interessado vinculado":"Nenhum interessado encontrado"}),e.jsx("p",{className:"text-muted-foreground",children:"my"===X?"Você ainda não tem interessados vinculados. Solicite discipulado de interessados da igreja.":"Tente ajustar os filtros de busca."})]})]}),Z&&se&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs(c,{className:"w-full max-w-md",children:[e.jsxs(C,{children:[e.jsx(I,{children:"Solicitar Discipulado"}),e.jsxs(E,{children:["Solicite permissão para discipular ",se.name]})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Mensagem para o administrador:"}),e.jsx("textarea",{className:"w-full mt-1 p-2 border rounded-md",rows:3,placeholder:"Explique por que você gostaria de discipular esta pessoa...",value:ie,onChange:e=>re(e.target.value)})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(l,{variant:"outline",onClick:()=>ee(!1),children:"Cancelar"}),e.jsx(l,{onClick:()=>{se&&a?.id&&ie.trim()&&Ee.mutate({missionaryId:Number(a.id),interestedId:se.id,status:"pending",notes:ie})},disabled:!ie.trim()||Ee.isPending,children:Ee.isPending?"Enviando...":"Enviar Solicitação"})]})]})]})}),de&&oe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs(c,{className:"w-full max-w-md",children:[e.jsxs(C,{children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5 text-yellow-600"}),"Autorizar Discipulado"]}),e.jsx(E,{children:"Aprove ou rejeite a solicitação de discipulado"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Missionário:"}),e.jsx("div",{className:"font-medium",children:Fe(oe.missionaryId)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Interessado:"}),e.jsx("div",{className:"font-medium",children:Fe(oe.interestedId)})]})]}),oe.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Observações do Missionário:"}),e.jsx("div",{className:"text-sm bg-muted/50 p-2 rounded mt-1",children:oe.notes})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Notas do Administrador:"}),e.jsx("textarea",{className:"w-full mt-1 p-2 border rounded-md",rows:3,placeholder:"Adicione observações sobre sua decisão...",value:me,onChange:e=>ue(e.target.value)})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(l,{variant:"outline",onClick:()=>le(!1),children:"Cancelar"}),e.jsx(l,{variant:"destructive",onClick:()=>De("rejected"),disabled:Se.isPending,children:Se.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processando..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-4 w-4 mr-1"}),"Rejeitar"]})}),e.jsx(l,{onClick:()=>De("approved"),disabled:Se.isPending,className:"bg-green-600 hover:bg-green-700",children:Se.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 mr-1"}),"Aprovar"]})})]})]})]})})]}):e.jsx(d,{children:e.jsxs("div",{className:"container mx-auto p-4 text-center",children:[e.jsx(R,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"Faça login para acessar esta página"})]})})}export{U as default};
