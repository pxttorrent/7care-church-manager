import{l as a,f as e}from"./index-Y-Z_iq7n.js";import{r as t}from"./vendor-v6ZOr5pf.js";import{P as o}from"./pointsCalculator-BwBrJ8sV.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=a("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),i=()=>{const{user:a}=e(),[s,i]=t.useState(null),[r,n]=t.useState(!0),[c,u]=t.useState(null),[m,l]=t.useState(null);t.useEffect(()=>{(async()=>{try{const a=await fetch("/api/system/points-config");if(a.ok){const e=await a.json();l(e)}}catch(a){}})()},[]);const d=async()=>{if(a?.id)try{n(!0),u(null);const e=await fetch(`/api/users/${a.id}/points-details`);if(!e.ok)throw new Error(`Erro ao carregar dados de pontuação: ${e.status}`);const t=await e.json();if(t.userData||(t.userData={engajamento:"Baixo",classificacao:"A resgatar",dizimista:"Não dizimista",ofertante:"Não ofertante",tempoBatismo:0,cargos:[],nomeUnidade:null,temLicao:!1,comunhao:0,missao:0,estudoBiblico:0,totalPresenca:0,batizouAlguem:!1,discipuladoPosBatismo:0,cpfValido:!1,camposVaziosACMS:!1}),t.userData.actualPoints=t.points,m&&"object"==typeof m){const a=t.points,e={engajamento:m.engajamento||{},classificacao:m.classificacao||{},dizimista:m.dizimista||{},ofertante:m.ofertante||{},tempoBatismo:m.tempoBatismo||{},cargos:m.cargos||{},nomeUnidade:m.nomeUnidade||{},temLicao:m.temLicao||{},escolaSabatina:m.escolaSabatina||{},totalPresenca:m.totalPresenca||{},cpfValido:m.cpfValido||{},camposVaziosACMS:m.camposVaziosACMS||{}},o={engajamento:t.userData.engajamento&&"string"==typeof t.userData.engajamento?t.userData.engajamento.toLowerCase().includes("baixo")?e.engajamento?.baixo||0:t.userData.engajamento.toLowerCase().includes("médio")||t.userData.engajamento.toLowerCase().includes("medio")?e.engajamento?.medio||0:t.userData.engajamento.toLowerCase().includes("alto")&&e.engajamento?.alto||0:0,classificacao:t.userData.classificacao&&"string"==typeof t.userData.classificacao?t.userData.classificacao.toLowerCase().includes("frequente")?e.classificacao?.frequente||0:e.classificacao?.naoFrequente||0:0,dizimista:t.userData.dizimista&&"string"==typeof t.userData.dizimista?t.userData.dizimista.toLowerCase().includes("não dizimista")||t.userData.dizimista.toLowerCase().includes("nao dizimista")?e.dizimista?.naoDizimista||0:t.userData.dizimista.toLowerCase().includes("pontual")?e.dizimista?.pontual||0:t.userData.dizimista.toLowerCase().includes("sazonal")?e.dizimista?.sazonal||0:t.userData.dizimista.toLowerCase().includes("recorrente")&&e.dizimista?.recorrente||0:0,ofertante:t.userData.ofertante&&"string"==typeof t.userData.ofertante?t.userData.ofertante.toLowerCase().includes("não ofertante")||t.userData.ofertante.toLowerCase().includes("nao ofertante")?e.ofertante?.naoOfertante||0:t.userData.ofertante.toLowerCase().includes("pontual")?e.ofertante?.pontual||0:t.userData.ofertante.toLowerCase().includes("sazonal")?e.ofertante?.sazonal||0:t.userData.ofertante.toLowerCase().includes("recorrente")&&e.ofertante?.recorrente||0:0,tempoBatismo:t.userData.tempoBatismo?t.userData.tempoBatismo>=2&&t.userData.tempoBatismo<5?e.tempoBatismo?.doisAnos||0:t.userData.tempoBatismo>=5&&t.userData.tempoBatismo<10?e.tempoBatismo?.cincoAnos||0:t.userData.tempoBatismo>=10&&t.userData.tempoBatismo<20?e.tempoBatismo?.dezAnos||0:t.userData.tempoBatismo>=20&&t.userData.tempoBatismo<30?e.tempoBatismo?.vinteAnos||0:t.userData.tempoBatismo>=30&&e.tempoBatismo?.maisVinte||0:0,cargos:t.userData.cargos&&t.userData.cargos.length>0?1===t.userData.cargos.length?e.cargos?.umCargo||0:2===t.userData.cargos.length?e.cargos?.doisCargos||0:e.cargos?.tresOuMais||0:0,nomeUnidade:t.userData.nomeUnidade&&e.nomeUnidade?.comUnidade||0,temLicao:t.userData.temLicao&&e.temLicao?.comLicao||0,comunhao:t.userData.escolaSabatina?.comunhao?t.userData.escolaSabatina.comunhao*(e.escolaSabatina?.comunhao||0):0,missao:t.userData.escolaSabatina?.missao?t.userData.escolaSabatina.missao*(e.escolaSabatina?.missao||0):0,estudoBiblico:t.userData.escolaSabatina?.estudoBiblico?t.userData.escolaSabatina.estudoBiblico*(e.escolaSabatina?.estudoBiblico||0):0,totalPresenca:void 0!==t.userData.totalPresenca?t.userData.totalPresenca>=0&&t.userData.totalPresenca<=3?e.totalPresenca?.zeroATres||0:t.userData.totalPresenca>=4&&t.userData.totalPresenca<=7?e.totalPresenca?.quatroASete||0:e.totalPresenca?.oitoATreze||0:0,batizouAlguem:t.userData.escolaSabatina?.batizouAlguem&&e.escolaSabatina?.batizouAlguem||0,discipuladoPosBatismo:t.userData.escolaSabatina?.discipuladoPosBatismo?t.userData.escolaSabatina.discipuladoPosBatismo*(e.escolaSabatina?.discipuladoPosBatismo||0):0,cpfValido:t.userData.cpfValido&&e.cpfValido?.valido||0,camposVaziosACMS:!1===t.userData.camposVaziosACMS&&e.camposVaziosACMS?.completos||0};i({...t,breakdown:o,total:a}),t.userData.actualPoints=a}else{const{total:a,breakdown:e}=o.calculateDetailedPoints(t.userData);i({...t,breakdown:e,total:a}),t.userData.actualPoints=t.points}}catch(e){u(e instanceof Error?e.message:"Erro desconhecido")}finally{n(!1)}else n(!1)};t.useEffect(()=>{d()},[a?.id,m]);return{data:s,isLoading:r,error:c,refetch:()=>{d()}}};export{s as A,i as u};
