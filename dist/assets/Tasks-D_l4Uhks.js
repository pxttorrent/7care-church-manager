import{j as e}from"./ui-CM4P41nz.js";import{r as a}from"./vendor-v6ZOr5pf.js";import{u as s}from"./useQuery-BKdD963p.js";import{l as t,j as r,z as i,k as l,B as n,e as o,R as c,E as d,L as h,I as m,p as x,q as u,r as g,s as p,t as j,C as f,c as v,a6 as w,Q as y,a7 as N,v as b,a8 as k}from"./index-Bq8hm9is.js";import{D as C,e as _,a as S,b as T,c as E}from"./dialog-B29TcHYO.js";import{T as D}from"./textarea-nHCt1tRB.js";import{T as z,a as L,b as P,c as O}from"./tabs-CbhHaPeq.js";import{C as $}from"./checkbox-BeoKTvF3.js";import{n as I}from"./notificationService-Bb4GK-tC.js";import{W as F,a as V}from"./wifi-_mJn3f_K.js";import{S as B}from"./search-7nOZtoTM.js";import{T as M}from"./trash-2-hFd2GVs7.js";import{C as A}from"./clock-CklmuflH.js";import"./charts-56rtB2he.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=t("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),J=t("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]),R=t("SquareCheck",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),K=t("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),H={high:{color:"bg-red-50 text-red-700 border-red-200",icon:e.jsx(k,{className:"h-3 w-3"}),label:"Alta"},medium:{color:"bg-yellow-50 text-yellow-700 border-yellow-200",icon:e.jsx(A,{className:"h-3 w-3"}),label:"Média"},low:{color:"bg-green-50 text-green-700 border-green-200",icon:e.jsx(w,{className:"h-3 w-3"}),label:"Baixa"}},Q={pending:{color:"bg-gray-50 text-gray-700 border-gray-200",icon:e.jsx(w,{className:"h-3 w-3"}),label:"Pendente"},in_progress:{color:"bg-blue-50 text-blue-700 border-blue-200",icon:e.jsx(A,{className:"h-3 w-3"}),label:"Em Progresso"},completed:{color:"bg-green-50 text-green-700 border-green-200",icon:e.jsx(y,{className:"h-3 w-3"}),label:"Concluída"}},G="/api/google-sheets/proxy",U="1i-x-0KiciwACRztoKX-YHlXT4FsrAzaKwuH-hHkD8go",X="tarefas";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function W(){const t=r(),[k,W]=a.useState(""),[Y,Z]=a.useState("all"),[ee,ae]=a.useState("all"),[se,te]=a.useState("date"),[re,ie]=a.useState(!1),[le,ne]=a.useState(!1),[oe,ce]=a.useState(null),[de,he]=a.useState([]),[me,xe]=a.useState({title:"",description:"",priority:"medium",due_date:"",assigned_to:"none",church:"",tags:[]}),[ue,ge]=a.useState(navigator.onLine),{data:pe,isLoading:je,refetch:fe}=s({queryKey:["tasks"],queryFn:async()=>{const e=await fetch("/api/tasks",{headers:{"x-user-id":"1","Cache-Control":"no-cache"}});if(!e.ok)throw new Error("Erro ao buscar tarefas");return(await e.json()).tasks||[]},staleTime:0,refetchInterval:3e4}),ve=pe||[];a.useEffect(()=>{const e=()=>ge(!0),a=()=>ge(!1);return window.addEventListener("online",e),window.addEventListener("offline",a),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",a)}},[]),a.useEffect(()=>{he([])},[k,Y,ee]),a.useEffect(()=>{if(!ue)return;const e=setInterval(async()=>{if(ue)try{await be(!1)}catch(e){}},3e4);return()=>{clearInterval(e)}},[ue]);const we=async e=>{if(ue)try{const a={id:e.id,titulo:e.title,descricao:e.description||"",status:"completed"===e.status?"Concluída":"in_progress"===e.status?"Em Progresso":"Pendente",prioridade:"high"===e.priority?"Alta":"low"===e.priority?"Baixa":"Média",responsavel:e.assigned_to_name||"Sistema",criador:e.created_by_name||"App",igreja:e.church||"",data_criacao:new Date(e.created_at).toLocaleDateString("pt-BR"),data_vencimento:e.due_date?new Date(e.due_date).toLocaleDateString("pt-BR"):"",data_conclusao:e.completed_at?new Date(e.completed_at).toLocaleDateString("pt-BR"):"",tags:e.tags?.join(",")||""},s=await fetch(G,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify({action:"addTask",spreadsheetId:U,sheetName:X,taskData:a})});if(s.ok){(await s.json()).success}}catch(a){}},ye=async e=>{if(ue)try{const a=await fetch("/api/tasks",{headers:{"x-user-id":"1"}});if(a.ok){const s=(await a.json()).tasks||[];if(!s.find(a=>a.id===e.id))return}await fetch(G,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify({action:"deleteTask",spreadsheetId:U,sheetName:X,taskId:e.id})});await we(e)}catch(a){}},Ne=async e=>{if(ue)try{const a=await fetch(G,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify({action:"deleteTask",spreadsheetId:U,sheetName:X,taskId:e})});if(a.ok){(await a.json()).success}}catch(a){}},be=async(e=!1)=>{if(ue)try{e&&i.info("Sincronizando...");const a=await fetch(G,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify({action:"getTasks",spreadsheetId:U,sheetName:X})});if(!a.ok)throw new Error("Erro ao buscar do Google Sheets");const s=(await a.json()).tasks||[];t.setQueryData(["tasks"],s),e&&i.success(`${s.length} tarefas sincronizadas`)}catch(a){e&&i.error("Erro ao sincronizar")}else e&&i.error("Você está offline")},ke=e=>{he(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])},{data:Ce}=s({queryKey:["tasks-users"],queryFn:async()=>{const e=await fetch("/api/tasks/users",{headers:{"x-user-id":"1"}});if(!e.ok)throw new Error("Erro ao buscar usuários");return e.json()}}),_e=Ce?.users||[],Se=[...ve.filter(e=>{const a=e.title.toLowerCase().includes(k.toLowerCase())||e.description?.toLowerCase().includes(k.toLowerCase())||e.assigned_to_name?.toLowerCase().includes(k.toLowerCase())||e.church?.toLowerCase().includes(k.toLowerCase()),s="all"===ee||e.status===ee,t="all"===Y||e.priority===Y;return a&&s&&t})].sort((e,a)=>{if("priority"===se){const s={high:3,medium:2,low:1};return s[a.priority]-s[e.priority]}{const s=new Date(e.created_at||0).getTime();return new Date(a.created_at||0).getTime()-s}}),Te=Se.filter(e=>"pending"===e.status),Ee=Se.filter(e=>"in_progress"===e.status),De=Se.filter(e=>"completed"===e.status),ze=({task:a})=>{const s=!1===a._synced||!0===a._localCreated,t=de.includes(a.id);return e.jsxs(f,{className:`group relative overflow-hidden bg-white border-0 shadow-sm hover:shadow-md transition-shadow duration-200 mb-4 ${s?"border-l-4 border-l-yellow-400":""} ${t?"ring-2 ring-blue-500 shadow-xl":""}`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-50/50 to-white opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx(v,{className:"p-6 relative z-10",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("button",{onClick:()=>(async e=>{const a="completed"===e.status?"pending":"completed";try{if(!(await fetch(`/api/tasks/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify({status:a,completed_at:"completed"===a?(new Date).toISOString():void 0})})).ok)throw new Error("Erro ao atualizar");const s={...e,status:a,completed_at:"completed"===a?(new Date).toISOString():void 0};await ye(s),await fe()}catch(s){i.error("Erro ao alterar status")}})(a),className:"flex-shrink-0 transition-all duration-200 hover:scale-110",children:"completed"===a.status?e.jsx(y,{className:"h-5 w-5 text-green-500"}):e.jsx(w,{className:"h-5 w-5 text-gray-300 hover:text-gray-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:a.title}),s&&e.jsxs(n,{className:"bg-yellow-100 text-yellow-700 border-yellow-200 text-xs",children:[e.jsx(N,{className:"h-2 w-2 mr-1"}),"Offline"]})]}),a.description&&e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsxs(n,{className:`${Q[a.status].color} border`,children:[Q[a.status].icon,e.jsx("span",{className:"ml-1",children:Q[a.status].label})]}),e.jsxs(n,{className:`${H[a.priority].color} border`,children:[H[a.priority].icon,e.jsx("span",{className:"ml-1",children:H[a.priority].label})]}),a.assigned_to_name&&e.jsxs(n,{className:"bg-blue-50 text-blue-700 border-blue-200",children:[e.jsx(b,{className:"h-3 w-3 mr-1"}),a.assigned_to_name]}),a.church&&e.jsxs(n,{className:"bg-purple-50 text-purple-700 border-purple-200",children:["🏛️ ",a.church]})]}),a.tags&&a.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:a.tags.map((a,s)=>e.jsxs(n,{variant:"outline",className:"text-xs",children:[e.jsx(K,{className:"h-2 w-2 mr-1"}),a]},s))})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(o,{onClick:()=>(e=>{ce(e),ne(!0)})(a),variant:"ghost",size:"sm",className:"h-9 px-3 text-gray-600 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200",children:[e.jsx(J,{className:"h-4 w-4 mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Editar"})]}),e.jsxs(o,{onClick:()=>(async e=>{if(confirm("Tem certeza que deseja deletar esta tarefa?"))try{const a=await fetch(`/api/tasks/${e}`,{method:"DELETE",headers:{"x-user-id":"1"}});if(!a.ok&&404!==a.status)throw new Error("Erro ao deletar tarefa");await Ne(e),await fe(),i.success("Tarefa deletada!")}catch(a){i.error(`Erro ao deletar: ${a.message}`)}})(a.id),variant:"ghost",size:"sm",className:"h-9 px-3 text-gray-600 hover:text-red-600 hover:bg-red-50 transition-all duration-200",children:[e.jsx(M,{className:"h-4 w-4 mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Deletar"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-md hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>ke(a.id),children:[e.jsx("span",{className:"text-sm text-gray-600 hidden sm:inline",children:"Selecionar"}),e.jsx($,{checked:t,onCheckedChange:()=>ke(a.id),className:"flex-shrink-0","aria-label":`Selecionar tarefa ${a.title}`,onClick:e=>e.stopPropagation()})]})]})]})})]})},Le=({icon:a,title:s,description:t})=>e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex p-4 rounded-full bg-gray-100 mb-4",children:e.jsx(a,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:s}),e.jsx("p",{className:"text-gray-500 max-w-sm mx-auto",children:t})]});return je?e.jsx(l,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})})})}):e.jsx(l,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-6 mb-8",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent",children:"Tarefas"}),ue?e.jsxs(n,{className:"bg-green-100 text-green-700 border-green-200 flex items-center gap-1",children:[e.jsx(F,{className:"h-3 w-3"}),"Online"]}):e.jsxs(n,{className:"bg-yellow-100 text-yellow-700 border-yellow-200 flex items-center gap-1",children:[e.jsx(V,{className:"h-3 w-3"}),"Offline"]})]}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Organize e acompanhe suas tarefas"})]}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>be(!0),className:"flex items-center gap-2 bg-green-50 hover:bg-green-100 text-green-700 border-green-200",title:"Sincronizar do Google Sheets manualmente",children:[e.jsx(c,{className:"h-4 w-4"}),"Sincronizar"]}),e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>window.open("/settings","_blank"),className:"flex items-center gap-2",children:[e.jsx(d,{className:"h-4 w-4"}),"Configurar"]}),e.jsxs(C,{open:re,onOpenChange:ie,children:[e.jsx(_,{asChild:!0,children:e.jsxs(o,{className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white shadow-lg hover:shadow-xl transition-all duration-300 px-6 py-3",children:[e.jsx(q,{className:"h-5 w-5 mr-2"}),"Nova Tarefa"]})}),e.jsxs(S,{className:"max-w-md",children:[e.jsx(T,{children:e.jsx(E,{className:"text-xl font-semibold",children:"Nova Tarefa"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"title",children:"Título *"}),e.jsx(m,{id:"title",value:me.title,onChange:e=>xe({...me,title:e.target.value}),placeholder:"Digite o título da tarefa",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"description",children:"Descrição"}),e.jsx(D,{id:"description",value:me.description,onChange:e=>xe({...me,description:e.target.value}),placeholder:"Descreva a tarefa em detalhes",className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"priority",children:"Prioridade"}),e.jsxs(x,{value:me.priority,onValueChange:e=>xe({...me,priority:e}),children:[e.jsx(u,{className:"mt-1",children:e.jsx(g,{})}),e.jsxs(p,{children:[e.jsx(j,{value:"low",children:"Baixa"}),e.jsx(j,{value:"medium",children:"Média"}),e.jsx(j,{value:"high",children:"Alta"})]})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"due_date",children:"Vencimento"}),e.jsx(m,{id:"due_date",type:"date",value:me.due_date,onChange:e=>xe({...me,due_date:e.target.value}),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"assigned_to",children:"Responsável"}),e.jsxs(x,{value:me.assigned_to,onValueChange:e=>xe({...me,assigned_to:e}),children:[e.jsx(u,{className:"mt-1",children:e.jsx(g,{placeholder:"Selecione"})}),e.jsxs(p,{children:[e.jsx(j,{value:"none",children:"Sem responsável"}),_e.map(a=>e.jsx(j,{value:a.id.toString(),children:a.name},a.id))]})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"church",children:"Igreja"}),e.jsx(m,{id:"church",value:me.church,onChange:e=>xe({...me,church:e.target.value}),placeholder:"Digite o nome da igreja",className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(o,{variant:"outline",onClick:()=>ie(!1),children:"Cancelar"}),e.jsx(o,{onClick:async()=>{if(me.title.trim())try{const a={title:me.title,description:me.description,priority:me.priority,due_date:me.due_date||void 0,assigned_to:me.assigned_to&&"none"!==me.assigned_to?parseInt(me.assigned_to):void 0,church:me.church||void 0,status:"pending",created_by:1,tags:me.tags},s=await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify(a)});if(!s.ok)throw new Error("Erro ao criar tarefa");const t=await s.json(),r=t.task||t;if(r&&await we(r),await fe(),ie(!1),xe({title:"",description:"",priority:"medium",due_date:"",assigned_to:"none",church:"",tags:[]}),i.success("Tarefa criada!"),me.assigned_to&&"none"!==me.assigned_to)try{await I.notifyTaskCreated(me.title,parseInt(me.assigned_to))}catch(e){}}catch(e){i.error("Erro ao criar tarefa")}else i.error("Título é obrigatório")},className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:"Criar Tarefa"})]})]})]})]})]})]}),e.jsx(f,{className:"mb-8 border-0 shadow-sm",children:e.jsx(v,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx(m,{placeholder:"Buscar tarefas...",value:k,onChange:e=>W(e.target.value),className:"pl-12 h-12 text-base"})]})}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsxs(x,{value:ee,onValueChange:ae,children:[e.jsx(u,{className:"w-40",children:e.jsx(g,{placeholder:"Status"})}),e.jsxs(p,{children:[e.jsx(j,{value:"all",children:"Todos"}),e.jsx(j,{value:"pending",children:"Pendentes"}),e.jsx(j,{value:"in_progress",children:"Em Progresso"}),e.jsx(j,{value:"completed",children:"Concluídas"})]})]}),e.jsxs(x,{value:Y,onValueChange:Z,children:[e.jsx(u,{className:"w-40",children:e.jsx(g,{placeholder:"Prioridade"})}),e.jsxs(p,{children:[e.jsx(j,{value:"all",children:"Todas"}),e.jsx(j,{value:"high",children:"Alta"}),e.jsx(j,{value:"medium",children:"Média"}),e.jsx(j,{value:"low",children:"Baixa"})]})]}),e.jsxs(x,{value:se,onValueChange:te,children:[e.jsx(u,{className:"w-48",children:e.jsx(g,{placeholder:"Ordenar por"})}),e.jsxs(p,{children:[e.jsx(j,{value:"date",children:"Data de Lançamento"}),e.jsx(j,{value:"priority",children:"Prioridade"})]})]})]})]})})}),Se.length>0&&e.jsx(f,{className:"mb-6 border-blue-200 bg-gradient-to-r from-blue-50 to-white shadow-md",children:e.jsx(v,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($,{checked:de.length===Se.length&&Se.length>0,onCheckedChange:()=>{de.length===Se.length?he([]):he(Se.map(e=>e.id))},className:"flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:de.length>0?`${de.length} selecionada${de.length>1?"s":""}`:"Selecionar todas"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[Se.length," tarefa",Se.length>1?"s":""," disponível",Se.length>1?"is":""]})]})]}),de.length>0&&e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>he([]),className:"flex-1 sm:flex-none",children:"Desmarcar"}),e.jsxs(o,{variant:"destructive",size:"sm",onClick:async()=>{if(0===de.length)return void i.error("Selecione pelo menos uma tarefa");const e=de.length;if(confirm(`Deletar ${e} tarefa${e>1?"s":""}?`))try{for(const e of de)await fetch(`/api/tasks/${e}`,{method:"DELETE",headers:{"x-user-id":"1"}}),await Ne(e);await fe(),he([]),i.success(`${e} tarefa${e>1?"s deletadas":" deletada"}!`)}catch(a){i.error(`Erro: ${a.message}`)}},className:"flex-1 sm:flex-none bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Deletar (",de.length,")"]})]})]})})}),e.jsxs(z,{defaultValue:"pending",className:"space-y-6",children:[e.jsxs(L,{className:"grid w-full grid-cols-3 bg-white border shadow-sm",children:[e.jsxs(P,{value:"pending",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Pendentes (",Te.length,")"]}),e.jsxs(P,{value:"in_progress",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Em Progresso (",Ee.length,")"]}),e.jsxs(P,{value:"completed",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Concluídas (",De.length,")"]})]}),e.jsx(O,{value:"pending",className:"space-y-4",children:0===Te.length?e.jsx(Le,{icon:w,title:"Nenhuma tarefa pendente",description:"Crie uma nova tarefa para começar"}):Te.map(a=>e.jsx(ze,{task:a},a.id))}),e.jsx(O,{value:"in_progress",className:"space-y-4",children:0===Ee.length?e.jsx(Le,{icon:A,title:"Nenhuma tarefa em progresso",description:"Mova tarefas pendentes para começar"}):Ee.map(a=>e.jsx(ze,{task:a},a.id))}),e.jsx(O,{value:"completed",className:"space-y-4",children:0===De.length?e.jsx(Le,{icon:R,title:"Nenhuma tarefa concluída",description:"Complete tarefas para vê-las aqui"}):De.map(a=>e.jsx(ze,{task:a},a.id))})]}),e.jsx(C,{open:le,onOpenChange:ne,children:e.jsxs(S,{className:"max-w-md",children:[e.jsx(T,{children:e.jsx(E,{className:"text-xl font-semibold",children:"Editar Tarefa"})}),oe&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"edit-title",children:"Título *"}),e.jsx(m,{id:"edit-title",value:oe.title,onChange:e=>ce({...oe,title:e.target.value}),placeholder:"Digite o título",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"edit-description",children:"Descrição"}),e.jsx(D,{id:"edit-description",value:oe.description||"",onChange:e=>ce({...oe,description:e.target.value}),placeholder:"Descreva a tarefa",className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"edit-priority",children:"Prioridade"}),e.jsxs(x,{value:oe.priority,onValueChange:e=>ce({...oe,priority:e}),children:[e.jsx(u,{className:"mt-1",children:e.jsx(g,{})}),e.jsxs(p,{children:[e.jsx(j,{value:"low",children:"Baixa"}),e.jsx(j,{value:"medium",children:"Média"}),e.jsx(j,{value:"high",children:"Alta"})]})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"edit-due_date",children:"Vencimento"}),e.jsx(m,{id:"edit-due_date",type:"date",value:oe.due_date?oe.due_date.split("T")[0]:"",onChange:e=>ce({...oe,due_date:e.target.value}),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"edit-status",children:"Status"}),e.jsxs(x,{value:oe.status,onValueChange:e=>ce({...oe,status:e}),children:[e.jsx(u,{className:"mt-1",children:e.jsx(g,{})}),e.jsxs(p,{children:[e.jsx(j,{value:"pending",children:"Pendente"}),e.jsx(j,{value:"in_progress",children:"Em Progresso"}),e.jsx(j,{value:"completed",children:"Concluída"})]})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"edit-assigned_to",children:"Responsável"}),e.jsxs(x,{value:oe.assigned_to?.toString()||"none",onValueChange:e=>ce({...oe,assigned_to:"none"===e?void 0:parseInt(e)}),children:[e.jsx(u,{className:"mt-1",children:e.jsx(g,{placeholder:"Selecione"})}),e.jsxs(p,{children:[e.jsx(j,{value:"none",children:"Sem responsável"}),_e.map(a=>e.jsx(j,{value:a.id.toString(),children:a.name},a.id))]})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"edit-church",children:"Igreja"}),e.jsx(m,{id:"edit-church",value:oe.church||"",onChange:e=>ce({...oe,church:e.target.value}),placeholder:"Digite o nome da igreja",className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(o,{variant:"outline",onClick:()=>ne(!1),children:"Cancelar"}),e.jsx(o,{onClick:async()=>{if(oe)try{const e={title:oe.title,description:oe.description,priority:oe.priority,due_date:oe.due_date,assigned_to:oe.assigned_to,church:oe.church,status:oe.status};if(!(await fetch(`/api/tasks/${oe.id}`,{method:"PUT",headers:{"Content-Type":"application/json","x-user-id":"1"},body:JSON.stringify(e)})).ok)throw new Error("Erro ao atualizar tarefa");await ye(oe),await fe(),ne(!1),ce(null),i.success("Tarefa atualizada!")}catch(e){i.error("Erro ao atualizar tarefa")}},className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:"Salvar"})]})]})]})})]})})})}export{W as default};
