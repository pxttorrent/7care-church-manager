import{j as e}from"./ui-CM4P41nz.js";import{r as s}from"./vendor-v6ZOr5pf.js";import{f as a,g as t,u as r,aq as n,k as i,e as c,C as o,c as l,ap as m,R as d,a as x,b as h,Y as j,U as N,B as p,P as u,N as v,T as f}from"./index-Btc09PY6.js";import{L as g}from"./loader-circle-ApFqNsXk.js";import{A as w}from"./arrow-left-Nlsku73F.js";import{V as b}from"./vote-CENTGDX1.js";import{C as y}from"./clock-CwLzqaee.js";import{A as P}from"./award-B8LBHIez.js";import"./charts-56rtB2he.js";function V(){const{user:V}=a(),{toast:C}=t(),k=r(),{configId:E}=n(),[I,A]=s.useState(null),[F,S]=s.useState(!0),[$,z]=s.useState(!0);s.useEffect(()=>{let e;return T(),$&&(e=setInterval(T,5e3)),()=>{e&&clearInterval(e)}},[$,V]);const T=async()=>{try{const e=await fetch(`/api/elections/dashboard/${E}`,{headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(e.ok){const s=await e.json();A(s)}else{if(404!==e.status)throw new Error("Erro ao carregar dashboard");{const s=await e.json();C({title:"Nenhuma elei√ß√£o ativa",description:s.error||"N√£o h√° elei√ß√£o ativa para esta configura√ß√£o.",variant:"destructive"}),k("/election-dashboard")}}}catch(e){C({title:"Erro",description:"Erro ao carregar resultados da nomea√ß√£o",variant:"destructive"})}finally{S(!1)}},q=()=>I?I.currentPosition/I.totalPositions*100:0,B=()=>I?I.votedVoters/I.totalVoters*100:0;return F?e.jsx(i,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(g,{className:"h-8 w-8 animate-spin"})})}):I?e.jsx(i,{children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(c,{variant:"outline",onClick:()=>k("/election-dashboard"),className:"flex items-center",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Voltar"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>z(!$),children:[e.jsx(d,{className:"h-4 w-4 mr-2 "+($?"animate-spin":"")}),$?"Pausar":"Atualizar"]})})]}),e.jsxs(o,{className:"mb-6",children:[e.jsxs(x,{children:[e.jsxs(h,{className:"flex items-center",children:[e.jsx(m,{className:"h-5 w-5 mr-2"}),"Dashboard de Nomea√ß√µes"]}),e.jsx(j,{children:"Acompanhe as nomea√ß√µes em tempo real"})]}),e.jsxs(l,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Total de Votantes:"}),e.jsx(p,{variant:"secondary",children:I.totalVoters})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Votaram:"}),e.jsx(p,{variant:"secondary",children:I.votedVoters})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Progresso:"}),e.jsxs(p,{variant:"secondary",children:[I.currentPosition,"/",I.totalPositions]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Participa√ß√£o dos Votantes"}),e.jsxs("span",{children:[B().toFixed(1),"%"]})]}),e.jsx(u,{value:B(),className:"h-2"})]}),e.jsxs("div",{className:"space-y-2 mt-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Progresso das Nomea√ß√µes"}),e.jsxs("span",{children:[q().toFixed(1),"%"]})]}),e.jsx(u,{value:q(),className:"h-2"})]})]})]}),e.jsx("div",{className:"space-y-6",children:I.positions.map((s,a)=>e.jsxs(o,{className:a<I.currentPosition?"border-green-200 bg-green-50":"",children:[e.jsxs(x,{children:[e.jsxs(h,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[a<I.currentPosition?e.jsx(v,{className:"h-5 w-5 mr-2 text-green-600"}):a===I.currentPosition?e.jsx(y,{className:"h-5 w-5 mr-2 text-orange-600"}):e.jsx(y,{className:"h-5 w-5 mr-2 text-gray-400"}),s.positionName]}),e.jsx(p,{variant:a<I.currentPosition?"default":"secondary",children:a<I.currentPosition?"Conclu√≠do":a===I.currentPosition?"Em Andamento":"Pendente"})]}),e.jsxs(j,{children:[s.totalNominations>0&&`${s.totalNominations} indica√ß√µes ‚Ä¢ `,s.totalVotes>0?`${s.totalVotes} votos registrados`:"Nenhum voto registrado"]})]}),e.jsx(l,{children:s.results.length>0?e.jsxs("div",{className:"space-y-3",children:[s.results.sort((e,s)=>s.votes-e.votes).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[0===a&&s.votes>0&&e.jsx(f,{className:"h-5 w-5 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.candidateName}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[s.nominations>0&&e.jsxs("p",{children:["üìù ",s.nominations," indica√ß√£o",1!==s.nominations?"√µes":""]}),s.votes>0&&e.jsxs("p",{children:["üó≥Ô∏è ",s.votes," voto",1!==s.votes?"s":""]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm font-medium",children:[s.percentage.toFixed(1),"%"]}),0===a&&s.votes>0&&e.jsx(P,{className:"h-4 w-4 text-yellow-500"})]}),e.jsx(u,{value:s.percentage,className:"w-20 h-2 mt-1"})]})]},s.candidateId)),s.winner&&e.jsxs("div",{className:"mt-4 p-4 bg-green-100 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{className:"h-5 w-5 text-green-600"}),e.jsxs("span",{className:"font-semibold text-green-800",children:["Nomeado: ",s.winner.candidateName]})]}),e.jsxs("p",{className:"text-sm text-green-700 mt-1",children:[s.winner.votes," votos (",s.winner.percentage.toFixed(1),"%)"]})]})]}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(b,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("p",{children:"Nenhum voto registrado para esta posi√ß√£o"})]})})]},s.positionId))})]})}):e.jsx(i,{children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs(c,{variant:"outline",onClick:()=>k("/election-dashboard"),className:"flex items-center",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Voltar"]})}),e.jsx(o,{children:e.jsxs(l,{className:"p-8 text-center",children:[e.jsx(m,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Nenhuma nomea√ß√£o ativa"}),e.jsx("p",{className:"text-muted-foreground",children:"N√£o h√° nomea√ß√£o em andamento no momento."})]})})]})})}export{V as default};
