import{j as e}from"./ui-CM4P41nz.js";import{r as a}from"./vendor-v6ZOr5pf.js";import{u as s}from"./useQuery-DvsssCKg.js";import{l as t,j as r,a5 as n,k as i,B as l,R as o,a6 as c,e as d,A as u,L as h,I as m,p as x,q as g,r as p,s as f,t as j,C as y,c as v,a7 as w,a8 as b,O as N,v as S,D as C,w as _,x as k,V as E,a9 as T}from"./index-C7valQi6.js";import{D as L,e as z,a as D,b as R,c as I}from"./dialog-DKbDg_Mw.js";import{T as O}from"./textarea-D1UJTJt9.js";import{T as q,a as A,b as U,c as P}from"./tabs-DTmCu_1G.js";import{n as F}from"./notificationService-Bb4GK-tC.js";import{u as $}from"./useMutation-CoIyQ02F.js";import{W as M,a as B}from"./wifi-BOJMUoZB.js";import{S as K}from"./search-CAeJ4FJJ.js";import{C as V}from"./clock-CQUkW8Um.js";import{E as Q}from"./ellipsis-vertical-BMhBQV22.js";import{T as J}from"./trash-2-Dw1Eb_te.js";import"./charts-56rtB2he.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=t("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),H=t("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]),W=t("SquareCheck",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),G=t("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function X(){const{config:e,syncStatus:s}=function(){const[e,s]=a.useState(null),[t,r]=a.useState({isEnabled:!1,isRunning:!1}),n=a.useCallback(async()=>{try{const e=await fetch("/api/calendar/google-drive-config");if(e.ok){const a=await e.json();if(s(a),a.autoSync&&a.lastSync){const e=new Date(a.lastSync),s=new Date(e.getTime()+60*a.syncInterval*1e3),t=new Date;r(e=>({...e,isEnabled:!0,lastSync:a.lastSync,nextSync:s.toISOString(),isRunning:s<=t}))}else r(e=>({...e,isEnabled:a.autoSync||!1,lastSync:a.lastSync,isRunning:!1}))}}catch(e){r(e=>({...e,error:"Erro ao carregar configuração"}))}},[]),i=a.useCallback(async()=>{if(!e?.spreadsheetUrl)return r(e=>({...e,error:"URL da planilha não configurada"})),!1;r(e=>({...e,isRunning:!0,error:void 0}));try{const a=(e=>{let a="",s="0";const t=e.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);t&&(a=t[1]);const r=e.match(/\/file\/d\/([a-zA-Z0-9-_]+)/);r&&(a=r[1]);const n=e.match(/[?&]gid=(\d+)/);if(n&&(s=n[1]),!a)throw new Error("Não foi possível extrair o ID da planilha da URL fornecida");return`https://docs.google.com/spreadsheets/d/${a}/export?format=csv&gid=${s}`})(e.spreadsheetUrl),t=await fetch("/api/calendar/sync-google-drive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({csvUrl:a,spreadsheetUrl:e.spreadsheetUrl})}),n=await t.json();if(n.success){const a=(new Date).toISOString();return r(s=>({...s,isRunning:!1,lastSync:a,nextSync:e.autoSync?new Date(Date.now()+60*e.syncInterval*1e3).toISOString():void 0,error:void 0})),s(e=>e?{...e,lastSync:a}:null),window.dispatchEvent(new CustomEvent("google-drive-sync-success",{detail:{imported:n.importedCount,total:n.totalEvents,errors:n.errorCount||0}})),!0}return r(e=>({...e,isRunning:!1,error:n.error||"Erro na sincronização"})),!1}catch(a){return r(e=>({...e,isRunning:!1,error:`Erro ao sincronizar: ${a.message}`})),!1}},[e]);return a.useEffect(()=>{if(!e?.autoSync||!t.nextSync)return;const a=()=>{const e=new Date;new Date(t.nextSync)<=e&&!t.isRunning&&i()};a();const s=setInterval(a,6e4);return()=>clearInterval(s)},[e?.autoSync,t.nextSync,t.isRunning,i]),a.useEffect(()=>{n()},[n]),a.useEffect(()=>{const e=()=>{n()};return window.addEventListener("google-drive-config-changed",e),()=>window.removeEventListener("google-drive-config-changed",e)},[n]),{config:e,syncStatus:t,syncNow:i,loadConfig:n}}(),[t,r]=a.useState({isEnabled:!1,isRunning:!1}),n=a.useCallback(e=>{let a="",s="0";const t=e.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);t&&(a=t[1]);const r=e.match(/\/file\/d\/([a-zA-Z0-9-_]+)/);r&&(a=r[1]);const n=e.match(/[?&]gid=(\d+)/);if(n&&(s=n[1]),!a)throw new Error("Não foi possível extrair o ID da planilha da URL fornecida");return`https://docs.google.com/spreadsheets/d/${a}/export?format=csv&gid=${s}`},[]),i=a.useCallback(async()=>{if(!e?.spreadsheetUrl)return r(e=>({...e,error:"URL da planilha não configurada"})),!1;r(e=>({...e,isRunning:!0,error:void 0}));try{const a=n(e.spreadsheetUrl),s=await fetch("/api/tasks/sync-google-drive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({csvUrl:a,spreadsheetUrl:e.spreadsheetUrl})}),t=await s.json();if(t.success){const e=(new Date).toISOString();return r(a=>({...a,isRunning:!1,lastSync:e,error:void 0})),window.dispatchEvent(new CustomEvent("tasks-google-drive-sync-success",{detail:{imported:t.importedTasks,total:t.totalTasks,errors:t.errorCount||0}})),!0}return r(e=>({...e,isRunning:!1,error:t.error||"Erro na sincronização"})),!1}catch(a){return r(e=>({...e,isRunning:!1,error:`Erro ao sincronizar: ${a.message}`})),!1}},[e,n]),l=a.useCallback(async a=>{if(!e?.spreadsheetUrl)return r(e=>({...e,error:"URL da planilha não configurada"})),!1;try{const e=await fetch("/api/tasks/add-to-google-drive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tasks:a})}),s=await e.json();return s.success?(window.dispatchEvent(new CustomEvent("tasks-added-to-sheet",{detail:{added:s.addedCount,total:s.totalTasks}})),!0):(r(e=>({...e,error:s.message||"Erro ao adicionar tarefas à planilha"})),!1)}catch(s){return r(e=>({...e,error:`Erro ao adicionar tarefas: ${s.message}`})),!1}},[e]),o=a.useCallback(async(e,a)=>!0,[]);return a.useEffect(()=>{r(a=>({...a,isEnabled:!!e?.spreadsheetUrl,lastSync:e?.lastSync,isRunning:s.isRunning}))},[e,s]),{config:e,syncStatus:t,syncTasksNow:i,addTasksToSheet:l,configureSync:o,loadConfig:()=>{}}}const Y={high:{color:"bg-red-50 text-red-700 border-red-200",icon:e.jsx(T,{className:"h-3 w-3"}),label:"Alta"},medium:{color:"bg-yellow-50 text-yellow-700 border-yellow-200",icon:e.jsx(V,{className:"h-3 w-3"}),label:"Média"},low:{color:"bg-green-50 text-green-700 border-green-200",icon:e.jsx(w,{className:"h-3 w-3"}),label:"Baixa"}},ee={pending:{color:"bg-gray-50 text-gray-700 border-gray-200",icon:e.jsx(w,{className:"h-3 w-3"}),label:"Pendente"},in_progress:{color:"bg-blue-50 text-blue-700 border-blue-200",icon:e.jsx(V,{className:"h-3 w-3"}),label:"Em Progresso"},completed:{color:"bg-green-50 text-green-700 border-green-200",icon:e.jsx(N,{className:"h-3 w-3"}),label:"Concluída"}};function ae(){const[t,T]=a.useState(""),[ae,se]=a.useState("all"),[te,re]=a.useState("all"),[ne,ie]=a.useState(!1),[le,oe]=a.useState(!1),[ce,de]=a.useState(null),[ue,he]=a.useState({title:"",description:"",priority:"medium",due_date:"",assigned_to:"none",tags:[]});r(),X();const{data:me,loading:xe,syncing:ge,isOnline:pe,create:fe,update:je,remove:ye,sync:ve,syncInfo:we}=function({storeName:e,endpoint:t,queryKey:i,autoFetch:l=!0,syncInterval:o=3e4,headers:c={},transformBeforeSave:d,transformAfterLoad:u}){const h=r(),[m,x]=a.useState(navigator.onLine),[g,p]=a.useState(!1),[f,j]=a.useState({lastSync:null,pendingCount:0,errorCount:0});a.useEffect(()=>{const e=()=>{const e=navigator.onLine;x(e),e&&S()};return window.addEventListener("online",e),window.addEventListener("offline",e),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",e)}},[]);const{data:y,isLoading:v}=s({queryKey:i,queryFn:async()=>{let a=await n.getAll(e);if(u&&(a=a.map(u)),navigator.onLine&&l)try{const a=await fetch(t,{headers:{"x-user-id":"1",...c}});if(a.ok){const s=await a.json(),t=Array.isArray(s)?s:s[e]||s.data||[];await n.clear(e);for(const a of t){const s=d?d(a):a;await n.save(e,{...s,_synced:!0})}return u?t.map(u):t}}catch(s){}return a},staleTime:5e3,gcTime:36e5}),w=$({mutationFn:async a=>{const s=`temp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,r={...a,id:s,created_at:(new Date).toISOString(),_localCreated:!0,_synced:!1},i=d?d(r):r;if(await n.save(e,i),await n.addToSyncQueue({type:"CREATE",storeName:e,endpoint:t,data:r}),navigator.onLine)try{const s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"1",...c},body:JSON.stringify(a)});if(s.ok){const a=await s.json(),t=a[e.slice(0,-1)]||a;if(t&&t.id)return await n.save(e,{...t,_synced:!0}),t}}catch(l){}return r},onSuccess:()=>{h.invalidateQueries({queryKey:i}),_()}}),b=$({mutationFn:async({id:a,updates:s})=>{const r=await n.getById(e,a);if(!r)throw new Error(`Item ${a} não encontrado`);const i={...r,...s,updated_at:(new Date).toISOString(),_synced:!1},l=d?d(i):i;if(await n.save(e,l),await n.addToSyncQueue({type:"UPDATE",storeName:e,endpoint:t,data:i,originalUpdates:s}),navigator.onLine)try{const r=await fetch(`${t}/${a}`,{method:"PUT",headers:{"Content-Type":"application/json","x-user-id":"1",...c},body:JSON.stringify(s)});if(r.ok){const a=await r.json(),s=a[e.slice(0,-1)]||a;if(s)return await n.save(e,{...s,_synced:!0}),s}}catch(o){}return i},onSuccess:()=>{h.invalidateQueries({queryKey:i}),_()}}),N=$({mutationFn:async a=>{if(await n.delete(e,a),await n.addToSyncQueue({type:"DELETE",storeName:e,endpoint:t,data:{id:a}}),navigator.onLine)try{(await fetch(`${t}/${a}`,{method:"DELETE",headers:{"x-user-id":"1",...c}})).ok}catch(s){}},onSuccess:()=>{h.invalidateQueries({queryKey:i}),_()}}),S=a.useCallback(async()=>{if(!navigator.onLine||g)return{success:0,failed:0,errors:[]};p(!0);try{const e=await n.syncWithServer();return await h.invalidateQueries({queryKey:i}),await _(),e}catch(e){return{success:0,failed:0,errors:[String(e)]}}finally{p(!1)}},[g,h,i,e]),C=a.useCallback(async()=>{await h.invalidateQueries({queryKey:i})},[h,i]),_=a.useCallback(async()=>{const e=await n.getSyncInfo();j(e)},[]);return a.useEffect(()=>{_()},[_]),a.useEffect(()=>{if(!o||!m)return;const e=setInterval(()=>{navigator.onLine&&!g&&S()},o);return()=>clearInterval(e)},[o,m,g,S]),{data:y||[],loading:v,syncing:g,isOnline:m,create:e=>w.mutateAsync(e),update:(e,a)=>b.mutateAsync({id:e,updates:a}),remove:e=>N.mutateAsync(e),refresh:C,sync:S,syncInfo:f}}({storeName:"tasks",endpoint:"/api/tasks",queryKey:["tasks"],autoFetch:!0,syncInterval:3e4});a.useEffect(()=>{n.init().then(()=>{})},[]);const{data:be}=s({queryKey:["tasks-users"],queryFn:async()=>{const e=await fetch("/api/tasks/users",{headers:{"x-user-id":"1"}});if(!e.ok)throw new Error("Erro ao buscar usuários");return e.json()}}),Ne=be?.users||[],Se=me.filter(e=>{const a=e.title.toLowerCase().includes(t.toLowerCase())||e.description?.toLowerCase().includes(t.toLowerCase())||e.assigned_to_name?.toLowerCase().includes(t.toLowerCase()),s="all"===te||e.status===te,r="all"===ae||e.priority===ae;return a&&s&&r}),Ce=Se.filter(e=>"pending"===e.status),_e=Se.filter(e=>"in_progress"===e.status),ke=Se.filter(e=>"completed"===e.status),Ee=({task:a})=>{const s=!1===a._synced||!0===a._localCreated;return e.jsxs(y,{className:"group relative overflow-hidden bg-white border-0 shadow-sm hover:shadow-lg transition-all duration-300 hover:-translate-y-1 mb-4 "+(s?"border-l-4 border-l-yellow-400":""),children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-50/50 to-white opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx(v,{className:"p-6 relative z-10",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("button",{onClick:()=>(async e=>{const a="completed"===e.status?"pending":"completed";try{await je(e.id,{status:a,completed_at:"completed"===a?(new Date).toISOString():void 0}),pe||b.success("Status atualizado offline",{icon:"📴"})}catch(s){b.error("Erro ao alterar status")}})(a),className:"flex-shrink-0 transition-all duration-200 hover:scale-110",children:"completed"===a.status?e.jsx(N,{className:"h-5 w-5 text-green-500"}):e.jsx(w,{className:"h-5 w-5 text-gray-300 hover:text-gray-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:a.title}),s&&e.jsxs(l,{className:"bg-yellow-100 text-yellow-700 border-yellow-200 text-xs",children:[e.jsx(c,{className:"h-2 w-2 mr-1"}),"Pendente"]})]}),a.description&&e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsxs(l,{className:`${ee[a.status].color} border`,children:[ee[a.status].icon,e.jsx("span",{className:"ml-1",children:ee[a.status].label})]}),e.jsxs(l,{className:`${Y[a.priority].color} border`,children:[Y[a.priority].icon,e.jsx("span",{className:"ml-1",children:Y[a.priority].label})]}),a.assigned_to_name&&e.jsxs(l,{className:"bg-blue-50 text-blue-700 border-blue-200",children:[e.jsx(S,{className:"h-3 w-3 mr-1"}),a.assigned_to_name]})]}),a.tags&&a.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:a.tags.map((a,s)=>e.jsxs(l,{variant:"outline",className:"text-xs",children:[e.jsx(G,{className:"h-2 w-2 mr-1"}),a]},s))})]}),e.jsxs(C,{children:[e.jsx(_,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Q,{className:"h-4 w-4"})})}),e.jsxs(k,{align:"end",children:[e.jsxs(E,{onClick:()=>(e=>{de(e),oe(!0)})(a),children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Editar"]}),e.jsxs(E,{onClick:()=>(async e=>{if(confirm("Tem certeza que deseja deletar esta tarefa?"))try{await ye(e),pe?b.success("Tarefa deletada com sucesso!"):b.success("Tarefa deletada offline. Será sincronizada quando conectar.",{icon:"📴"})}catch(a){b.error("Erro ao deletar tarefa")}})(a.id),className:"text-red-600",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Deletar"]})]})]})]})})]})},Te=({icon:a,title:s,description:t})=>e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"p-4 rounded-full bg-gray-100 mb-4",children:e.jsx(a,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:s}),e.jsx("p",{className:"text-gray-500 max-w-sm",children:t})]});return xe?e.jsx(i,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})})})}):e.jsx(i,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-6 mb-8",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent",children:"Tarefas"}),pe?e.jsxs(l,{className:"bg-green-100 text-green-700 border-green-200 flex items-center gap-1",children:[e.jsx(M,{className:"h-3 w-3"}),"Online"]}):e.jsxs(l,{className:"bg-yellow-100 text-yellow-700 border-yellow-200 flex items-center gap-1",children:[e.jsx(B,{className:"h-3 w-3"}),"Offline"]}),ge&&e.jsxs(l,{className:"bg-blue-100 text-blue-700 border-blue-200 flex items-center gap-1 animate-pulse",children:[e.jsx(o,{className:"h-3 w-3 animate-spin"}),"Sincronizando..."]}),we.pendingCount>0&&e.jsxs(l,{className:"bg-orange-100 text-orange-700 border-orange-200 flex items-center gap-1",children:[e.jsx(c,{className:"h-3 w-3"}),we.pendingCount," pendente",we.pendingCount>1?"s":""]})]}),e.jsxs("p",{className:"text-gray-600 text-lg",children:["Organize e acompanhe suas tarefas de forma eficiente",!pe&&e.jsx("span",{className:"text-yellow-600 ml-2",children:"• Modo offline - suas alterações serão sincronizadas quando conectar"})]}),we.lastSync&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-gray-500",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsxs("span",{children:["Última sincronização: ",new Date(we.lastSync).toLocaleString("pt-BR")]})]})]}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[pe&&e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>ve(),disabled:ge,className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-4 w-4 "+(ge?"animate-spin":"")}),ge?"Sincronizando...":"Sincronizar"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>window.open("/settings","_blank"),className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-4 w-4"}),"Configurar"]}),e.jsxs(L,{open:ne,onOpenChange:ie,children:[e.jsx(z,{asChild:!0,children:e.jsxs(d,{className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white shadow-lg hover:shadow-xl transition-all duration-300 px-6 py-3",children:[e.jsx(Z,{className:"h-5 w-5 mr-2"}),"Nova Tarefa"]})}),e.jsxs(D,{className:"max-w-md",children:[e.jsx(R,{children:e.jsx(I,{className:"text-xl font-semibold",children:"Nova Tarefa"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"title",children:"Título *"}),e.jsx(m,{id:"title",value:ue.title,onChange:e=>he({...ue,title:e.target.value}),placeholder:"Digite o título da tarefa",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"description",children:"Descrição"}),e.jsx(O,{id:"description",value:ue.description,onChange:e=>he({...ue,description:e.target.value}),placeholder:"Descreva a tarefa em detalhes",className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"priority",children:"Prioridade"}),e.jsxs(x,{value:ue.priority,onValueChange:e=>he({...ue,priority:e}),children:[e.jsx(g,{className:"mt-1",children:e.jsx(p,{})}),e.jsxs(f,{children:[e.jsx(j,{value:"low",children:"Baixa"}),e.jsx(j,{value:"medium",children:"Média"}),e.jsx(j,{value:"high",children:"Alta"})]})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"due_date",children:"Data de Vencimento"}),e.jsx(m,{id:"due_date",type:"date",value:ue.due_date,onChange:e=>he({...ue,due_date:e.target.value}),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"assigned_to",children:"Responsável"}),e.jsxs(x,{value:ue.assigned_to,onValueChange:e=>he({...ue,assigned_to:e}),children:[e.jsx(g,{className:"mt-1",children:e.jsx(p,{placeholder:"Selecione um responsável"})}),e.jsxs(f,{children:[e.jsx(j,{value:"none",children:"Sem responsável"}),Ne.map(a=>e.jsx(j,{value:a.id.toString(),children:a.name},a.id))]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(d,{variant:"outline",onClick:()=>ie(!1),className:"px-6",children:"Cancelar"}),e.jsx(d,{onClick:async()=>{if(ue.title.trim())try{const a={title:ue.title,description:ue.description,priority:ue.priority,due_date:ue.due_date||void 0,assigned_to:ue.assigned_to&&"none"!==ue.assigned_to?parseInt(ue.assigned_to):void 0,status:"pending",created_by:1,tags:ue.tags};if(await fe(a),ie(!1),he({title:"",description:"",priority:"medium",due_date:"",assigned_to:"none",tags:[]}),pe?b.success("Tarefa criada com sucesso!"):b.success("Tarefa salva offline. Será sincronizada quando conectar.",{icon:"📴"}),pe&&ue.assigned_to&&"none"!==ue.assigned_to)try{await F.notifyTaskCreated(ue.title,parseInt(ue.assigned_to))}catch(e){}}catch(e){b.error("Erro ao criar tarefa")}else b.error("Título é obrigatório")},disabled:xe||ge,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 px-6",children:ge?"Salvando...":"Criar Tarefa"})]})]})]})]})]})]}),e.jsx(y,{className:"mb-8 border-0 shadow-sm",children:e.jsx(v,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx(m,{placeholder:"Buscar tarefas por título, descrição ou responsável...",value:t,onChange:e=>T(e.target.value),className:"pl-12 h-12 text-base"})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(x,{value:te,onValueChange:re,children:[e.jsx(g,{className:"w-40",children:e.jsx(p,{placeholder:"Status"})}),e.jsxs(f,{children:[e.jsx(j,{value:"all",children:"Todos os Status"}),e.jsx(j,{value:"pending",children:"Pendentes"}),e.jsx(j,{value:"in_progress",children:"Em Progresso"}),e.jsx(j,{value:"completed",children:"Concluídas"})]})]}),e.jsxs(x,{value:ae,onValueChange:se,children:[e.jsx(g,{className:"w-40",children:e.jsx(p,{placeholder:"Prioridade"})}),e.jsxs(f,{children:[e.jsx(j,{value:"all",children:"Todas as Prioridades"}),e.jsx(j,{value:"high",children:"Alta"}),e.jsx(j,{value:"medium",children:"Média"}),e.jsx(j,{value:"low",children:"Baixa"})]})]})]})]})})}),e.jsxs(q,{defaultValue:"pending",className:"space-y-6",children:[e.jsxs(A,{className:"grid w-full grid-cols-3 bg-white border shadow-sm",children:[e.jsxs(U,{value:"pending",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Pendentes (",Ce.length,")"]}),e.jsxs(U,{value:"in_progress",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Em Progresso (",_e.length,")"]}),e.jsxs(U,{value:"completed",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Concluídas (",ke.length,")"]})]}),e.jsx(P,{value:"pending",className:"space-y-4",children:0===Ce.length?e.jsx(Te,{icon:w,title:"Nenhuma tarefa pendente",description:"Crie uma nova tarefa para começar a organizar seu trabalho"}):Ce.map(a=>e.jsx(Ee,{task:a},a.id))}),e.jsx(P,{value:"in_progress",className:"space-y-4",children:0===_e.length?e.jsx(Te,{icon:V,title:"Nenhuma tarefa em progresso",description:"Mova tarefas pendentes para em progresso quando começar a trabalhar nelas"}):_e.map(a=>e.jsx(Ee,{task:a},a.id))}),e.jsx(P,{value:"completed",className:"space-y-4",children:0===ke.length?e.jsx(Te,{icon:W,title:"Nenhuma tarefa concluída",description:"Complete algumas tarefas para vê-las aparecer aqui"}):ke.map(a=>e.jsx(Ee,{task:a},a.id))})]}),e.jsx(L,{open:le,onOpenChange:oe,children:e.jsxs(D,{className:"max-w-md",children:[e.jsx(R,{children:e.jsx(I,{className:"text-xl font-semibold",children:"Editar Tarefa"})}),ce&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"edit-title",children:"Título *"}),e.jsx(m,{id:"edit-title",value:ce.title,onChange:e=>de({...ce,title:e.target.value}),placeholder:"Digite o título da tarefa",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"edit-description",children:"Descrição"}),e.jsx(O,{id:"edit-description",value:ce.description||"",onChange:e=>de({...ce,description:e.target.value}),placeholder:"Descreva a tarefa em detalhes",className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"edit-priority",children:"Prioridade"}),e.jsxs(x,{value:ce.priority,onValueChange:e=>de({...ce,priority:e}),children:[e.jsx(g,{className:"mt-1",children:e.jsx(p,{})}),e.jsxs(f,{children:[e.jsx(j,{value:"low",children:"Baixa"}),e.jsx(j,{value:"medium",children:"Média"}),e.jsx(j,{value:"high",children:"Alta"})]})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"edit-due_date",children:"Data de Vencimento"}),e.jsx(m,{id:"edit-due_date",type:"date",value:ce.due_date?ce.due_date.split("T")[0]:"",onChange:e=>de({...ce,due_date:e.target.value}),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"edit-assigned_to",children:"Responsável"}),e.jsxs(x,{value:ce.assigned_to?.toString()||"none",onValueChange:e=>de({...ce,assigned_to:"none"===e?void 0:parseInt(e)}),children:[e.jsx(g,{className:"mt-1",children:e.jsx(p,{placeholder:"Selecione um responsável"})}),e.jsxs(f,{children:[e.jsx(j,{value:"none",children:"Sem responsável"}),Ne.map(a=>e.jsx(j,{value:a.id.toString(),children:a.name},a.id))]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(d,{variant:"outline",onClick:()=>oe(!1),className:"px-6",children:"Cancelar"}),e.jsx(d,{onClick:async()=>{if(ce)try{await je(ce.id,{title:ce.title,description:ce.description,priority:ce.priority,due_date:ce.due_date,assigned_to:ce.assigned_to,status:ce.status}),oe(!1),de(null),pe?b.success("Tarefa atualizada com sucesso!"):b.success("Tarefa atualizada offline. Será sincronizada quando conectar.",{icon:"📴"})}catch(e){b.error("Erro ao atualizar tarefa")}},disabled:ge,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 px-6",children:ge?"Salvando...":"Salvar Alterações"})]})]})]})})]})})})}export{ae as default};
