import{l as a,f as t}from"./index-Bmmyqco1.js";import{r as e}from"./vendor-v6ZOr5pf.js";import{P as o}from"./pointsCalculator-BwBrJ8sV.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=a("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),i=()=>{const{user:a}=t(),[s,i]=e.useState(null),[r,n]=e.useState(!0),[c,u]=e.useState(null),[m,l]=e.useState(null);e.useEffect(()=>{(async()=>{try{const a=await fetch("/api/system/points-config");if(a.ok){const t=await a.json();l(t)}}catch(a){}})()},[]);const d=async()=>{if(a?.id)try{n(!0),u(null);const t=await fetch(`/api/users/${a.id}/points-details`);if(!t.ok)throw new Error(`Erro ao carregar dados de pontuação: ${t.status}`);const e=await t.json();if(e.userData||(e.userData={engajamento:"Baixo",classificacao:"A resgatar",dizimista:"Não dizimista",ofertante:"Não ofertante",tempoBatismo:0,cargos:[],nomeUnidade:null,temLicao:!1,comunhao:0,missao:0,estudoBiblico:0,totalPresenca:0,batizouAlguem:!1,discipuladoPosBatismo:0,cpfValido:!1,camposVaziosACMS:!1}),e.userData.actualPoints=e.points,m){const a=e.points,t={engajamento:e.userData.engajamento&&"string"==typeof e.userData.engajamento?e.userData.engajamento.toLowerCase().includes("baixo")?m.engajamento.baixo:e.userData.engajamento.toLowerCase().includes("médio")||e.userData.engajamento.toLowerCase().includes("medio")?m.engajamento.medio:e.userData.engajamento.toLowerCase().includes("alto")?m.engajamento.alto:0:0,classificacao:e.userData.classificacao&&"string"==typeof e.userData.classificacao?e.userData.classificacao.toLowerCase().includes("frequente")?m.classificacao.frequente:m.classificacao.naoFrequente:0,dizimista:e.userData.dizimista&&"string"==typeof e.userData.dizimista?e.userData.dizimista.toLowerCase().includes("não dizimista")||e.userData.dizimista.toLowerCase().includes("nao dizimista")?m.dizimista.naoDizimista:e.userData.dizimista.toLowerCase().includes("pontual")?m.dizimista.pontual:e.userData.dizimista.toLowerCase().includes("sazonal")?m.dizimista.sazonal:e.userData.dizimista.toLowerCase().includes("recorrente")?m.dizimista.recorrente:0:0,ofertante:e.userData.ofertante&&"string"==typeof e.userData.ofertante?e.userData.ofertante.toLowerCase().includes("não ofertante")||e.userData.ofertante.toLowerCase().includes("nao ofertante")?m.ofertante.naoOfertante:e.userData.ofertante.toLowerCase().includes("pontual")?m.ofertante.pontual:e.userData.ofertante.toLowerCase().includes("sazonal")?m.ofertante.sazonal:e.userData.ofertante.toLowerCase().includes("recorrente")?m.ofertante.recorrente:0:0,tempoBatismo:e.userData.tempoBatismo?e.userData.tempoBatismo>=2&&e.userData.tempoBatismo<5?m.tempoBatismo.doisAnos:e.userData.tempoBatismo>=5&&e.userData.tempoBatismo<10?m.tempoBatismo.cincoAnos:e.userData.tempoBatismo>=10&&e.userData.tempoBatismo<20?m.tempoBatismo.dezAnos:e.userData.tempoBatismo>=20&&e.userData.tempoBatismo<30?m.tempoBatismo.vinteAnos:e.userData.tempoBatismo>=30?m.tempoBatismo.maisVinte:0:0,cargos:e.userData.cargos&&e.userData.cargos.length>0?1===e.userData.cargos.length?m.cargos.umCargo:2===e.userData.cargos.length?m.cargos.doisCargos:m.cargos.tresOuMais:0,nomeUnidade:e.userData.nomeUnidade?m.nomeUnidade.comUnidade:0,temLicao:e.userData.temLicao?m.temLicao.comLicao:0,comunhao:e.userData.escolaSabatina?.comunhao?e.userData.escolaSabatina.comunhao*m.escolaSabatina.comunhao:0,missao:e.userData.escolaSabatina?.missao?e.userData.escolaSabatina.missao*m.escolaSabatina.missao:0,estudoBiblico:e.userData.escolaSabatina?.estudoBiblico?e.userData.escolaSabatina.estudoBiblico*m.escolaSabatina.estudoBiblico:0,totalPresenca:void 0!==e.userData.totalPresenca?e.userData.totalPresenca>=0&&e.userData.totalPresenca<=3?m.totalPresenca.zeroATres:e.userData.totalPresenca>=4&&e.userData.totalPresenca<=7?m.totalPresenca.quatroASete:m.totalPresenca.oitoATreze:0,batizouAlguem:e.userData.escolaSabatina?.batizouAlguem?m.escolaSabatina.batizouAlguem:0,discipuladoPosBatismo:e.userData.escolaSabatina?.discipuladoPosBatismo?e.userData.escolaSabatina.discipuladoPosBatismo*m.escolaSabatina.discipuladoPosBatismo:0,cpfValido:e.userData.cpfValido?m.cpfValido.valido:0,camposVaziosACMS:!1===e.userData.camposVaziosACMS?m.camposVaziosACMS.completos:0};i({...e,breakdown:t,total:a}),e.userData.actualPoints=a}else{const{total:a,breakdown:t}=o.calculateDetailedPoints(e.userData);i({...e,breakdown:t,total:a}),e.userData.actualPoints=e.points}}catch(t){u(t instanceof Error?t.message:"Erro desconhecido")}finally{n(!1)}else n(!1)};e.useEffect(()=>{d()},[a?.id,m]);return{data:s,isLoading:r,error:c,refetch:()=>{d()}}};export{s as A,i as u};
