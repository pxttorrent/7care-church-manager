import{j as e}from"./ui-CM4P41nz.js";import{r as s}from"./vendor-v6ZOr5pf.js";import{n as a,f as i,g as r,u as t,l as n,k as c,e as o,C as l,c as m,a as d,b as h,m as x,B as j,U as u,G as f,a1 as p,a2 as g,F as N}from"./index-BcdCo1jD.js";import{L as v}from"./loader-circle-BGAYY2cv.js";import{R as w}from"./refresh-cw-CZFHfx6u.js";import{P as b}from"./plus-C2dkKquG.js";import{V as y}from"./vote-BULnpMTZ.js";import{C as E}from"./clock-DFelFvJ_.js";import{S as k}from"./square-pen-CvRF-eH_.js";import{P as C}from"./play-DubF1_mE.js";import{T as z}from"./trash-2-DToaqg7q.js";import"./charts-56rtB2he.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=a("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);function S(){i();const{toast:a}=r(),S=t(),[P,_]=s.useState([]),[D,T]=s.useState(!0),[$,I]=s.useState(!0);s.useEffect(()=>{if(F(),$){const e=setInterval(F,5e3);return()=>clearInterval(e)}},[$]);const F=async()=>{try{const e=await fetch("/api/elections/configs");if(e.ok){const s=await e.json();_(s)}}catch(e){a({title:"Erro",description:"Erro ao carregar configurações de nomeação",variant:"destructive"})}finally{T(!1)}},L=s=>"active"===s.election_status?e.jsxs(j,{variant:"default",className:"bg-green-500",children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),"Ativa"]}):"draft"===s.status?e.jsxs(j,{variant:"secondary",children:[e.jsx(N,{className:"w-3 h-3 mr-1"}),"Rascunho"]}):e.jsxs(j,{variant:"outline",children:[e.jsx(A,{className:"w-3 h-3 mr-1"}),"Pausada"]}),R=s=>s.election_status&&"active"===s.election_status?e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mb-1",children:[e.jsx("span",{children:"Nomeação em Andamento"}),e.jsx("span",{children:"Ativa"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"100%"}})})]}):null;return D?e.jsx(n,{children:e.jsxs("div",{className:"p-4 flex items-center justify-center min-h-[50vh]",children:[e.jsx(v,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Carregando configurações..."})]})}):e.jsx(n,{children:e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard de Nomeações"}),e.jsx("p",{className:"text-muted-foreground",children:"Gerencie todas as nomeações da igreja"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>I(!$),children:[e.jsx(w,{className:"h-4 w-4 mr-2 "+($?"animate-spin":"")}),$?"Pausar":"Atualizar"]}),e.jsxs(o,{onClick:()=>S("/election-config"),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Nova Nomeação"]})]})]}),0===P.length?e.jsx(l,{children:e.jsxs(m,{className:"p-8 text-center",children:[e.jsx(y,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Nenhuma nomeação configurada"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Configure uma nova nomeação para começar o processo de eleição de liderança."}),e.jsxs(o,{onClick:()=>S("/election-config"),children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Configurar Nomeação"]})]})}):e.jsx("div",{className:"grid gap-4",children:P.map(s=>e.jsxs(l,{className:"hover:shadow-md transition-shadow",children:[e.jsx(d,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{className:"text-lg",children:s.church_name}),e.jsxs(x,{children:[s.positions.length," cargos • ",s.voters.length," votantes"]})]}),L(s)]})}),e.jsx(m,{className:"pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(j,{variant:"outline",className:"text-xs",children:[e.jsx(u,{className:"w-3 h-3 mr-1"}),s.voters.length," votantes"]}),e.jsxs(j,{variant:"outline",className:"text-xs",children:[e.jsx(y,{className:"w-3 h-3 mr-1"}),s.positions.length," cargos"]}),e.jsxs(j,{variant:"outline",className:"text-xs",children:[e.jsx(E,{className:"w-3 h-3 mr-1"}),new Date(s.created_at).toLocaleDateString("pt-BR")]})]}),R(s),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:["active"===s.election_status?e.jsxs(e.Fragment,{children:[e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>S(`/election-dashboard/${s.id}`),children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Acompanhar"]}),e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>S(`/election-config?id=${s.id}`),children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Editar"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{size:"sm",onClick:()=>(async e=>{try{if(!(await fetch("/api/elections/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({configId:e})})).ok)throw new Error("Erro ao iniciar nomeação");a({title:"Nomeação iniciada",description:"A nomeação foi iniciada com sucesso!"}),F()}catch(s){a({title:"Erro",description:"Não foi possível iniciar a nomeação.",variant:"destructive"})}})(s.id),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Iniciar"]}),e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>S(`/election-config?id=${s.id}`),children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Editar"]})]}),e.jsxs(o,{size:"sm",variant:"destructive",onClick:()=>(async e=>{if(confirm("Tem certeza que deseja excluir esta configuração? Esta ação não pode ser desfeita."))try{if(!(await fetch(`/api/elections/config/${e}`,{method:"DELETE"})).ok)throw new Error("Erro ao excluir configuração");a({title:"Configuração excluída",description:"A configuração foi excluída com sucesso!"}),F()}catch(s){a({title:"Erro",description:"Não foi possível excluir a configuração.",variant:"destructive"})}})(s.id),children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Excluir"]})]})]})})]},s.id))}),P.length>0&&e.jsxs(p,{children:[e.jsx(c,{className:"h-4 w-4"}),e.jsxs(g,{children:[e.jsx("strong",{children:"Múltiplas Nomeações:"})," Você pode gerenciar várias nomeações simultaneamente. Cada configuração é independente e pode estar em diferentes fases."]})]})]})})}export{S as default};
