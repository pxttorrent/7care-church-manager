import{Z as e,P as t,_ as s,$ as a,a0 as r,a1 as i,a2 as o,j as l,k as n,b as d,a3 as c,c as m,u,e as h,A as x,d as p,g as v,a4 as g,a5 as f,a6 as j,a7 as b,a8 as N,D as y,C as w,n as C,a9 as k,aa as D,l as S,ab as E,ac as A,ad as P,ae as z}from"./ui-D1vmdbY6.js";import{r as I,R as M}from"./vendor-Ber6wfih.js";import{u as F}from"./useQuery-Bj7SFEGi.js";import{c as O,g as R,e as T,U as q,B as $,L as V,I as B,f as _,Q as U,j as K,h as L,X as Q,i as J,C as G,d as W,y as Y,J as H,R as Z,H as X,M as ee,E as te,a as se,b as ae,s as re,t as ie,v as oe,w as le,x as ne,l as de,W as ce,o as me,z as ue,D as he,A as xe,F as pe,Y as ve}from"./index-C92eqfkZ.js";import{C as ge,B as fe,u as je}from"./useMutation-iDw-Op72.js";import{u as be,A as Ne}from"./useUserPoints-Dp1XMNjG.js";import{A as ye,a as we,b as Ce}from"./avatar-DuN_WZ4X.js";import{M as ke,d as De,e as Se,f as Ee}from"./mount-icon-CHL4eerX.js";import{D as Ae,a as Pe,b as ze,c as Ie,d as Me}from"./dialog-Di7U0d2u.js";import{S as Fe}from"./search-DgLsIosa.js";import{T as Oe}from"./triangle-alert-DYf_E5MV.js";import{C as Re}from"./clock-CgghDO7Z.js";import{M as Te}from"./map-pin-Bxl8OFZO.js";import{T as qe}from"./trash-2-BLo4CZpn.js";import{T as $e}from"./textarea-CdDEJsVm.js";import{G as Ve,M as Be}from"./mountain-m6suV2bz.js";import{S as _e}from"./shield-B2KzWFKs.js";import{U as Ue}from"./user-plus-DIQGTr8d.js";import"./charts-leMEfCN9.js";import"./pointsCalculator-BT49x4k-.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=O("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),Le=O("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),Qe=O("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),Je=O("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),Ge=O("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),We=O("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),Ye=O("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),He=O("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),Ze=O("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Xe=.999,et=/[\\\/_+.#"@\[\(\{&]/,tt=/[\\\/_+.#"@\[\(\{&]/g,st=/[\s-]/,at=/[\s-]/g;function rt(e,t,s,a,r,i,o){if(i===t.length)return r===e.length?1:.99;var l=`${r},${i}`;if(void 0!==o[l])return o[l];for(var n,d,c,m,u=a.charAt(i),h=s.indexOf(u,r),x=0;h>=0;)(n=rt(e,t,s,a,h+1,i+1,o))>x&&(h===r?n*=1:et.test(e.charAt(h-1))?(n*=.8,(c=e.slice(r,h-1).match(tt))&&r>0&&(n*=Math.pow(Xe,c.length))):st.test(e.charAt(h-1))?(n*=.9,(m=e.slice(r,h-1).match(at))&&r>0&&(n*=Math.pow(Xe,m.length))):(n*=.17,r>0&&(n*=Math.pow(Xe,h-r))),e.charAt(h)!==t.charAt(i)&&(n*=.9999)),(n<.1&&s.charAt(h-1)===a.charAt(i+1)||a.charAt(i+1)===a.charAt(i)&&s.charAt(h-1)!==a.charAt(i))&&(.1*(d=rt(e,t,s,a,h+1,i+2,o))>n&&(n=.1*d)),n>x&&(x=n),h=s.indexOf(u,h+1);return o[l]=x,x}function it(e){return e.toLowerCase().replace(at," ")}function ot(e,t,s){return rt(e=s&&s.length>0?""+(e+" "+s.join(" ")):e,t,it(e),it(t),0,0,{})}var lt='[cmdk-group=""]',nt='[cmdk-group-items=""]',dt='[cmdk-item=""]',ct=`${dt}:not([aria-disabled="true"])`,mt="cmdk-item-select",ut="data-value",ht=(e,t,s)=>ot(e,t,s),xt=I.createContext(void 0),pt=()=>I.useContext(xt),vt=I.createContext(void 0),gt=()=>I.useContext(vt),ft=I.createContext(void 0),jt=I.forwardRef((s,a)=>{let r=Mt(()=>{var e,t;return{search:"",value:null!=(t=null!=(e=s.value)?e:s.defaultValue)?t:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),i=Mt(()=>new Set),o=Mt(()=>new Map),l=Mt(()=>new Map),n=Mt(()=>new Set),d=zt(s),{label:c,children:m,value:u,onValueChange:h,filter:x,shouldFilter:p,loop:v,disablePointerSelection:g=!1,vimBindings:f=!0,...j}=s,b=e(),N=e(),y=e(),w=I.useRef(null),C=Rt();It(()=>{if(void 0!==u){let e=u.trim();r.current.value=e,k.emit()}},[u]),It(()=>{C(6,z)},[]);let k=I.useMemo(()=>({subscribe:e=>(n.current.add(e),()=>n.current.delete(e)),snapshot:()=>r.current,setState:(e,t,s)=>{var a,i,o,l;if(!Object.is(r.current[e],t)){if(r.current[e]=t,"search"===e)P(),E(),C(1,A);else if("value"===e){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let e=document.getElementById(y);e?e.focus():null==(a=document.getElementById(b))||a.focus()}if(C(7,()=>{var e;r.current.selectedItemId=null==(e=M())?void 0:e.id,k.emit()}),s||C(5,z),void 0!==(null==(i=d.current)?void 0:i.value)){let e=null!=t?t:"";return void(null==(l=(o=d.current).onValueChange)||l.call(o,e))}}k.emit()}},emit:()=>{n.current.forEach(e=>e())}}),[]),D=I.useMemo(()=>({value:(e,t,s)=>{var a;t!==(null==(a=l.current.get(e))?void 0:a.value)&&(l.current.set(e,{value:t,keywords:s}),r.current.filtered.items.set(e,S(t,s)),C(2,()=>{E(),k.emit()}))},item:(e,t)=>(i.current.add(e),t&&(o.current.has(t)?o.current.get(t).add(e):o.current.set(t,new Set([e]))),C(3,()=>{P(),E(),r.current.value||A(),k.emit()}),()=>{l.current.delete(e),i.current.delete(e),r.current.filtered.items.delete(e);let t=M();C(4,()=>{P(),(null==t?void 0:t.getAttribute("id"))===e&&A(),k.emit()})}),group:e=>(o.current.has(e)||o.current.set(e,new Set),()=>{l.current.delete(e),o.current.delete(e)}),filter:()=>d.current.shouldFilter,label:c||s["aria-label"],getDisablePointerSelection:()=>d.current.disablePointerSelection,listId:b,inputId:y,labelId:N,listInnerRef:w}),[]);function S(e,t){var s,a;let i=null!=(a=null==(s=d.current)?void 0:s.filter)?a:ht;return e?i(e,r.current.search,t):0}function E(){if(!r.current.search||!1===d.current.shouldFilter)return;let e=r.current.filtered.items,t=[];r.current.filtered.groups.forEach(s=>{let a=o.current.get(s),r=0;a.forEach(t=>{let s=e.get(t);r=Math.max(s,r)}),t.push([s,r])});let s=w.current;F().sort((t,s)=>{var a,r;let i=t.getAttribute("id"),o=s.getAttribute("id");return(null!=(a=e.get(o))?a:0)-(null!=(r=e.get(i))?r:0)}).forEach(e=>{let t=e.closest(nt);t?t.appendChild(e.parentElement===t?e:e.closest(`${nt} > *`)):s.appendChild(e.parentElement===s?e:e.closest(`${nt} > *`))}),t.sort((e,t)=>t[1]-e[1]).forEach(e=>{var t;let s=null==(t=w.current)?void 0:t.querySelector(`${lt}[${ut}="${encodeURIComponent(e[0])}"]`);null==s||s.parentElement.appendChild(s)})}function A(){let e=F().find(e=>"true"!==e.getAttribute("aria-disabled")),t=null==e?void 0:e.getAttribute(ut);k.setState("value",t||void 0)}function P(){var e,t,s,a;if(!r.current.search||!1===d.current.shouldFilter)return void(r.current.filtered.count=i.current.size);r.current.filtered.groups=new Set;let n=0;for(let o of i.current){let i=S(null!=(t=null==(e=l.current.get(o))?void 0:e.value)?t:"",null!=(a=null==(s=l.current.get(o))?void 0:s.keywords)?a:[]);r.current.filtered.items.set(o,i),i>0&&n++}for(let[i,l]of o.current)for(let e of l)if(r.current.filtered.items.get(e)>0){r.current.filtered.groups.add(i);break}r.current.filtered.count=n}function z(){var e,t,s;let a=M();a&&((null==(e=a.parentElement)?void 0:e.firstChild)===a&&(null==(s=null==(t=a.closest(lt))?void 0:t.querySelector('[cmdk-group-heading=""]'))||s.scrollIntoView({block:"nearest"})),a.scrollIntoView({block:"nearest"}))}function M(){var e;return null==(e=w.current)?void 0:e.querySelector(`${dt}[aria-selected="true"]`)}function F(){var e;return Array.from((null==(e=w.current)?void 0:e.querySelectorAll(ct))||[])}function O(e){let t=F()[e];t&&k.setState("value",t.getAttribute(ut))}function R(e){var t;let s=M(),a=F(),r=a.findIndex(e=>e===s),i=a[r+e];null!=(t=d.current)&&t.loop&&(i=r+e<0?a[a.length-1]:r+e===a.length?a[0]:a[r+e]),i&&k.setState("value",i.getAttribute(ut))}function T(e){let t,s=M(),a=null==s?void 0:s.closest(lt);for(;a&&!t;)a=e>0?At(a,lt):Pt(a,lt),t=null==a?void 0:a.querySelector(ct);t?k.setState("value",t.getAttribute(ut)):R(e)}let q=()=>O(F().length-1),$=e=>{e.preventDefault(),e.metaKey?q():e.altKey?T(1):R(1)},V=e=>{e.preventDefault(),e.metaKey?O(0):e.altKey?T(-1):R(-1)};return I.createElement(t.div,{ref:a,tabIndex:-1,...j,"cmdk-root":"",onKeyDown:e=>{var t;null==(t=j.onKeyDown)||t.call(j,e);let s=e.nativeEvent.isComposing||229===e.keyCode;if(!e.defaultPrevented&&!s)switch(e.key){case"n":case"j":f&&e.ctrlKey&&$(e);break;case"ArrowDown":$(e);break;case"p":case"k":f&&e.ctrlKey&&V(e);break;case"ArrowUp":V(e);break;case"Home":e.preventDefault(),O(0);break;case"End":e.preventDefault(),q();break;case"Enter":{e.preventDefault();let t=M();if(t){let e=new Event(mt);t.dispatchEvent(e)}}}}},I.createElement("label",{"cmdk-label":"",htmlFor:D.inputId,id:D.labelId,style:qt},c),Tt(s,e=>I.createElement(vt.Provider,{value:k},I.createElement(xt.Provider,{value:D},e))))}),bt=I.forwardRef((s,a)=>{var r,i;let l=e(),n=I.useRef(null),d=I.useContext(ft),c=pt(),m=zt(s),u=null!=(i=null==(r=m.current)?void 0:r.forceMount)?i:null==d?void 0:d.forceMount;It(()=>{if(!u)return c.item(l,null==d?void 0:d.id)},[u]);let h=Ot(l,n,[s.value,s.children,n],s.keywords),x=gt(),p=Ft(e=>e.value&&e.value===h.current),v=Ft(e=>!(!u&&!1!==c.filter())||(!e.search||e.filtered.items.get(l)>0));function g(){var e,t;f(),null==(t=(e=m.current).onSelect)||t.call(e,h.current)}function f(){x.setState("value",h.current,!0)}if(I.useEffect(()=>{let e=n.current;if(e&&!s.disabled)return e.addEventListener(mt,g),()=>e.removeEventListener(mt,g)},[v,s.onSelect,s.disabled]),!v)return null;let{disabled:j,value:b,onSelect:N,forceMount:y,keywords:w,...C}=s;return I.createElement(t.div,{ref:o(n,a),...C,id:l,"cmdk-item":"",role:"option","aria-disabled":!!j,"aria-selected":!!p,"data-disabled":!!j,"data-selected":!!p,onPointerMove:j||c.getDisablePointerSelection()?void 0:f,onClick:j?void 0:g},s.children)}),Nt=I.forwardRef((s,a)=>{let{heading:r,children:i,forceMount:l,...n}=s,d=e(),c=I.useRef(null),m=I.useRef(null),u=e(),h=pt(),x=Ft(e=>!(!l&&!1!==h.filter())||(!e.search||e.filtered.groups.has(d)));It(()=>h.group(d),[]),Ot(d,c,[s.value,s.heading,m]);let p=I.useMemo(()=>({id:d,forceMount:l}),[l]);return I.createElement(t.div,{ref:o(c,a),...n,"cmdk-group":"",role:"presentation",hidden:!x||void 0},r&&I.createElement("div",{ref:m,"cmdk-group-heading":"","aria-hidden":!0,id:u},r),Tt(s,e=>I.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?u:void 0},I.createElement(ft.Provider,{value:p},e))))}),yt=I.forwardRef((e,s)=>{let{alwaysRender:a,...r}=e,i=I.useRef(null),l=Ft(e=>!e.search);return a||l?I.createElement(t.div,{ref:o(i,s),...r,"cmdk-separator":"",role:"separator"}):null}),wt=I.forwardRef((e,s)=>{let{onValueChange:a,...r}=e,i=null!=e.value,o=gt(),l=Ft(e=>e.search),n=Ft(e=>e.selectedItemId),d=pt();return I.useEffect(()=>{null!=e.value&&o.setState("search",e.value)},[e.value]),I.createElement(t.input,{ref:s,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":d.listId,"aria-labelledby":d.labelId,"aria-activedescendant":n,id:d.inputId,type:"text",value:i?e.value:l,onChange:e=>{i||o.setState("search",e.target.value),null==a||a(e.target.value)}})}),Ct=I.forwardRef((e,s)=>{let{children:a,label:r="Suggestions",...i}=e,l=I.useRef(null),n=I.useRef(null),d=Ft(e=>e.selectedItemId),c=pt();return I.useEffect(()=>{if(n.current&&l.current){let e,t=n.current,s=l.current,a=new ResizeObserver(()=>{e=requestAnimationFrame(()=>{let e=t.offsetHeight;s.style.setProperty("--cmdk-list-height",e.toFixed(1)+"px")})});return a.observe(t),()=>{cancelAnimationFrame(e),a.unobserve(t)}}},[]),I.createElement(t.div,{ref:o(l,s),...i,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":d,"aria-label":r,id:c.listId},Tt(e,e=>I.createElement("div",{ref:o(n,c.listInnerRef),"cmdk-list-sizer":""},e)))}),kt=I.forwardRef((e,t)=>{let{open:o,onOpenChange:l,overlayClassName:n,contentClassName:d,container:c,...m}=e;return I.createElement(s,{open:o,onOpenChange:l},I.createElement(a,{container:c},I.createElement(r,{"cmdk-overlay":"",className:n}),I.createElement(i,{"aria-label":e.label,"cmdk-dialog":"",className:d},I.createElement(jt,{ref:t,...m}))))}),Dt=I.forwardRef((e,s)=>Ft(e=>0===e.filtered.count)?I.createElement(t.div,{ref:s,...e,"cmdk-empty":"",role:"presentation"}):null),St=I.forwardRef((e,s)=>{let{progress:a,children:r,label:i="Loading...",...o}=e;return I.createElement(t.div,{ref:s,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":a,"aria-valuemin":0,"aria-valuemax":100,"aria-label":i},Tt(e,e=>I.createElement("div",{"aria-hidden":!0},e)))}),Et=Object.assign(jt,{List:Ct,Item:bt,Input:wt,Group:Nt,Separator:yt,Dialog:kt,Empty:Dt,Loading:St});function At(e,t){let s=e.nextElementSibling;for(;s;){if(s.matches(t))return s;s=s.nextElementSibling}}function Pt(e,t){let s=e.previousElementSibling;for(;s;){if(s.matches(t))return s;s=s.previousElementSibling}}function zt(e){let t=I.useRef(e);return It(()=>{t.current=e}),t}var It="undefined"==typeof window?I.useEffect:I.useLayoutEffect;function Mt(e){let t=I.useRef();return void 0===t.current&&(t.current=e()),t}function Ft(e){let t=gt(),s=()=>e(t.snapshot());return I.useSyncExternalStore(t.subscribe,s,s)}function Ot(e,t,s,a=[]){let r=I.useRef(),i=pt();return It(()=>{var o;let l=(()=>{var e;for(let t of s){if("string"==typeof t)return t.trim();if("object"==typeof t&&"current"in t)return t.current?null==(e=t.current.textContent)?void 0:e.trim():r.current}})(),n=a.map(e=>e.trim());i.value(e,l,n),null==(o=t.current)||o.setAttribute(ut,l),r.current=l}),r}var Rt=()=>{let[e,t]=I.useState(),s=Mt(()=>new Map);return It(()=>{s.current.forEach(e=>e()),s.current=new Map},[e]),(e,a)=>{s.current.set(e,a),t({})}};function Tt({asChild:e,children:t},s){return e&&I.isValidElement(t)?I.cloneElement(function(e){let t=e.type;return"function"==typeof t?t(e.props):"render"in t?t.render(e.props):e}(t),{ref:t.ref},s(t.props.children)):s(t)}var qt={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const $t=I.forwardRef(({className:e,...t},s)=>l.jsx(Et,{ref:s,className:R("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));$t.displayName=Et.displayName;const Vt=I.forwardRef(({className:e,...t},s)=>l.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[l.jsx(Fe,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),l.jsx(Et.Input,{ref:s,className:R("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));Vt.displayName=Et.Input.displayName;const Bt=I.forwardRef(({className:e,...t},s)=>l.jsx(Et.List,{ref:s,className:R("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));Bt.displayName=Et.List.displayName;const _t=I.forwardRef((e,t)=>l.jsx(Et.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));_t.displayName=Et.Empty.displayName;const Ut=I.forwardRef(({className:e,...t},s)=>l.jsx(Et.Group,{ref:s,className:R("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));Ut.displayName=Et.Group.displayName;I.forwardRef(({className:e,...t},s)=>l.jsx(Et.Separator,{ref:s,className:R("-mx-1 h-px bg-border",e),...t})).displayName=Et.Separator.displayName;const Kt=I.forwardRef(({className:e,...t},s)=>l.jsx(Et.Item,{ref:s,className:R("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...t}));Kt.displayName=Et.Item.displayName;var Lt="Popover",[Qt,Jt]=m(Lt,[n]),Gt=n(),[Wt,Yt]=Qt(Lt),Ht=t=>{const{__scopePopover:s,children:a,open:r,defaultOpen:i,onOpenChange:o,modal:n=!1}=t,m=Gt(s),u=I.useRef(null),[h,x]=I.useState(!1),[p,v]=d({prop:r,defaultProp:i??!1,onChange:o,caller:Lt});return l.jsx(c,{...m,children:l.jsx(Wt,{scope:s,contentId:e(),triggerRef:u,open:p,onOpenChange:v,onOpenToggle:I.useCallback(()=>v(e=>!e),[v]),hasCustomAnchor:h,onCustomAnchorAdd:I.useCallback(()=>x(!0),[]),onCustomAnchorRemove:I.useCallback(()=>x(!1),[]),modal:n,children:a})})};Ht.displayName=Lt;var Zt="PopoverAnchor";I.forwardRef((e,t)=>{const{__scopePopover:s,...a}=e,r=Yt(Zt,s),i=Gt(s),{onCustomAnchorAdd:o,onCustomAnchorRemove:n}=r;return I.useEffect(()=>(o(),()=>n()),[o,n]),l.jsx(x,{...i,...a,ref:t})}).displayName=Zt;var Xt="PopoverTrigger",es=I.forwardRef((e,s)=>{const{__scopePopover:a,...r}=e,i=Yt(Xt,a),o=Gt(a),n=u(s,i.triggerRef),d=l.jsx(t.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":us(i.open),...r,ref:n,onClick:h(e.onClick,i.onOpenToggle)});return i.hasCustomAnchor?d:l.jsx(x,{asChild:!0,...o,children:d})});es.displayName=Xt;var ts="PopoverPortal",[ss,as]=Qt(ts,{forceMount:void 0}),rs=e=>{const{__scopePopover:t,forceMount:s,children:a,container:r}=e,i=Yt(ts,t);return l.jsx(ss,{scope:t,forceMount:s,children:l.jsx(p,{present:s||i.open,children:l.jsx(v,{asChild:!0,container:r,children:a})})})};rs.displayName=ts;var is="PopoverContent",os=I.forwardRef((e,t)=>{const s=as(is,e.__scopePopover),{forceMount:a=s.forceMount,...r}=e,i=Yt(is,e.__scopePopover);return l.jsx(p,{present:a||i.open,children:i.modal?l.jsx(ns,{...r,ref:t}):l.jsx(ds,{...r,ref:t})})});os.displayName=is;var ls=j("PopoverContent.RemoveScroll"),ns=I.forwardRef((e,t)=>{const s=Yt(is,e.__scopePopover),a=I.useRef(null),r=u(t,a),i=I.useRef(!1);return I.useEffect(()=>{const e=a.current;if(e)return g(e)},[]),l.jsx(f,{as:ls,allowPinchZoom:!0,children:l.jsx(cs,{...e,ref:r,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:h(e.onCloseAutoFocus,e=>{var t;e.preventDefault(),i.current||null==(t=s.triggerRef.current)||t.focus()}),onPointerDownOutside:h(e.onPointerDownOutside,e=>{const t=e.detail.originalEvent,s=0===t.button&&!0===t.ctrlKey,a=2===t.button||s;i.current=a},{checkForDefaultPrevented:!1}),onFocusOutside:h(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),ds=I.forwardRef((e,t)=>{const s=Yt(is,e.__scopePopover),a=I.useRef(!1),r=I.useRef(!1);return l.jsx(cs,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{var i,o;null==(i=e.onCloseAutoFocus)||i.call(e,t),t.defaultPrevented||(a.current||null==(o=s.triggerRef.current)||o.focus(),t.preventDefault()),a.current=!1,r.current=!1},onInteractOutside:t=>{var i,o;null==(i=e.onInteractOutside)||i.call(e,t),t.defaultPrevented||(a.current=!0,"pointerdown"===t.detail.originalEvent.type&&(r.current=!0));const l=t.target;(null==(o=s.triggerRef.current)?void 0:o.contains(l))&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&r.current&&t.preventDefault()}})}),cs=I.forwardRef((e,t)=>{const{__scopePopover:s,trapFocus:a,onOpenAutoFocus:r,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:n,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:m,...u}=e,h=Yt(is,s),x=Gt(s);return b(),l.jsx(N,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:r,onUnmountAutoFocus:i,children:l.jsx(y,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:m,onEscapeKeyDown:n,onPointerDownOutside:d,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:l.jsx(w,{"data-state":us(h.open),role:"dialog",id:h.contentId,...x,...u,ref:t,style:{...u.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ms="PopoverClose";I.forwardRef((e,s)=>{const{__scopePopover:a,...r}=e,i=Yt(ms,a);return l.jsx(t.button,{type:"button",...r,ref:s,onClick:h(e.onClick,()=>i.onOpenChange(!1))})}).displayName=ms;function us(e){return e?"open":"closed"}I.forwardRef((e,t)=>{const{__scopePopover:s,...a}=e,r=Gt(s);return l.jsx(C,{...r,...a,ref:t})}).displayName="PopoverArrow";var hs=rs,xs=os;const ps=Ht,vs=es,gs=I.forwardRef(({className:e,align:t="center",sideOffset:s=4,...a},r)=>l.jsx(hs,{children:l.jsx(xs,{ref:r,align:t,sideOffset:s,className:R("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));gs.displayName=xs.displayName;const fs=({isOpen:e,onClose:t,onConfirm:s,userName:a,isLoading:r=!1,visitCount:i=0,lastVisitDate:o})=>{const[n,d]=I.useState("");I.useEffect(()=>{if(e){const e=new Date,t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");d(`${t}-${s}-${a}`)}},[e]);const c=0===i,m=i>0;return l.jsx(Ae,{open:e,onOpenChange:e=>!e&&t(),children:l.jsxs(Pe,{className:"sm:max-w-md","aria-describedby":"mark-visit-modal-description",children:[l.jsx("div",{id:"mark-visit-modal-description",className:"sr-only",children:c?"Formulário para registrar primeira visita realizada":"Formulário para registrar nova visita realizada"}),l.jsx(ze,{children:l.jsxs(Ie,{className:"flex items-center gap-2",children:[l.jsx(T,{className:"h-5 w-5 text-blue-600"}),c?"Registrar Primeira Visita Realizada":"Registrar Nova Visita Realizada"]})}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"text-sm text-muted-foreground",children:c?`Confirmar que a primeira visita ao membro <strong>${a}</strong> foi realizada.`:`Confirmar que uma nova visita ao membro <strong>${a}</strong> foi realizada.`}),m&&l.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(q,{className:"h-4 w-4 text-blue-600"}),l.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Histórico de Visitas"})]}),l.jsxs("div",{className:"space-y-1 text-xs text-blue-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Total de visitas:"}),l.jsxs($,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[i," visita",i>1?"s":""]})]}),o&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Última visita:"}),l.jsx("span",{className:"font-medium",children:(e=>{if(!e)return"";return new Date(e).toLocaleDateString("pt-BR")})(o)})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"visit-date",children:c?"Data da Primeira Visita Realizada":"Data da Nova Visita Realizada"}),l.jsx(B,{id:"visit-date",type:"date",value:n,onChange:e=>d(e.target.value),className:"w-full",max:(new Date).toISOString().split("T")[0]}),l.jsx("p",{className:"text-xs text-muted-foreground",children:c?"Esta será a primeira visita realizada registrada para este membro.":"Esta visita realizada será adicionada ao histórico existente."})]}),l.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[l.jsxs(_,{variant:"outline",onClick:()=>{d(""),t()},disabled:r,children:[l.jsx(ge,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),l.jsxs(_,{onClick:()=>{n&&s(n)},disabled:!n||r,className:"bg-green-600 hover:bg-green-700",children:[l.jsx(U,{className:"h-4 w-4 mr-2"}),r?"Confirmando...":c?"Confirmar Primeira Visita Realizada":"Confirmar Nova Visita Realizada"]})]})]})]})})},js=M.memo(({interestedId:e,currentDiscipuladores:t,potentialMissionaries:s,onDiscipuladoresChange:a})=>{const[r,i]=I.useState(!1),[o,n]=I.useState(!1),[d,c]=I.useState(null),{toast:m}=K(),u=I.useMemo(()=>s.filter(e=>!t.some(t=>t.missionaryId===e.id)),[s,t]),h=I.useCallback(async r=>{n(!0);try{const o=await fetch("/api/relationships",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({missionaryId:r,interestedId:e,notes:"Discipulador adicionado via interface"})});if(!o.ok)throw new Error("Erro ao adicionar discipulador");const l=await o.json(),n=s.find(e=>e.id===r),d={id:l.id,missionaryId:l.missionaryId,interestedId:l.interestedId,status:l.status,assignedAt:l.assignedAt,notes:l.notes,missionaryName:(null==n?void 0:n.name)||"Nome não encontrado",missionaryEmail:(null==n?void 0:n.email)||"",missionaryPhone:(null==n?void 0:n.phone)||""},c=[...t,d];a(c),m({title:"Discipulador adicionado",description:`${null==n?void 0:n.name} foi adicionado como discipulador.`}),i(!1)}catch(o){m({title:"Erro",description:"Não foi possível adicionar o discipulador.",variant:"destructive"})}finally{n(!1)}},[e,t,s,a,m]),x=I.useCallback(async e=>{c(e);try{if(!(await fetch(`/api/relationships/${e}`,{method:"DELETE"})).ok)throw new Error("Erro ao remover discipulador");const s=t.filter(t=>t.id!==e);a(s),m({title:"Discipulador removido",description:"O discipulador foi removido com sucesso."})}catch(s){m({title:"Erro",description:"Não foi possível remover o discipulador.",variant:"destructive"})}finally{c(null)}},[t,a,m]);return l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(fe,{className:"h-4 w-4 text-blue-500"}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Discipuladores"})]}),l.jsxs(ps,{open:r,onOpenChange:i,children:[l.jsx(vs,{asChild:!0,children:l.jsx(_,{size:"sm",variant:"ghost",className:"h-5 w-5 p-0 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-full",disabled:o||0===u.length,title:"Adicionar discipulador",children:l.jsx("span",{className:"text-sm font-bold",children:"+"})})}),l.jsxs(gs,{className:"w-80 p-0 z-50",side:"bottom",align:"end",children:[l.jsxs("div",{className:"flex justify-between items-center p-2 border-b",children:[l.jsx("span",{className:"text-sm font-medium",children:"Adicionar Discipulador"}),l.jsx(_,{variant:"ghost",size:"sm",onClick:()=>i(!1),className:"h-6 w-6 p-0",children:"✕"})]}),l.jsxs($t,{children:[l.jsx(Vt,{placeholder:"Digite o nome do membro..."}),l.jsxs(Bt,{children:[l.jsx(_t,{children:0===u.length?"Todos os membros já são discipuladores":"Nenhum membro encontrado."}),l.jsx(Ut,{children:u.map(e=>l.jsxs(Kt,{value:e.name,onSelect:()=>h(e.id),disabled:o,children:[l.jsx(L,{className:"mr-2 h-4 w-4 opacity-0"}),l.jsx("span",{className:"flex-1",children:e.name}),"approved"!==e.status&&l.jsx($,{variant:"outline",className:"ml-2 text-xs",children:e.status})]},e.id))})]})]})]})]})]}),0===t.length?l.jsx("div",{className:"text-sm text-gray-500 italic",children:"Nenhum discipulador atribuído"}):l.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(e=>l.jsxs($,{variant:"secondary",className:"flex items-center gap-1 px-2 py-1 text-xs bg-blue-100 text-blue-700 border border-blue-200 hover:bg-blue-150",children:[l.jsx("span",{className:"truncate max-w-24",title:e.missionaryName,children:e.missionaryName}),l.jsx(_,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0 ml-1 hover:bg-blue-200 hover:text-blue-800",onClick:()=>x(e.id),disabled:d===e.id,title:"Remover discipulador",children:d===e.id?l.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current"}):l.jsx(Q,{className:"h-3 w-3"})})]},e.id))})]})});js.displayName="DiscipuladoresManager";const bs=({user:e,onClick:t,onApprove:s,onReject:a,onEdit:r,onDelete:i,onView:o,onScheduleVisit:n,onWhatsApp:d,onMarkVisited:c,onDisciple:m,onDiscipleRequest:u,showActions:h=!0})=>{var x,p,v,g;const[f,j]=I.useState(!1),[b,N]=I.useState(!1),[y,w]=I.useState(!1),[C,k]=I.useState([]),[D,S]=I.useState([]),[E,A]=I.useState(!1),[P,z]=I.useState(!1),{toast:M}=K(),{user:F}=J(),[O,q]=I.useState(!1),[V,B]=I.useState(null),[Q,se]=I.useState(!1),[ae,re]=I.useState(e);I.useEffect(()=>{re(e),se(!1)},[e]),I.useEffect(()=>{(null==e?void 0:e.id)&&"admin"===(null==F?void 0:F.role)&&(async()=>{try{const t=await fetch(`/api/emotional-checkins/user/${e.id}`);if(t.ok){const e=await t.json();e&&e.length>0&&B(e[0])}}catch(t){}})()},[null==e?void 0:e.id,null==F?void 0:F.role]);const ie=()=>{if(null==ae?void 0:ae.profilePhoto)return String(ae.profilePhoto).startsWith("http")?ae.profilePhoto:`/uploads/${ae.profilePhoto}`};I.useEffect(()=>{"interested"===ae.role&&ae.id&&!Q&&(se(!0),Promise.all([oe(),le()]).catch(e=>{}))},[ae.role,ae.id,Q]);const oe=I.useCallback(async()=>{try{const[e,t]=await Promise.all([fetch("/api/users?role=member"),fetch("/api/missionary-profiles/users")]);if(e.ok&&t.ok){const s=await e.json(),a=await t.json(),r=[...s,...a].filter((e,t,s)=>t===s.findIndex(t=>t.id===e.id));k(r)}}catch(e){}},[]),le=I.useCallback(async()=>{try{const e=await fetch(`/api/relationships?interestedId=${ae.id}`);if(e.ok){const t=await e.json();S(t)}}catch(e){}},[ae.id]),ne=I.useCallback(e=>{S(e)},[]),de=e=>{if(!e)return"Não definido";switch(e){case"A":return"Pronto para o Batismo";case"B":return"Detalhes Pessoais (Decidido ao Batismo)";case"C":return"Estudando a Bíblia";case"D":return"Quer Estudar a Bíblia";case"E":return"Contato Inicial";default:return"Não definido"}},ce=async e=>{const t="none"===e?null:e;if(t!==ae.interestedSituation){A(!0);try{if(!(await fetch(`/api/users/${ae.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({interestedSituation:t})})).ok)throw new Error("Erro ao atualizar situação");re(e=>({...e,interestedSituation:t})),window.dispatchEvent(new CustomEvent("user-updated",{detail:{userId:ae.id,type:"situation-changed",situation:t}})),M({title:"✅ Situação atualizada",description:`Situação de ${ae.name} alterada para "${t?de(t):"Não definida"}"`})}catch(s){M({title:"❌ Erro ao atualizar situação",description:"Não foi possível atualizar a situação. Tente novamente.",variant:"destructive"})}finally{A(!1)}}},me=e=>{switch(e){case 1:return{emoji:"🍃",label:"Distante",color:"bg-red-100 text-red-800"};case 2:return{emoji:"🔍",label:"Buscando",color:"bg-orange-100 text-orange-800"};case 3:return{emoji:"🌱",label:"Enraizando",color:"bg-yellow-100 text-yellow-800"};case 4:return{emoji:"🍃",label:"Frutificando",color:"bg-blue-100 text-blue-800"};case 5:return{emoji:"✨",label:"Intimidade",color:"bg-green-100 text-green-800"};default:return null}},ue="pending"===ae.status?{level:"high",label:"Pendente",color:"border-yellow-500 bg-yellow-50"}:(ae.points||0)<300?{level:"high",label:"Abaixo do Monte Sinai",color:"border-orange-500 bg-orange-50"}:(ae.attendance||0)<50?{level:"medium",label:"Baixa Frequência",color:"border-blue-500 bg-blue-50"}:ae.isApproved?{level:"low",label:"Normal",color:"border-green-500 bg-green-50"}:{level:"medium",label:"Não Aprovado",color:"border-purple-500 bg-purple-50"},he=()=>{if(y)return!0;try{if(ae.extraData){let e;return e="string"==typeof ae.extraData?JSON.parse(ae.extraData):ae.extraData,!0===e.visited}return!1}catch{return!1}},xe=()=>{try{if(ae.extraData){let e;return e="string"==typeof ae.extraData?JSON.parse(ae.extraData):ae.extraData,e.visitCount||0}return 0}catch{return 0}},pe=()=>{try{if(ae.extraData){let e;return e="string"==typeof ae.extraData?JSON.parse(ae.extraData):ae.extraData,e.lastVisitDate}return null}catch{return null}},ve=e=>{if(!e)return"";return new Date(e).toLocaleDateString("pt-BR")},ge=e=>{if(!e)return!1;const t=e.replace(/\D/g,"");return t.length>=10&&t.length<=11};return l.jsxs(G,{className:`transition-all duration-200 border-l-4 ${ue.color} ${he()?"border-green-200 bg-green-50/30":""}`,"data-testid":`card-user-${ae.id}`,children:[l.jsx(W,{className:"p-4",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[l.jsxs("div",{className:"relative "+("admin"===(null==F?void 0:F.role)&&ie()?"cursor-zoom-in":""),onClick:e=>{"admin"===(null==F?void 0:F.role)&&ie()&&(e.stopPropagation(),q(!0))},title:"admin"===(null==F?void 0:F.role)&&ie()?"Ver foto":void 0,role:"admin"===(null==F?void 0:F.role)&&ie()?"button":void 0,children:[l.jsxs(ye,{className:"h-12 w-12",children:[l.jsx(we,{src:ie(),className:"h-full w-full object-cover"}),l.jsx(Ce,{className:"bg-primary text-primary-foreground",children:(null==(x=ae.name)?void 0:x.charAt(0))||"U"})]}),(()=>{try{if(ae.extraData){let e;return e="string"==typeof ae.extraData?JSON.parse(ae.extraData):ae.extraData,!0===e.phoneWarning}return!1}catch{return!1}})()&&l.jsx("div",{className:"absolute -top-1 -right-1 bg-yellow-500 rounded-full p-1",title:"Telefone inválido durante importação",children:l.jsx(Oe,{className:"h-3 w-3 text-white"})})]}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("h3",{className:"font-medium text-foreground truncate","data-testid":`text-username-${ae.id}`,children:ae.name}),l.jsx($,{className:(e=>{switch(e){case"admin":return"bg-red-500 text-white";case"missionary":return"bg-blue-500 text-white";case"member":return"bg-green-500 text-white";case"interested":return"bg-yellow-500 text-white";default:return"bg-gray-500 text-white"}})(ae.role),"data-testid":`badge-role-${ae.id}`,children:(e=>{switch(e){case"admin":return"Administrador";case"missionary":return"Missionário";case"member":return"Membro";case"interested":return"Interessado";default:return"Desconhecido"}})(ae.role)}),"pending"===ae.status&&l.jsx($,{variant:"secondary",className:`${(e=>{switch(e){case"approved":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"rejected":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}})(ae.status)} cursor-pointer hover:opacity-80 transition-opacity`,"data-testid":`badge-status-${ae.id}`,onClick:e=>{e.stopPropagation(),null==s||s()},title:"Clique para aprovar",children:(e=>{switch(e){case"approved":return"Aprovado";case"pending":return"Pendente";case"rejected":return"Rejeitado";default:return"Desconhecido"}})(ae.status)}),"interested"===ae.role&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs(ps,{open:P,children:[l.jsx(vs,{asChild:!0,children:l.jsxs(_,{variant:"ghost",role:"combobox",className:"h-6 w-auto min-w-[140px] text-xs border-0 bg-transparent p-0 hover:bg-transparent",disabled:E,onClick:e=>{e.stopPropagation(),z(!P)},children:[ae.interestedSituation?de(ae.interestedSituation):"Selecionar situação",l.jsx(Je,{className:"ml-2 h-3 w-3 shrink-0 opacity-50"})]})}),l.jsxs(gs,{className:"w-64 p-0 z-50",side:"bottom",align:"start",children:[l.jsxs("div",{className:"flex justify-between items-center p-2 border-b",children:[l.jsx("span",{className:"text-sm font-medium",children:"Selecionar Situação"}),l.jsx(_,{variant:"ghost",size:"sm",onClick:()=>z(!1),className:"h-6 w-6 p-0",children:"✕"})]}),l.jsxs($t,{children:[l.jsx(Vt,{placeholder:"Digite para buscar situação..."}),l.jsxs(Bt,{children:[l.jsx(_t,{children:"Nenhuma situação encontrada."}),l.jsxs(Ut,{children:[l.jsxs(Kt,{value:"none",onSelect:()=>{ce("none"),z(!1)},children:[l.jsx(L,{className:R("mr-2 h-4 w-4",ae.interestedSituation?"opacity-0":"opacity-100")}),"Selecionar situação"]}),l.jsxs(Kt,{value:"A",onSelect:()=>{ce("A"),z(!1)},children:[l.jsx(L,{className:R("mr-2 h-4 w-4","A"===ae.interestedSituation?"opacity-100":"opacity-0")}),"A - Pronto para o Batismo"]}),l.jsxs(Kt,{value:"B",onSelect:()=>{ce("B"),z(!1)},children:[l.jsx(L,{className:R("mr-2 h-4 w-4","B"===ae.interestedSituation?"opacity-100":"opacity-0")}),"B - Detalhes Pessoais (Decidido ao Batismo)"]}),l.jsxs(Kt,{value:"C",onSelect:()=>{ce("C"),z(!1)},children:[l.jsx(L,{className:R("mr-2 h-4 w-4","C"===ae.interestedSituation?"opacity-100":"opacity-0")}),"C - Estudando a Bíblia"]}),l.jsxs(Kt,{value:"D",onSelect:()=>{ce("D"),z(!1)},children:[l.jsx(L,{className:R("mr-2 h-4 w-4","D"===ae.interestedSituation?"opacity-100":"opacity-0")}),"D - Quer Estudar a Bíblia"]}),l.jsxs(Kt,{value:"E",onSelect:()=>{ce("E"),z(!1)},children:[l.jsx(L,{className:R("mr-2 h-4 w-4","E"===ae.interestedSituation?"opacity-100":"opacity-0")}),"E - Contato Inicial"]})]})]})]})]})]}),l.jsx($,{className:`${(e=>{if(!e)return"bg-gray-100 text-gray-800";switch(e){case"A":return"bg-green-100 text-green-800";case"B":return"bg-blue-100 text-blue-800";case"C":return"bg-purple-100 text-purple-800";case"D":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}})(ae.interestedSituation)} text-xs px-2 py-0`,title:de(ae.interestedSituation),children:ae.interestedSituation||"Não definida"})]}),"admin"===(null==F?void 0:F.role)&&ae.hasPendingDiscipleRequest&&l.jsxs($,{className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-200 cursor-pointer",onClick:e=>{e.stopPropagation(),null==u||u()},title:"Clique para autorizar discipulado",children:[l.jsx(Re,{className:"h-3 w-3 mr-1"}),"Autorizar"]})]}),l.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(Y,{className:"h-3 w-3"}),l.jsx("span",{className:"truncate","data-testid":`text-first-access-${ae.id}`,children:l.jsx("strong",{children:(e=>{if(!e)return"";const t=e.trim().split(" ");if(1===t.length)return t[0].toLowerCase();return`${t[0].toLowerCase()}.${t[t.length-1].toLowerCase()}`})(ae.name)})})]}),"interested"===ae.role&&l.jsx("div",{className:"mt-2",children:l.jsx(js,{interestedId:ae.id,currentDiscipuladores:D,potentialMissionaries:C,onDiscipuladoresChange:ne})}),ae.phone&&l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(H,{className:"h-3 w-3"}),l.jsx("span",{"data-testid":`text-phone-${ae.id}`,children:ae.phone})]}),ae.church&&l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(Te,{className:"h-3 w-3"}),l.jsx("span",{className:"truncate","data-testid":`text-church-${ae.id}`,children:ae.church})]}),ae.address&&l.jsxs("div",{className:"flex items-start gap-1",children:[l.jsx(Te,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),l.jsx("div",{className:"flex-1 min-w-0",children:l.jsx("div",{className:"text-sm text-muted-foreground break-words","data-testid":`text-address-${ae.id}`,children:ae.address})})]}),void 0!==ae.points&&l.jsxs("div",{className:"flex items-center gap-2 mt-2 pt-2 border-t border-gray-100",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(Z,{className:"h-3 w-3 text-yellow-500"}),l.jsxs("span",{className:"text-xs font-medium",children:[ae.points||0," pts"]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ke,{iconType:De(ae.points||0),className:"h-3 w-3"}),l.jsx("span",{className:"text-xs font-medium",title:Ee(ae.points||0),children:Se(ae.points||0)})]})]}),"admin"===(null==F?void 0:F.role)&&V&&l.jsxs("div",{className:"flex items-center gap-2 mt-2 pt-2 border-t border-gray-100",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(X,{className:"h-3 w-3 text-pink-500"}),l.jsx("span",{className:"text-xs font-medium",children:"Estado Espiritual:"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-lg",children:null==(p=me(V.emotionalScore))?void 0:p.emoji}),l.jsx($,{className:`${null==(v=me(V.emotionalScore))?void 0:v.color} text-xs px-2 py-0`,children:null==(g=me(V.emotionalScore))?void 0:g.label})]}),V.prayerRequest&&l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ee,{className:"h-3 w-3 text-blue-500"}),l.jsx("span",{className:"text-xs text-blue-600",children:"Pedido de oração"})]})]})]}),he()&&l.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs",children:[l.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[l.jsx(U,{className:"h-3 w-3"}),l.jsx("span",{children:"Visitado"})]}),xe()>1&&l.jsxs($,{variant:"secondary",className:"text-xs px-1 py-0 bg-green-100 text-green-700",children:[xe()," visitas"]}),pe()&&l.jsxs("span",{className:"text-muted-foreground",children:["Última: ",ve(pe())]})]})]})]}),h&&l.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-1",onClick:e=>e.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[l.jsx(_,{size:"sm",variant:"ghost",disabled:b,className:`h-8 w-8 p-0 transition-all duration-200 ${he()?"text-green-600 hover:text-green-700 bg-green-50 hover:bg-green-100 border border-green-200":"text-blue-600 hover:text-blue-700"} ${b?"opacity-50 cursor-not-allowed":""}`,onClick:e=>{e.stopPropagation(),(()=>{if(he()||y)j(!0);else{const t=new Date,s=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;w(!0);const a=xe(),r={..."string"==typeof ae.extraData?JSON.parse(ae.extraData):ae.extraData||{},visited:!0,lastVisitDate:s,visitCount:a+1};re(e=>({...e,extraData:r})),M({title:"✅ Visita realizada registrada!",description:`Primeira visita para ${ae.name} foi marcada como realizada. Visitômetro atualizado.`});try{null==c||c(ae.id,!0,s)}catch(e){w(!1),re(e=>({...e,extraData:{..."string"==typeof ae.extraData?JSON.parse(ae.extraData):ae.extraData||{},visited:!1,visitCount:a}})),M({title:"❌ Erro ao marcar visita",description:"Não foi possível marcar a visita. Tente novamente.",variant:"destructive"})}}})()},title:he()?"Marcar nova visita realizada":"Marcar visita como realizada",children:b?l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):he()?l.jsx(Ye,{className:"h-4 w-4"}):l.jsx(Ze,{className:"h-4 w-4"})}),xe()>1&&l.jsxs($,{variant:"secondary",className:"text-xs px-1 py-0 bg-green-100 text-green-700 border border-green-200",children:[xe(),"x"]}),l.jsx(_,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-green-600 hover:text-green-700",onClick:e=>{e.stopPropagation(),null==o||o()},title:"Visualizar detalhes",children:l.jsx(te,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[l.jsx(_,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-purple-600 hover:text-purple-700",onClick:e=>{e.stopPropagation(),null==n||n()},title:"Agendar visita futura",children:l.jsx(T,{className:"h-4 w-4"})}),ge(ae.phone)&&l.jsx(_,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-green-600 hover:text-green-700",onClick:e=>{e.stopPropagation(),(()=>{if(ge(ae.phone)){const e=ae.phone.replace(/\D/g,""),t=`Olá ${ae.name}! Como você está?`,s=`https://wa.me/55${e}?text=${encodeURIComponent(t)}`;window.open(s,"_blank")}})()},title:"Enviar WhatsApp",children:l.jsx(ee,{className:"h-4 w-4"})}),l.jsx(_,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",onClick:e=>{e.stopPropagation(),null==i||i()},title:"Excluir usuário",children:l.jsx(qe,{className:"h-4 w-4"})})]})]})]})}),l.jsx(fs,{isOpen:f,onClose:()=>j(!1),onConfirm:async e=>{N(!0);try{await(null==c?void 0:c(ae.id,!0,e)),j(!1),w(!0);const t=xe(),s={..."string"==typeof ae.extraData?JSON.parse(ae.extraData):ae.extraData||{},visited:!0,lastVisitDate:e,visitCount:t+1};re(e=>({...e,extraData:s}));const a=0===t?"primeira visita":"nova visita";M({title:"✅ Visita realizada registrada!",description:`${a.charAt(0).toUpperCase()+a.slice(1)} para ${ae.name} foi marcada como realizada em ${ve(e)}. Visitômetro atualizado.`})}catch(t){w(!1),M({title:"❌ Erro ao marcar visita",description:"Não foi possível marcar a visita. Tente novamente.",variant:"destructive"})}finally{N(!1)}},userName:ae.name,isLoading:b,visitCount:xe(),lastVisitDate:pe()}),l.jsx(Ae,{open:O,onOpenChange:q,children:l.jsxs(Pe,{className:"sm:max-w-xl",children:[l.jsxs(ze,{children:[l.jsxs(Ie,{children:["Foto de ",ae.name]}),l.jsx(Me,{children:"Visualização ampliada da foto de perfil."})]}),ie()?l.jsx("img",{src:ie(),alt:`Foto de ${ae.name}`,className:"w-full h-auto max-h-[80vh] object-contain rounded-md"}):l.jsx("div",{className:"text-sm text-muted-foreground",children:"Este usuário ainda não possui foto de perfil."})]})})]})},Ns=({user:e,isOpen:t,onClose:s,onUpdate:a})=>{var r;const[i,o]=I.useState({}),[n,d]=I.useState({}),[c,m]=I.useState(!1);if(!e)return null;const u=(e,t)=>{o(t=>({...t,[e]:!0})),d(s=>({...s,[e]:t}))},h=(t,s,r,h="text",x)=>{const p=i[t],v=p?n[t]:r;return p?l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-medium",children:s}),l.jsxs("div",{className:"flex gap-2",children:["textarea"===h?l.jsx($e,{value:v||"",onChange:e=>d(s=>({...s,[t]:e.target.value})),className:"flex-1",rows:3}):"select"===h?l.jsxs(re,{value:v||"",onValueChange:e=>d(s=>({...s,[t]:e})),children:[l.jsx(ie,{className:"flex-1",children:l.jsx(oe,{placeholder:"Selecione..."})}),l.jsx(le,{children:null==x?void 0:x.map(e=>l.jsx(ne,{value:e,children:e},e))})]}):l.jsx(B,{value:v||"",onChange:e=>d(s=>({...s,[t]:e.target.value})),className:"flex-1"}),l.jsx(_,{size:"sm",variant:"ghost",onClick:()=>(async t=>{const s=n[t];m(!0);try{await a(e.id,{[t]:s}),o(e=>({...e,[t]:!1})),d(e=>{const s={...e};return delete s[t],s})}catch(r){}finally{m(!1)}})(t),disabled:c,className:"h-8 w-8 p-0 text-green-600 hover:text-green-700",children:l.jsx(L,{className:"h-4 w-4"})}),l.jsx(_,{size:"sm",variant:"ghost",onClick:()=>(e=>{o(t=>({...t,[e]:!1})),d(t=>{const s={...t};return delete s[e],s})})(t),disabled:c,className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:l.jsx(Q,{className:"h-4 w-4"})})]})]}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("label",{className:"text-sm font-medium",children:s}),l.jsx(_,{size:"sm",variant:"ghost",onClick:()=>u(t,r),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700",children:l.jsx(He,{className:"h-3 w-3"})})]}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:r||"Não informado"})]})},x=e=>{if(!e)return null;try{const t=e.toString().trim().replace(/['"]/g,"");if(!isNaN(e)&&"number"==typeof e){const t=new Date(1900,0,1),s=e-2,a=new Date(t.getTime()+24*s*60*60*1e3);if(!isNaN(a.getTime())&&a.getFullYear()>1900)return a}if(t.includes("/")){const e=t.split("/");if(3===e.length){const[t,s,a]=e,r=parseInt(t),i=parseInt(s);let o=parseInt(a);if(o<100&&(o+=o<50?2e3:1900),r>=1&&r<=31&&i>=1&&i<=12&&o>=1900&&o<=2100){const e=new Date(o,i-1,r);if(e.getDate()===r&&e.getMonth()===i-1&&e.getFullYear()===o)return e}}}if(t.includes("-")&&t.match(/^\d{1,2}-\d{1,2}-\d{4}$/)){const e=t.split("-"),[s,a,r]=e,i=parseInt(s),o=parseInt(a),l=parseInt(r);if(i>=1&&i<=31&&o>=1&&o<=12&&l>=1900&&l<=2100){const e=new Date(l,o-1,i);if(e.getDate()===i&&e.getMonth()===o-1&&e.getFullYear()===l)return e}}if(t.match(/^\d{4}-\d{2}-\d{2}$/)){const e=new Date(t);if(!isNaN(e.getTime())&&e.getFullYear()>1900)return e}if(t.match(/^\d{4}\/\d{2}\/\d{2}$/)){const e=t.split("/"),[s,a,r]=e,i=parseInt(s),o=parseInt(a),l=parseInt(r);if(i>=1900&&i<=2100&&o>=1&&o<=12&&l>=1&&l<=31){const e=new Date(i,o-1,l);if(e.getDate()===l&&e.getMonth()===o-1&&e.getFullYear()===i)return e}}if(t.includes(".")&&t.match(/^\d{1,2}\.\d{1,2}\.\d{4}$/)){const e=t.split("."),[s,a,r]=e,i=parseInt(s),o=parseInt(a),l=parseInt(r);if(i>=1&&i<=31&&o>=1&&o<=12&&l>=1900&&l<=2100){const e=new Date(l,o-1,i);if(e.getDate()===i&&e.getMonth()===o-1&&e.getFullYear()===l)return e}}if(t.includes(".")&&t.match(/^\d{1,2}\.\d{1,2}\.\d{2}$/)){const e=t.split("."),[s,a,r]=e,i=parseInt(s),o=parseInt(a);let l=parseInt(r);if(l+=l<50?2e3:1900,i>=1&&i<=31&&o>=1&&o<=12&&l>=1900&&l<=2100){const e=new Date(l,o-1,i);if(e.getDate()===i&&e.getMonth()===o-1&&e.getFullYear()===l)return e}}if(t.includes("-")&&t.includes("/")){const e=t.match(/^(\d{1,2}\/\d{1,2})-\d{1,2}\/\d{1,2}\/(\d{4})$/);if(e){const t=e[1]+"/"+e[2];return x(t)}}if(t.includes("-")&&t.includes("/")&&!t.match(/\d{4}/)){const e=t.match(/^(\d{1,2}\/\d{1,2})-\d{1,2}\/\d{1,2}$/);if(e){const t=(new Date).getFullYear(),s=e[1]+"/"+t;return x(s)}}if(t.match(/^\d{1,2}\/\d{1,2}$/)){const e=(new Date).getFullYear();return x(t+"/"+e)}const s=new Date(e);return!isNaN(s.getTime())&&s.getFullYear()>1900?s:null}catch(t){return null}},p=e=>{if(!e)return"Não informado";const t=x(e);return t?Math.floor(((new Date).getTime()-t.getTime())/315576e5)+" anos":"Não informado"},v=e=>{if(!e)return"Não informado";const t=x(e);return t?t.toLocaleDateString("pt-BR"):"Não informado"},g=(()=>{try{return e.extraData&&"string"==typeof e.extraData?JSON.parse(e.extraData):e.extraData&&"object"==typeof e.extraData?e.extraData:{}}catch{return{}}})(),f=e=>{switch(e){case"admin":return"Administrador";case"missionary":return"Missionário";case"member":return"Membro";case"interested":return"Interessado";default:return"Desconhecido"}},j=()=>e.departments?"string"==typeof e.departments?e.departments.split(",").map(e=>e.trim()).filter(e=>e):Array.isArray(e.departments)?e.departments:[]:[],b=()=>{try{if(e.extraData&&"string"==typeof e.extraData){const t=JSON.parse(e.extraData);return t.phoneWarning?{hasWarning:!0,originalPhone:t.originalPhone}:{hasWarning:!1}}return{hasWarning:!1}}catch{return{hasWarning:!1}}};return l.jsx(Ae,{open:t,onOpenChange:e=>!e&&s(),children:l.jsxs(Pe,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[l.jsxs(ze,{children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs(Ie,{className:"flex items-center gap-3",children:[l.jsxs(ye,{className:"h-12 w-12",children:[l.jsx(we,{src:e.profilePhoto}),l.jsx(Ce,{className:"bg-primary text-primary-foreground",children:(null==(r=e.name)?void 0:r.charAt(0))||"U"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xl font-bold",children:e.name}),l.jsx("div",{className:"text-sm text-muted-foreground",children:e.email})]}),l.jsx($,{variant:"outline",className:"ml-2",children:f(e.role)})]})}),l.jsx(Me,{children:"Informações detalhadas do membro"})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs(G,{className:"shadow-divine",children:[l.jsx(se,{children:l.jsxs(ae,{className:"flex items-center gap-2",children:[l.jsx(Y,{className:"h-5 w-5"}),"Informações Básicas"]})}),l.jsx(W,{children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsx("div",{children:h("church","Igreja",e.church)}),l.jsx("div",{children:h("name","Nome",e.name)}),l.jsx("div",{children:h("churchCode","Código",e.churchCode)}),l.jsxs("div",{children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsx("label",{className:"text-sm font-medium",children:"Tipo"})}),l.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:l.jsx($,{variant:"secondary",children:f(e.role)})})]}),l.jsx("div",{children:h("extraData.sexo","Sexo",g.sexo)}),l.jsxs("div",{children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsx("label",{className:"text-sm font-medium",children:"Idade"})}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.idade||(e=>{if(!e)return"Não informado";const t=x(e);return t?Math.floor(((new Date).getTime()-t.getTime())/315576e5)+" anos":"Não informado"})(e.birthDate)})]}),l.jsx("div",{children:h("birthDate","Nascimento",e.birthDate)}),l.jsx("div",{children:h("extraData.engajamento","Engajamento",g.engajamento)}),l.jsx("div",{children:h("extraData.classificacao","Classificação",g.classificacao)})]})})]}),l.jsxs(G,{className:"shadow-divine",children:[l.jsx(se,{children:l.jsxs(ae,{className:"flex items-center gap-2",children:[l.jsx(Ve,{className:"h-5 w-5"}),"Dízimos e Ofertas"]})}),l.jsx(W,{children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Classificação"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.level||"Iniciante"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Dizimista"}),l.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:l.jsx($,{variant:e.isDonor?"default":"secondary",children:g.dizimistaType||(e.isDonor?"Sim":"Não")})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Dízimos - 12m"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.dizimos12m||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Último dízimo - 12m"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:v(g.ultimoDizimo)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Valor dízimo - 12m"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.valorDizimo||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Número de meses s/ dizimar"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.numeroMesesSemDizimar||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Dizimista antes do últ. dízimo"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.dizimistaAntesUltimoDizimo||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Ofertante"}),l.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:l.jsx($,{variant:e.isOffering?"default":"secondary",children:g.ofertanteType||(e.isOffering?"Sim":"Não")})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Ofertas - 12m"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.ofertas12m||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Última oferta - 12m"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:v(g.ultimaOferta)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Valor oferta - 12m"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.valorOferta||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Número de meses s/ ofertar"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.numeroMesesSemOfertar||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Ofertante antes da últ. oferta"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.ofertanteAntesUltimaOferta||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Último movimento"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.ultimoMovimento||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Data do último movimento"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:v(g.dataUltimoMovimento)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Tipo de entrada"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.tipoEntrada||"Não informado"})]})]})})]}),l.jsxs(G,{className:"shadow-divine",children:[l.jsx(se,{children:l.jsxs(ae,{className:"flex items-center gap-2",children:[l.jsx(X,{className:"h-5 w-5"}),"Batismo e Vida Espiritual"]})}),l.jsx(W,{children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Tempo de batismo"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:p(e.baptismDate)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Batismo"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:v(e.baptismDate)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Tempo de batismo"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.tempoBatismo||p(e.baptismDate)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Localidade do batismo"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.localidadeBatismo||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Batizado por"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.batizadoPor||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Idade no Batismo"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.idadeBatismo||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Tempo de batismo - anos"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.tempoBatismoAnos||p(e.baptismDate)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Religião anterior"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.previousReligion||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Como conheceu a IASD"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.comoConheceu||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Fator decisivo"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.fatorDecisivo||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Como estudou a Bíblia"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.comoEstudou||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Instrutor bíblico"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.biblicalInstructor||g.instrutorBiblico||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Instrutor bíblico 2"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.instrutorBiblico2||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Tem cargo"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.temCargo||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Teen"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.teen||"Não informado"})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"text-sm font-medium",children:"Departamentos e cargos"}),l.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:j().length>0?j().map((e,t)=>l.jsx($,{variant:"secondary","data-testid":`badge-department-${t}`,children:e},t)):l.jsx("span",{className:"text-sm text-muted-foreground",children:"Nenhum departamento"})})]})]})})]}),l.jsxs(G,{className:"shadow-divine",children:[l.jsx(se,{children:l.jsxs(ae,{className:"flex items-center gap-2",children:[l.jsx(q,{className:"h-5 w-5"}),"Informações Familiares"]})}),l.jsx(W,{children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Nome da mãe"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.nomeMae||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Nome do pai"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.nomePai||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Estado civil"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:(e=>{switch(e){case"single":return"Solteiro(a)";case"married":return"Casado(a)";case"divorced":return"Divorciado(a)";case"widowed":return"Viúvo(a)";default:return"Não informado"}})(e.civilStatus)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Data de casamento"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:v(g.dataCasamento)})]})]})})]}),l.jsxs(G,{className:"shadow-divine",children:[l.jsx(se,{children:l.jsxs(ae,{className:"flex items-center gap-2",children:[l.jsx(We,{className:"h-5 w-5"}),"Educação e Profissão"]})}),l.jsx(W,{children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Grau de educação"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.education||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Ocupação"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.occupation||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Aluno educação Adv."}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.alunoEducacao||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Parentesco p/ c/ aluno"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.parentesco||"Não informado"})]})]})})]}),l.jsxs(G,{className:"shadow-divine",children:[l.jsx(se,{children:l.jsxs(ae,{className:"flex items-center gap-2",children:[l.jsx(H,{className:"h-5 w-5"}),"Contato e Endereço"]})}),l.jsx(W,{children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:["Celular",b().hasWarning&&l.jsx(Oe,{className:"h-4 w-4 text-yellow-500"})]}),l.jsx(_,{size:"sm",variant:"ghost",onClick:()=>u("phone",e.phone),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700",children:l.jsx(He,{className:"h-3 w-3"})})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.phone||"Não informado"}),b().hasWarning&&l.jsxs("div",{className:"flex items-center gap-2 mt-1 p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded-md",children:[l.jsx(Oe,{className:"h-4 w-4 text-yellow-600"}),l.jsxs("div",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:[l.jsx("strong",{children:"Telefone original:"})," ",b().originalPhone,l.jsx("br",{}),l.jsx("span",{className:"text-muted-foreground",children:"Telefone muito curto durante a importação"})]})]})]})]}),l.jsx("div",{children:h("email","Email",e.email)}),l.jsx("div",{children:h("extraData.cidadeEstado","Cidade e Estado",g.cidadeEstado)}),l.jsx("div",{children:h("extraData.bairro","Bairro",g.bairro)}),l.jsx("div",{className:"md:col-span-2",children:h("address","Endereço",e.address,"textarea")}),l.jsx("div",{children:h("extraData.cidadeNascimento","Cidade de nascimento",g.cidadeNascimento)}),l.jsx("div",{children:h("extraData.estadoNascimento","Estado de nascimento",g.estadoNascimento)}),l.jsx("div",{children:h("cpf","CPF",e.cpf)}),l.jsxs("div",{children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsx("label",{className:"text-sm font-medium",children:"CPF válido"})}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.cpfValido||"Não informado"})]})]})})]}),l.jsxs(G,{className:"shadow-divine",children:[l.jsx(se,{children:l.jsxs(ae,{className:"flex items-center gap-2",children:[l.jsx(Z,{className:"h-5 w-5"}),"Escola Sabatina"]})}),l.jsx(W,{children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Nome da unidade"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.nomeUnidade||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Matriculado na ES"}),l.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:l.jsx($,{variant:e.isEnrolledES?"default":"secondary",children:e.isEnrolledES?"Sim":"Não"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Tem lição"}),l.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:l.jsx($,{variant:e.hasLesson?"default":"secondary",children:e.hasLesson?"Sim":"Não"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Período ES"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.esPeriod||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Comunhão"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.comunhao||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Missão"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.missao||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Estudo bíblico"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.estudoBiblico||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Batizou alguém"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.batizouAlguem||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Disc. pós batismal"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.discPosBatismal||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Total presença no cartão"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.presencaTotal||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Presença no quiz local"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.presencaQuizLocal||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Presença no quiz outra unidade"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.presencaQuizOutraUnidade||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Presença no quiz online"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.presencaQuizOnline||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Total de presença"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.totalPresenca||e.attendance||0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Teve participação"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.teveParticipacao||"Não informado"})]})]})})]}),l.jsxs(G,{className:"shadow-divine",children:[l.jsx(se,{children:l.jsxs(ae,{className:"flex items-center gap-2",children:[l.jsx(Qe,{className:"h-5 w-5"}),"Colaboração e Outros"]})}),l.jsx(W,{children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Campo - colaborador"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.campoColaborador||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Área - colaborador"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.areaColaborador||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Estabelecimento - colaborador"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.estabelecimentoColaborador||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Função - colaborador"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.funcaoColaborador||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Campos vazios/inválidos"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.camposVazios||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Nome dos campos vazios no ACMS"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.nomeCamposVazios||"Não informado"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Pontos"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.points||0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Nível"}),l.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.level||"Iniciante"})]})]})})]}),e.observations&&l.jsxs(G,{className:"shadow-divine",children:[l.jsx(se,{children:l.jsxs(ae,{className:"flex items-center gap-2",children:[l.jsx(Oe,{className:"h-5 w-5"}),"Observações"]})}),l.jsx(W,{children:l.jsx("p",{className:"text-sm text-muted-foreground",children:e.observations})})]})]}),l.jsx("div",{className:"flex justify-end gap-2 mt-6",children:l.jsxs(_,{variant:"outline",onClick:s,"data-testid":"button-close",children:[l.jsx(Q,{className:"h-4 w-4 mr-2"}),"Fechar"]})})]})})},ys=({user:e,isOpen:t,onClose:s,onUpdate:a})=>{const{toast:r}=K(),i=de(),[o,n]=I.useState({name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||"",phone:(null==e?void 0:e.phone)||"",role:(null==e?void 0:e.role)||"interested",status:(null==e?void 0:e.status)||"pending",church:(null==e?void 0:e.church)||"",birthDate:(null==e?void 0:e.birthDate)?new Date(e.birthDate).toISOString().split("T")[0]:"",civilStatus:(null==e?void 0:e.civilStatus)||"",occupation:(null==e?void 0:e.occupation)||"",education:(null==e?void 0:e.education)||"",address:(null==e?void 0:e.address)||"",observations:(null==e?void 0:e.observations)||""}),d=je({mutationFn:({userId:e,data:t})=>fetch(`/api/users/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(e=>e.json()),onSuccess:()=>{i.invalidateQueries({queryKey:["/api/users"]}),window.dispatchEvent(new CustomEvent("user-updated")),r({title:"Usuário atualizado",description:"As informações do usuário foram atualizadas com sucesso."}),s()},onError:()=>{r({title:"Erro",description:"Erro ao atualizar usuário. Tente novamente.",variant:"destructive"})}}),c=(e,t)=>{n(s=>({...s,[e]:t}))};return e?l.jsx(Ae,{open:t,onOpenChange:e=>!e&&s(),children:l.jsxs(Pe,{className:"max-w-2xl max-h-[90vh] overflow-y-auto","aria-describedby":"edit-user-modal-description",children:[l.jsx("div",{id:"edit-user-modal-description",className:"sr-only",children:"Formulário para editar informações do usuário"}),l.jsx(ze,{children:l.jsxs(Ie,{children:["Editar Usuário - ",e.name]})}),l.jsxs("form",{onSubmit:t=>{t.preventDefault(),(null==e?void 0:e.id)&&d.mutate({userId:e.id,data:o})},className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"name",children:"Nome Completo *"}),l.jsx(B,{id:"name",value:o.name,onChange:e=>c("name",e.target.value),required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"email",children:"Email *"}),l.jsx(B,{id:"email",type:"email",value:o.email,onChange:e=>c("email",e.target.value),required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"phone",children:"Telefone"}),l.jsx(B,{id:"phone",value:o.phone,onChange:e=>c("phone",e.target.value),placeholder:"(11) 99999-9999"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"birthDate",children:"Data de Nascimento"}),l.jsx(B,{id:"birthDate",type:"date",value:o.birthDate,onChange:e=>c("birthDate",e.target.value)})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"role",children:"Função"}),l.jsxs(re,{value:o.role,onValueChange:e=>c("role",e),children:[l.jsx(ie,{children:l.jsx(oe,{})}),l.jsxs(le,{children:[l.jsx(ne,{value:"admin",children:"Administrador"}),l.jsx(ne,{value:"missionary",children:"Missionário"}),l.jsx(ne,{value:"member",children:"Membro"}),l.jsx(ne,{value:"interested",children:"Interessado"})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"status",children:"Status"}),l.jsxs(re,{value:o.status,onValueChange:e=>c("status",e),children:[l.jsx(ie,{children:l.jsx(oe,{})}),l.jsxs(le,{children:[l.jsx(ne,{value:"approved",children:"Aprovado"}),l.jsx(ne,{value:"pending",children:"Pendente"}),l.jsx(ne,{value:"rejected",children:"Rejeitado"})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"church",children:"Igreja"}),l.jsx(B,{id:"church",value:o.church,onChange:e=>c("church",e.target.value)})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"civilStatus",children:"Estado Civil"}),l.jsxs(re,{value:o.civilStatus,onValueChange:e=>c("civilStatus",e),children:[l.jsx(ie,{children:l.jsx(oe,{})}),l.jsxs(le,{children:[l.jsx(ne,{value:"single",children:"Solteiro(a)"}),l.jsx(ne,{value:"married",children:"Casado(a)"}),l.jsx(ne,{value:"divorced",children:"Divorciado(a)"}),l.jsx(ne,{value:"widowed",children:"Viúvo(a)"})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"occupation",children:"Profissão"}),l.jsx(B,{id:"occupation",value:o.occupation,onChange:e=>c("occupation",e.target.value)})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"education",children:"Escolaridade"}),l.jsx(B,{id:"education",value:o.education,onChange:e=>c("education",e.target.value)})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"address",children:"Endereço"}),l.jsx($e,{id:"address",value:o.address,onChange:e=>c("address",e.target.value),placeholder:"Rua, número, bairro, cidade, estado",rows:3})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"observations",children:"Observações"}),l.jsx($e,{id:"observations",value:o.observations,onChange:e=>c("observations",e.target.value),placeholder:"Observações sobre o usuário...",rows:3})]}),l.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[l.jsx(_,{type:"button",variant:"outline",onClick:s,children:"Cancelar"}),l.jsx(_,{type:"submit",disabled:d.isPending,children:d.isPending?"Salvando...":"Salvar Alterações"})]})]})]})}):null},ws=({user:e,isOpen:t,onClose:s})=>{const{toast:a}=K(),r=de(),[i,o]=I.useState({title:`Visita - ${(null==e?void 0:e.name)||"Usuário"}`,description:"",scheduledAt:"",scheduledTime:"",notes:""}),n=je({mutationFn:t=>fetch("/api/meetings",{method:"POST",body:JSON.stringify({...t,requesterId:null==e?void 0:e.id,typeId:9,title:`Visita - ${null==e?void 0:e.name}`,scheduledAt:t.scheduledAt+"T"+t.scheduledTime,duration:60,priority:"medium",location:(null==e?void 0:e.address)||""}),headers:{"Content-Type":"application/json"}}).then(e=>e.json()),onSuccess:()=>{r.invalidateQueries({queryKey:["/api/meetings"]}),a({title:"Visita agendada",description:"A visita foi agendada com sucesso na agenda."}),s()},onError:()=>{a({title:"Erro",description:"Erro ao agendar visita. Tente novamente.",variant:"destructive"})}}),d=(e,t)=>{o(s=>({...s,[e]:t}))};return e?l.jsx(Ae,{open:t,onOpenChange:e=>!e&&s(),children:l.jsxs(Pe,{className:"max-w-sm","aria-describedby":"schedule-visit-modal-description",children:[l.jsx("div",{id:"schedule-visit-modal-description",className:"sr-only",children:"Formulário para agendar visita ao membro"}),l.jsx(ze,{children:l.jsxs(Ie,{className:"flex items-center gap-2 text-lg",children:[l.jsx(T,{className:"h-5 w-5"}),"Agendar Visita"]})}),l.jsxs("form",{onSubmit:e=>{e.preventDefault(),i.scheduledAt&&i.scheduledTime?n.mutate(i):a({title:"Data e hora obrigatórias",description:"Por favor, selecione uma data e hora para a visita.",variant:"destructive"})},className:"space-y-4",children:[l.jsxs("div",{className:"bg-muted/30 p-3 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-sm mb-2",children:"Visitando:"}),l.jsxs("div",{className:"text-sm space-y-1",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Nome:"})," ",e.name]}),e.phone&&l.jsxs("p",{children:[l.jsx("strong",{children:"Telefone:"})," ",e.phone]}),e.address&&l.jsxs("p",{children:[l.jsx("strong",{children:"Endereço:"})," ",e.address]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"scheduledAt",className:"text-sm",children:"Data"}),l.jsx(B,{id:"scheduledAt",type:"date",value:i.scheduledAt,onChange:e=>d("scheduledAt",e.target.value),required:!0,className:"h-9"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"scheduledTime",className:"text-sm",children:"Hora"}),l.jsx(B,{id:"scheduledTime",type:"time",value:i.scheduledTime,onChange:e=>d("scheduledTime",e.target.value),required:!0,className:"h-9"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"notes",className:"text-sm",children:"Observações"}),l.jsx($e,{id:"notes",value:i.notes,onChange:e=>d("notes",e.target.value),placeholder:"Motivo da visita, objetivos...",rows:2,className:"text-sm"})]}),l.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[l.jsx(_,{type:"button",variant:"outline",onClick:s,size:"sm",children:"Cancelar"}),l.jsx(_,{type:"submit",disabled:n.isPending,className:"bg-purple-600 hover:bg-purple-700",size:"sm",children:n.isPending?"Agendando...":"Agendar"})]})]})]})}):null};var Cs="AlertDialog",[ks,Ds]=m(Cs,[k]),Ss=k(),Es=e=>{const{__scopeAlertDialog:t,...a}=e,r=Ss(t);return l.jsx(s,{...r,...a,modal:!0})};Es.displayName=Cs;I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,...a}=e,r=Ss(s);return l.jsx(z,{...r,...a,ref:t})}).displayName="AlertDialogTrigger";var As=e=>{const{__scopeAlertDialog:t,...s}=e,r=Ss(t);return l.jsx(a,{...r,...s})};As.displayName="AlertDialogPortal";var Ps=I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,...a}=e,i=Ss(s);return l.jsx(r,{...i,...a,ref:t})});Ps.displayName="AlertDialogOverlay";var zs="AlertDialogContent",[Is,Ms]=ks(zs),Fs=S("AlertDialogContent"),Os=I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,children:a,...r}=e,o=Ss(s),n=I.useRef(null),d=u(t,n),c=I.useRef(null);return l.jsx(D,{contentName:zs,titleName:Rs,docsSlug:"alert-dialog",children:l.jsx(Is,{scope:s,cancelRef:c,children:l.jsxs(i,{role:"alertdialog",...o,...r,ref:d,onOpenAutoFocus:h(r.onOpenAutoFocus,e=>{var t;e.preventDefault(),null==(t=c.current)||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[l.jsx(Fs,{children:a}),l.jsx(Us,{contentRef:n})]})})})});Os.displayName=zs;var Rs="AlertDialogTitle",Ts=I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,...a}=e,r=Ss(s);return l.jsx(E,{...r,...a,ref:t})});Ts.displayName=Rs;var qs="AlertDialogDescription",$s=I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,...a}=e,r=Ss(s);return l.jsx(A,{...r,...a,ref:t})});$s.displayName=qs;var Vs=I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,...a}=e,r=Ss(s);return l.jsx(P,{...r,...a,ref:t})});Vs.displayName="AlertDialogAction";var Bs="AlertDialogCancel",_s=I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,...a}=e,{cancelRef:r}=Ms(Bs,s),i=Ss(s),o=u(t,r);return l.jsx(P,{...i,...a,ref:o})});_s.displayName=Bs;var Us=({contentRef:e})=>{const t=`\`${zs}\` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the \`${zs}\` by passing a \`${qs}\` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${zs}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return I.useEffect(()=>{var t;document.getElementById(null==(t=e.current)?void 0:t.getAttribute("aria-describedby"))},[t,e]),null},Ks=Ps,Ls=Os,Qs=Vs,Js=_s,Gs=Ts,Ws=$s;const Ys=Es,Hs=As,Zs=I.forwardRef(({className:e,...t},s)=>l.jsx(Ks,{className:R("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:s}));Zs.displayName=Ks.displayName;const Xs=I.forwardRef(({className:e,...t},s)=>l.jsxs(Hs,{children:[l.jsx(Zs,{}),l.jsx(Ls,{ref:s,className:R("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));Xs.displayName=Ls.displayName;const ea=({className:e,...t})=>l.jsx("div",{className:R("flex flex-col space-y-2 text-center sm:text-left",e),...t});ea.displayName="AlertDialogHeader";const ta=({className:e,...t})=>l.jsx("div",{className:R("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});ta.displayName="AlertDialogFooter";const sa=I.forwardRef(({className:e,...t},s)=>l.jsx(Gs,{ref:s,className:R("text-lg font-semibold",e),...t}));sa.displayName=Gs.displayName;const aa=I.forwardRef(({className:e,...t},s)=>l.jsx(Ws,{ref:s,className:R("text-sm text-muted-foreground",e),...t}));aa.displayName=Ws.displayName;const ra=I.forwardRef(({className:e,...t},s)=>l.jsx(Qs,{ref:s,className:R(ce(),e),...t}));ra.displayName=Qs.displayName;const ia=I.forwardRef(({className:e,...t},s)=>l.jsx(Js,{ref:s,className:R(ce({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));function oa(){var e,t,s,a,r,i,o,n,d,c,m,u;const{user:h}=J();be();const{toast:x}=K(),p=de(),[v,g]=I.useState(""),[f,j]=I.useState("all"),[b,N]=I.useState("all"),[y,w]=I.useState("name"),[C,k]=I.useState("asc"),[D,S]=I.useState("all"),[E,A]=I.useState("all"),[P,z]=I.useState(null),[M,O]=I.useState(null),[R,T]=I.useState(null),[q,V]=I.useState("all"),[L,Q]=I.useState(null),[H,ee]=I.useState(!1),[se,ae]=I.useState(!1),[ce,ge]=I.useState(!1),[fe,ye]=I.useState(!1),[we,Ce]=I.useState(null),[ke,De]=I.useState(!1),[Se,Ee]=I.useState(null),[Ae,Pe]=I.useState(""),[ze,Ie]=I.useState(!0),[Me,Te]=I.useState(!0),[qe,$e]=I.useState(!0),[Ve,Qe]=I.useState(!1),[Je,We]=I.useState(null),[Ye,He]=I.useState(""),{data:Ze,isLoading:Xe,error:et}=F({queryKey:["/api/users/with-points"],queryFn:async()=>{try{const e=await fetch("/api/users/with-points");if(!e.ok)throw new Error("Falha ao carregar usuários");const t=await e.json();return Array.isArray(t)?t:[]}catch(e){try{const e=await fetch("/api/users");if(e.ok){const t=await e.json();return Array.isArray(t)?t:[]}}catch(t){}return[]}},refetchOnWindowFocus:!0,refetchOnMount:!0,staleTime:3e5,gcTime:6e5}),tt=Array.isArray(Ze)?Ze:[],{data:st=[]}=F({queryKey:["user-relationships",null==h?void 0:h.id],queryFn:async()=>{if(!(null==h?void 0:h.id)||"missionary"!==h.role)return[];const e=await fetch(`/api/relationships?missionaryId=${h.id}`);if(!e.ok)throw new Error("Erro ao buscar relacionamentos");return e.json()},enabled:!!(null==h?void 0:h.id)&&"missionary"===h.role}),{data:at}=F({queryKey:["/api/spiritual-checkins/scores"],queryFn:async()=>{const e=await fetch("/api/spiritual-checkins/scores");if(!e.ok)throw new Error("Failed to fetch spiritual check-ins");return e.json()},staleTime:6e4}),{data:rt=[]}=F({queryKey:["churches"],queryFn:async()=>{const e=await fetch("/api/churches");if(!e.ok)throw new Error("Erro ao buscar igrejas");return e.json()}}),{data:it=[]}=F({queryKey:["discipleship-requests"],queryFn:async()=>{const e=await fetch("/api/discipleship-requests");if(!e.ok)throw new Error("Erro ao buscar solicitações de discipulado");return e.json()}}),ot=tt.map(e=>({...e,hasPendingDiscipleRequest:it.some(t=>t.interestedId===e.id&&"pending"===t.status)})),lt=e=>"pending"===e.status?1:(e.points||0)<300?2:(e.attendance||0)<50?3:e.isApproved?5:4,nt=e=>{z(e),e&&(g(""),j("all"),N("all"),A("all"),S("all"),V("all"),O(null))},dt=e=>{O(e),e&&(g(""),j("all"),N("all"),A("all"),S("all"),V("all"),z(null),T(null))},ct=e=>{T(e),e&&(g(""),j("all"),N("all"),A("all"),S("all"),V("all"),z(null),O(null))},mt=()=>{if(!P)return null;return{vale:"Vale do Jordão",sinai:"Monte Sinai",nebo:"Monte Nebo",moria:"Monte Moriá",carmelo:"Monte Carmelo",hermon:"Monte Hermon",siao:"Monte Sião",oliveiras:"Monte das Oliveiras",topo:"O Topo"}[P]},ut=e=>{if("missionary"===(null==h?void 0:h.role))return ot.filter(t=>{if("interested"!==t.role)return!1;if(!st.some(e=>e.interestedId===t.id&&"active"===e.status))return!1;const s=t.points||0;switch(e){case"vale":return s>=0&&s<300;case"sinai":return s>=300&&s<400;case"nebo":return s>=400&&s<500;case"moria":return s>=500&&s<600;case"carmelo":return s>=600&&s<700;case"hermon":return s>=700&&s<800;case"siao":return s>=800&&s<900;case"oliveiras":return s>=900&&s<1e3;case"topo":return s>=1e3;default:return!1}}).length;{const t=e=>e.points||0;switch(e){case"vale":return ot.filter(e=>t(e)>=0&&t(e)<300).length;case"sinai":return ot.filter(e=>t(e)>=300&&t(e)<400).length;case"nebo":return ot.filter(e=>t(e)>=400&&t(e)<500).length;case"moria":return ot.filter(e=>t(e)>=500&&t(e)<600).length;case"carmelo":return ot.filter(e=>t(e)>=600&&t(e)<700).length;case"hermon":return ot.filter(e=>t(e)>=700&&t(e)<800).length;case"siao":return ot.filter(e=>t(e)>=800&&t(e)<900).length;case"oliveiras":return ot.filter(e=>t(e)>=900&&t(e)<1e3).length;case"topo":return ot.filter(e=>t(e)>=1e3).length;default:return 0}}},ht=ot.filter(e=>{const t=e.name.toLowerCase().includes(v.toLowerCase())||e.email.toLowerCase().includes(v.toLowerCase()),s=!f||"all"===f||e.role===f,a=!b||"all"===b||e.status===b,r="all"===E||e.church===E;let i=!0;"missionary"===q?i="missionary"===e.role:"non-missionary"===q&&(i="missionary"!==e.role);let o=!0;if(P){const t=e.points||0;switch(P){case"vale":o=t>=0&&t<300;break;case"sinai":o=t>=300&&t<400;break;case"nebo":o=t>=400&&t<500;break;case"moria":o=t>=500&&t<600;break;case"carmelo":o=t>=600&&t<700;break;case"hermon":o=t>=700&&t<800;break;case"siao":o=t>=800&&t<900;break;case"oliveiras":o=t>=900&&t<1e3;break;case"topo":o=t>=1e3;break;default:o=!0}}let l=!0;M&&(l="no-situation"===M?"interested"===e.role&&!e.interestedSituation:"total"===M?"interested"===e.role:"interested"===e.role&&e.interestedSituation===M);let n=!0;if(R)switch(R){case"score-1":n=1===e.emotionalScore;break;case"score-2":n=2===e.emotionalScore;break;case"score-3":n=3===e.emotionalScore;break;case"score-4":n=4===e.emotionalScore;break;case"score-5":n=5===e.emotionalScore;break;case"no-checkin":n=!e.emotionalScore;break;default:n=!0}let d=!0;if("missionary"===(null==h?void 0:h.role))if("interested"===e.role){d=st.some(t=>t.interestedId===e.id&&"active"===t.status)}else d=e.id===h.id;return t&&s&&a&&r&&o&&l&&n&&i&&d}).sort((e,t)=>{let s,a;switch(y){case"name":default:s=e.name.toLowerCase(),a=t.name.toLowerCase();break;case"points":s=e.points||0,a=t.points||0;break;case"attendance":s=e.attendance||0,a=t.attendance||0;break;case"createdAt":s=new Date(e.createdAt||0),a=new Date(t.createdAt||0);break;case"priority":s=lt(e),a=lt(t)}return"asc"===C?s>a?1:-1:s<a?1:-1}),xt=je({mutationFn:e=>fetch(`/api/users/${e}/approve`,{method:"POST"}).then(e=>e.json()),onSuccess:()=>{p.invalidateQueries({queryKey:["/api/users/with-points"]}),window.dispatchEvent(new CustomEvent("user-approved")),x({title:"Usuário aprovado",description:"O usuário foi aprovado com sucesso."})}}),pt=je({mutationFn:e=>fetch(`/api/users/${e}/reject`,{method:"POST"}).then(e=>e.json()),onSuccess:()=>{p.invalidateQueries({queryKey:["/api/users/with-points"]}),window.dispatchEvent(new CustomEvent("user-rejected")),x({title:"Usuário rejeitado",description:"O usuário foi rejeitado.",variant:"destructive"})}}),vt=je({mutationFn:({userId:e,data:t})=>fetch(`/api/users/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(e=>e.json()),onSuccess:()=>{p.invalidateQueries({queryKey:["/api/users/with-points"]}),window.dispatchEvent(new CustomEvent("user-updated")),x({title:"Usuário atualizado",description:"As informações do usuário foram atualizadas com sucesso."})}}),gt=(e,t)=>{vt.mutate({userId:e,data:t}),Q(e=>e?{...e,...t}:null)},ft=je({mutationFn:async e=>{const t=await fetch(`/api/users/${e}`,{method:"DELETE"});if(!t.ok)throw new Error("Failed to delete user");return t.json()},onSuccess:()=>{p.invalidateQueries({queryKey:["/api/users/with-points"]}),x({title:"✅ Usuário excluído",description:"Usuário excluído com sucesso!"}),ye(!1),Ce(null)},onError:e=>{x({title:"❌ Erro ao excluir usuário",description:e.message||"Não foi possível excluir o usuário.",variant:"destructive"})}}),jt=je({mutationFn:async({userId:e,message:t})=>{const s=await fetch(`/api/users/${e}/disciple`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t})});if(!s.ok){const e=await s.json();throw new Error(e.error||"Failed to disciple user")}return s.json()},onSuccess:()=>{p.invalidateQueries({queryKey:["/api/users"]}),x({title:"✅ Solicitação enviada",description:"Solicitação de discipulado enviada com sucesso!"}),De(!1),Ee(null),Pe("")},onError:e=>{x({title:"❌ Erro ao solicitar discipulado",description:e.message||"Não foi possível enviar a solicitação.",variant:"destructive"})}}),bt=async e=>{if(Je)try{if(!(await fetch(`/api/discipleship-requests/${Je.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e,adminNotes:Ye.trim(),processedBy:(null==h?void 0:h.id)||1})})).ok)throw new Error("Erro ao processar solicitação");p.invalidateQueries({queryKey:["discipleship-requests"]}),p.invalidateQueries({queryKey:["relationships"]}),Qe(!1),We(null),He(""),x({title:"✅ Solicitação processada!",description:`A solicitação foi ${"approved"===e?"aprovada":"rejeitada"} com sucesso.`})}catch(t){x({title:"❌ Erro ao processar",description:t.message||"Não foi possível processar a solicitação.",variant:"destructive"})}},{markVisit:Nt}=(()=>{const e=de(),t=je({mutationFn:async({userId:e,visitDate:t})=>{const s=await fetch(`/api/users/${e}/visit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitDate:t})});if(!s.ok){const e=await s.json();throw new Error(e.error||"Erro ao marcar visita")}return s.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["/api/dashboard/stats"]}),e.invalidateQueries({queryKey:["/api/dashboard/visits"]}),e.invalidateQueries({queryKey:["/api/dashboard"]}),e.invalidateQueries({queryKey:["dashboard"]}),e.refetchQueries({queryKey:["/api/dashboard/visits"]})}});return{markVisit:t.mutate,isMarkingVisit:t.isPending,markVisitError:t.error}})(),yt=async(e,t,s)=>{s&&Nt({userId:e,visitDate:s})},wt=tt.filter(e=>"pending"===e.status).length;return Xe?l.jsx(me,{children:l.jsx("div",{className:"p-4 space-y-4",children:l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),l.jsx("p",{className:"text-muted-foreground",children:"Carregando usuários..."})]})})})}):et?l.jsx(me,{children:l.jsx("div",{className:"p-4 space-y-4",children:l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-destructive",children:"Erro ao carregar usuários"}),l.jsx(_,{onClick:()=>p.invalidateQueries({queryKey:["/api/users"]}),className:"mt-2",children:"Tentar novamente"})]})})})}):l.jsx(me,{children:l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Y,{className:"h-6 w-6 text-primary"}),l.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"missionary"===(null==h?void 0:h.role)?"Meus Interessados":"Usuários"}),wt>0&&l.jsxs($,{variant:"destructive",className:"ml-2","data-testid":"badge-pending-count",children:[wt," pendente",wt>1?"s":""]}),"missionary"===(null==h?void 0:h.role)&&l.jsxs($,{variant:"secondary",className:"ml-2",children:[st.filter(e=>"active"===e.status).length," vinculado",1!==st.filter(e=>"active"===e.status).length?"s":""]})]}),l.jsx("div",{className:"flex items-center gap-2",children:"admin"===(null==h?void 0:h.role)&&l.jsxs(l.Fragment,{children:[l.jsxs(_,{onClick:async()=>{try{x({title:"🔄 Recalculando...",description:"Calculando pontuação para todos os usuários. Isso pode levar alguns minutos."});const e=await fetch("/api/system/recalculate-all-points",{method:"POST"}),t=await e.json();if(!t.success)throw new Error(t.error||"Erro desconhecido");p.invalidateQueries({queryKey:["/api/users/with-points"]}),x({title:"✅ Pontuação Atualizada",description:`${t.updatedUsers} usuários foram atualizados com sucesso!`})}catch(e){x({title:"❌ Erro",description:"Falha ao recalcular pontuação. Tente novamente.",variant:"destructive"})}},size:"sm",variant:"outline",className:"border-green-600 text-green-600 hover:bg-green-50",children:[l.jsx(Le,{className:"h-4 w-4 mr-1"}),"Recalcular Todas as Pontuações"]}),l.jsxs(_,{onClick:async()=>{try{x({title:"🔄 Gerenciando...",description:"Gerenciando perfis missionários automaticamente."});const e=await fetch("/api/system/manage-missionary-roles",{method:"POST"}),t=await e.json();if(!t.success)throw new Error(t.error||"Erro desconhecido");p.invalidateQueries({queryKey:["missionary-profiles"]}),p.invalidateQueries({queryKey:["/api/users/with-points"]}),x({title:"✅ Perfis Gerenciados",description:`${t.created} perfis criados, ${t.deactivated} desativados. Total ativo: ${t.totalActive}`})}catch(e){x({title:"❌ Erro",description:"Falha ao gerenciar roles missionários. Tente novamente.",variant:"destructive"})}},size:"sm",variant:"outline",className:"border-purple-600 text-purple-600 hover:bg-purple-50",children:[l.jsx(_e,{className:"h-4 w-4 mr-1"}),"Gerenciar Roles Missionários"]}),l.jsxs(_,{size:"sm",className:"bg-primary hover:bg-primary-dark","data-testid":"button-new-user",children:[l.jsx(Ue,{className:"h-4 w-4 mr-1"}),"Novo"]})]})})]}),l.jsx("div",{className:"flex flex-wrap gap-4 mt-6 p-4 bg-gradient-to-r from-slate-50 to-gray-50 rounded-xl border border-slate-200/50 shadow-sm",children:"admin"===(null==h?void 0:h.role)?l.jsxs(l.Fragment,{children:[l.jsxs($,{variant:"admin"===f?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("admin"===f?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-500/25 border-0":"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 border-blue-300/50 hover:from-blue-100 hover:to-blue-200 hover:border-blue-400"),onClick:()=>j("admin"===f?"all":"admin"),"data-testid":"stat-admin",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsx(_e,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),l.jsx("span",{className:"font-semibold tracking-wide",children:"Administradores"}),l.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:tt.filter(e=>"admin"===e.role).length})]}),l.jsxs($,{variant:"member"===f?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("member"===f?"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white shadow-lg shadow-emerald-500/25 border-0":"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 border-emerald-300/50 hover:from-emerald-100 hover:to-emerald-200 hover:border-emerald-400"),onClick:()=>j("member"===f?"all":"member"),"data-testid":"stat-member",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsx(Y,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),l.jsx("span",{className:"font-semibold tracking-wide",children:"Membros"}),l.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:tt.filter(e=>"member"===e.role).length})]}),l.jsxs($,{variant:"missionary"===f?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("missionary"===f?"bg-gradient-to-r from-violet-600 to-violet-700 text-white shadow-lg shadow-violet-500/25 border-0":"bg-gradient-to-r from-violet-50 to-violet-100 text-violet-700 border-violet-300/50 hover:from-violet-100 hover:to-violet-200 hover:border-violet-400"),onClick:()=>j("missionary"===f?"all":"missionary"),"data-testid":"stat-missionary",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsx(X,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),l.jsx("span",{className:"font-semibold tracking-wide",children:"Missionários"}),l.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:tt.filter(e=>"missionary"===e.role).length})]}),l.jsxs($,{variant:"interested"===f?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("interested"===f?"bg-gradient-to-r from-amber-600 to-amber-700 text-white shadow-lg shadow-amber-500/25 border-0":"bg-gradient-to-r from-amber-50 to-amber-100 text-amber-700 border-amber-300/50 hover:from-amber-100 hover:to-amber-200 hover:border-amber-400"),onClick:()=>j("interested"===f?"all":"interested"),"data-testid":"stat-interested",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsx(Z,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),l.jsx("span",{className:"font-semibold tracking-wide",children:"Interessados"}),l.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:tt.filter(e=>"interested"===e.role).length})]})]}):"missionary"===(null==h?void 0:h.role)?l.jsxs(l.Fragment,{children:[l.jsxs($,{variant:"outline",className:"group relative bg-gradient-to-r from-violet-50 to-violet-100 text-violet-700 border-violet-300/50 cursor-default shadow-sm hover:shadow-md transition-all duration-300","data-testid":"stat-my-interested",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-400/10 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsx(X,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),l.jsx("span",{className:"font-semibold tracking-wide",children:"Meus Interessados"}),l.jsx("span",{className:"ml-2 px-2 py-0.5 bg-violet-200/50 rounded-full text-sm font-bold",children:st.filter(e=>"active"===e.status).length})]}),l.jsxs($,{variant:"outline",className:"group relative bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 border-emerald-300/50 cursor-default shadow-sm hover:shadow-md transition-all duration-300","data-testid":"stat-studying",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/10 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsx(U,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),l.jsx("span",{className:"font-semibold tracking-wide",children:"Estudando"}),l.jsx("span",{className:"ml-2 px-2 py-0.5 bg-emerald-200/50 rounded-full text-sm font-bold",children:ht.filter(e=>"C"===e.interestedSituation).length})]}),l.jsxs($,{variant:"outline",className:"group relative bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 border-blue-300/50 cursor-default shadow-sm hover:shadow-md transition-all duration-300","data-testid":"stat-ready-baptism",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/10 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsx(Z,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),l.jsx("span",{className:"font-semibold tracking-wide",children:"Pronto Batismo"}),l.jsx("span",{className:"ml-2 px-2 py-0.5 bg-blue-200/50 rounded-full text-sm font-bold",children:ht.filter(e=>"A"===e.interestedSituation).length})]}),l.jsxs($,{variant:"outline",className:"group relative bg-gradient-to-r from-amber-50 to-amber-100 text-amber-700 border-amber-300/50 cursor-default shadow-sm hover:shadow-md transition-all duration-300","data-testid":"stat-new-contacts",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-400/10 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsx(Oe,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),l.jsx("span",{className:"font-semibold tracking-wide",children:"Novos Contatos"}),l.jsx("span",{className:"ml-2 px-2 py-0.5 bg-amber-200/50 rounded-full text-sm font-bold",children:ht.filter(e=>"E"===e.interestedSituation).length})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs($,{variant:"admin"===f?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("admin"===f?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-500/25 border-0":"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 border-blue-300/50 hover:from-blue-100 hover:to-blue-200 hover:border-blue-400"),onClick:()=>j("admin"===f?"all":"admin"),"data-testid":"stat-admin",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsx(_e,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),l.jsx("span",{className:"font-semibold tracking-wide",children:"Administradores"}),l.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:tt.filter(e=>"admin"===e.role).length})]}),l.jsxs($,{variant:"member"===f?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("member"===f?"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white shadow-lg shadow-emerald-500/25 border-0":"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 border-emerald-300/50 hover:from-emerald-100 hover:to-emerald-200 hover:border-emerald-400"),onClick:()=>j("member"===f?"all":"member"),"data-testid":"stat-member",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsx(Y,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),l.jsx("span",{className:"font-semibold tracking-wide",children:"Membros"}),l.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:tt.filter(e=>"member"===e.role).length})]}),l.jsxs($,{variant:"missionary"===f?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("missionary"===f?"bg-gradient-to-r from-violet-600 to-violet-700 text-white shadow-lg shadow-violet-500/25 border-0":"bg-gradient-to-r from-violet-50 to-violet-100 text-violet-700 border-violet-300/50 hover:from-violet-100 hover:to-violet-200 hover:border-violet-400"),onClick:()=>j("missionary"===f?"all":"missionary"),"data-testid":"stat-missionary",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsx(X,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),l.jsx("span",{className:"font-semibold tracking-wide",children:"Missionários"}),l.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:tt.filter(e=>"missionary"===e.role).length})]}),l.jsxs($,{variant:"interested"===f?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("interested"===f?"bg-gradient-to-r from-amber-600 to-amber-700 text-white shadow-lg shadow-amber-500/25 border-0":"bg-gradient-to-r from-amber-50 to-amber-100 text-amber-700 border-amber-300/50 hover:from-amber-100 hover:to-amber-200 hover:border-amber-400"),onClick:()=>j("interested"===f?"all":"interested"),"data-testid":"stat-interested",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsx(Z,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),l.jsx("span",{className:"font-semibold tracking-wide",children:"Interessados"}),l.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:tt.filter(e=>"interested"===e.role).length})]})]})}),l.jsxs("div",{className:"space-y-4 mt-6 p-4 bg-gradient-to-r from-slate-50 to-gray-50 rounded-xl border border-slate-200/50 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[l.jsx(Z,{className:"h-5 w-5 text-yellow-500 drop-shadow-sm"}),"missionary"===(null==h?void 0:h.role)?"Meus Interessados por Montes e Estatísticas":"Usuários por Montes e Estatísticas"]}),l.jsx(_,{variant:"outline",size:"sm",onClick:()=>Ie(!ze),className:"h-7 px-3 text-xs flex items-center gap-1 bg-white/50 hover:bg-white/80 border-slate-300/50 hover:border-slate-400 transition-all duration-200",title:ze?"Esconder filtros e estatísticas":"Mostrar filtros e estatísticas",children:ze?l.jsxs(l.Fragment,{children:[l.jsx(ue,{className:"h-3 w-3"}),"Esconder"]}):l.jsxs(l.Fragment,{children:[l.jsx(te,{className:"h-3 w-3"}),"Mostrar"]})}),P&&l.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[l.jsxs($,{variant:"secondary",className:"text-xs bg-blue-100 text-blue-700 border-blue-300",children:["Filtrado: ",mt()]}),l.jsx(_,{variant:"outline",size:"sm",onClick:()=>nt(null),className:"h-7 px-3 text-xs bg-white/50 hover:bg-white/80 border-slate-300/50 hover:border-slate-400 transition-all duration-200",children:"Limpar Filtro"})]})]}),ze&&l.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-9 gap-3",children:[l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("vale"===P?"bg-gradient-to-r from-gray-600 to-gray-700 text-white shadow-lg shadow-gray-500/25 border-0":"bg-gradient-to-r from-gray-50 to-gray-100 text-gray-700 border-gray-300/50 hover:from-gray-100 hover:to-gray-200 hover:border-gray-400"),onClick:()=>nt("vale"===P?null:"vale"),title:"Clique para filtrar usuários deste monte",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1",children:ut("vale")}),l.jsx("div",{className:"text-sm font-semibold mb-1",children:"Vale"}),l.jsx("div",{className:"text-xs opacity-80",children:"0-299 pts"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("sinai"===P?"bg-gradient-to-r from-orange-600 to-orange-700 text-white shadow-lg shadow-orange-500/25 border-0":"bg-gradient-to-r from-orange-50 to-orange-100 text-orange-700 border-orange-300/50 hover:from-orange-100 hover:to-orange-200 hover:border-orange-400"),onClick:()=>nt("sinai"===P?null:"sinai"),children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1",children:ut("sinai")}),l.jsx("div",{className:"text-sm font-semibold mb-1",children:"Sinai"}),l.jsx("div",{className:"text-xs opacity-80",children:"300-399 pts"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("nebo"===P?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-500/25 border-0":"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 border-blue-300/50 hover:from-blue-100 hover:to-blue-200 hover:border-blue-400"),onClick:()=>nt("nebo"===P?null:"nebo"),children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1",children:ut("nebo")}),l.jsx("div",{className:"text-sm font-semibold mb-1",children:"Nebo"}),l.jsx("div",{className:"text-xs opacity-80",children:"400-499 pts"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("moria"===P?"bg-gradient-to-r from-purple-600 to-purple-700 text-white shadow-lg shadow-purple-500/25 border-0":"bg-gradient-to-r from-purple-50 to-purple-100 text-purple-700 border-purple-300/50 hover:from-purple-100 hover:to-purple-200 hover:border-purple-400"),onClick:()=>nt("moria"===P?null:"moria"),children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1",children:ut("moria")}),l.jsx("div",{className:"text-sm font-semibold mb-1",children:"Moriá"}),l.jsx("div",{className:"text-xs opacity-80",children:"500-599 pts"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("carmelo"===P?"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white shadow-lg shadow-emerald-500/25 border-0":"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 border-emerald-300/50 hover:from-emerald-100 hover:to-emerald-200 hover:border-emerald-400"),onClick:()=>nt("carmelo"===P?null:"carmelo"),children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1",children:ut("carmelo")}),l.jsx("div",{className:"text-sm font-semibold mb-1",children:"Carmelo"}),l.jsx("div",{className:"text-xs opacity-80",children:"600-699 pts"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("hermon"===P?"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white shadow-lg shadow-indigo-500/25 border-0":"bg-gradient-to-r from-indigo-50 to-indigo-100 text-indigo-700 border-indigo-300/50 hover:from-indigo-100 hover:to-indigo-200 hover:border-indigo-400"),onClick:()=>nt("hermon"===P?null:"hermon"),children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1",children:ut("hermon")}),l.jsx("div",{className:"text-sm font-semibold mb-1",children:"Hermon"}),l.jsx("div",{className:"text-xs opacity-80",children:"700-799 pts"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("siao"===P?"bg-gradient-to-r from-red-600 to-red-700 text-white shadow-lg shadow-red-500/25 border-0":"bg-gradient-to-r from-red-50 to-red-100 text-red-700 border-red-300/50 hover:from-red-100 hover:to-red-200 hover:border-red-400"),onClick:()=>nt("siao"===P?null:"siao"),children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1",children:ut("siao")}),l.jsx("div",{className:"text-sm font-semibold mb-1",children:"Sião"}),l.jsx("div",{className:"text-xs opacity-80",children:"800-899 pts"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("oliveiras"===P?"bg-gradient-to-r from-yellow-600 to-yellow-700 text-white shadow-lg shadow-yellow-500/25 border-0":"bg-gradient-to-r from-yellow-50 to-yellow-100 text-yellow-700 border-yellow-300/50 hover:from-yellow-100 hover:to-yellow-200 hover:border-yellow-400"),onClick:()=>nt("oliveiras"===P?null:"oliveiras"),children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1",children:ut("oliveiras")}),l.jsx("div",{className:"text-sm font-semibold mb-1",children:"Oliveiras"}),l.jsx("div",{className:"text-xs opacity-80",children:"900-999 pts"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("topo"===P?"bg-gradient-to-r from-amber-600 to-amber-700 text-white shadow-lg shadow-amber-500/25 border-0":"bg-gradient-to-r from-amber-50 to-amber-100 text-amber-700 border-amber-300/50 hover:from-amber-100 hover:to-amber-200 hover:border-amber-400"),onClick:()=>nt("topo"===P?null:"topo"),children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1",children:ut("topo")}),l.jsx("div",{className:"text-sm font-semibold mb-1",children:"O Topo"}),l.jsx("div",{className:"text-xs opacity-80",children:"1000+ pts"})]})]})]}),ze&&l.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[l.jsxs(G,{className:"group relative bg-gradient-to-r from-blue-50 to-blue-100 border-blue-300/50 hover:shadow-md transition-all duration-300",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/10 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold text-blue-700 mb-1",children:ht.filter(e=>(e.points||0)>0).length}),l.jsx("div",{className:"text-sm font-semibold text-blue-600 mb-1",children:"Com Pontos"}),l.jsxs("div",{className:"text-xs text-blue-500",children:[ht.length>0?(ht.filter(e=>(e.points||0)>0).length/ht.length*100).toFixed(1):"0","%"]})]})]}),l.jsxs(G,{className:"group relative bg-gradient-to-r from-emerald-50 to-emerald-100 border-emerald-300/50 hover:shadow-md transition-all duration-300",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/10 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold text-emerald-700 mb-1",children:ht.filter(e=>(e.points||0)>0).length>0?Math.round(ht.reduce((e,t)=>e+(t.points||0),0)/ht.filter(e=>(e.points||0)>0).length):0}),l.jsx("div",{className:"text-sm font-semibold text-emerald-600 mb-1",children:"Média"}),l.jsx("div",{className:"text-xs text-emerald-500",children:"Por Usuário"})]})]}),l.jsxs(G,{className:"group relative bg-gradient-to-r from-indigo-50 to-indigo-100 border-indigo-300/50 hover:shadow-md transition-all duration-300",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-400/10 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold text-indigo-700 mb-1",children:ht.length>0?Math.max(...ht.map(e=>e.points||0)):0}),l.jsx("div",{className:"text-sm font-semibold text-indigo-600 mb-1",children:"Maior"}),l.jsx("div",{className:"text-xs text-indigo-500",children:"Recorde"})]})]})]})]}),l.jsxs("div",{className:"space-y-4 mt-6 p-4 bg-gradient-to-r from-slate-50 to-gray-50 rounded-xl border border-slate-200/50 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[l.jsx(X,{className:"h-5 w-5 text-red-500 drop-shadow-sm"}),"Situação dos Interessados"]}),l.jsx(_,{variant:"outline",size:"sm",onClick:()=>Te(!Me),className:"h-7 px-3 text-xs flex items-center gap-1 bg-white/50 hover:bg-white/80 border-slate-300/50 hover:border-slate-400 transition-all duration-200",title:Me?"Esconder estatísticas dos interessados":"Mostrar estatísticas dos interessados",children:Me?l.jsxs(l.Fragment,{children:[l.jsx(ue,{className:"h-3 w-3"}),"Esconder"]}):l.jsxs(l.Fragment,{children:[l.jsx(te,{className:"h-3 w-3"}),"Mostrar"]})})]}),Me&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("A"===M?"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white shadow-lg shadow-emerald-500/25 border-0":"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 border-emerald-300/50 hover:from-emerald-100 hover:to-emerald-200 hover:border-emerald-400"),onClick:()=>dt("A"===M?null:"A"),title:"Clique para filtrar interessados Pronto para Batismo",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1 "+("A"===M?"text-white":"text-emerald-700"),children:ht.filter(e=>"interested"===e.role&&"A"===e.interestedSituation).length}),l.jsx("div",{className:"text-sm font-semibold mb-1 "+("A"===M?"text-white":"text-emerald-600"),children:"Pronto para Batismo"}),l.jsx("div",{className:"text-xs "+("A"===M?"text-white/90":"text-emerald-500"),children:"Tipo A"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("B"===M?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-500/25 border-0":"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 border-blue-300/50 hover:from-blue-100 hover:to-blue-200 hover:border-blue-400"),onClick:()=>dt("B"===M?null:"B"),title:"Clique para filtrar interessados Detalhes Pessoais",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1 "+("B"===M?"text-white":"text-blue-700"),children:ht.filter(e=>"interested"===e.role&&"B"===e.interestedSituation).length}),l.jsx("div",{className:"text-sm font-semibold mb-1 "+("B"===M?"text-white":"text-blue-600"),children:"Detalhes Pessoais"}),l.jsx("div",{className:"text-xs "+("B"===M?"text-white/90":"text-blue-500"),children:"Tipo B"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("C"===M?"bg-gradient-to-r from-violet-600 to-violet-700 text-white shadow-lg shadow-violet-500/25 border-0":"bg-gradient-to-r from-violet-50 to-violet-100 text-violet-700 border-violet-300/50 hover:from-violet-100 hover:to-violet-200 hover:border-violet-400"),onClick:()=>dt("C"===M?null:"C"),title:"Clique para filtrar interessados Estudando Bíblia",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1 "+("C"===M?"text-white":"text-violet-700"),children:ht.filter(e=>"interested"===e.role&&"C"===e.interestedSituation).length}),l.jsx("div",{className:"text-sm font-semibold mb-1 "+("C"===M?"text-white":"text-violet-600"),children:"Estudando Bíblia"}),l.jsx("div",{className:"text-xs "+("C"===M?"text-white/90":"text-violet-500"),children:"Tipo C"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("D"===M?"bg-gradient-to-r from-orange-600 to-orange-700 text-white shadow-lg shadow-orange-500/25 border-0":"bg-gradient-to-r from-orange-50 to-orange-100 text-orange-700 border-orange-300/50 hover:from-orange-100 hover:to-orange-200 hover:border-orange-400"),onClick:()=>dt("D"===M?null:"D"),title:"Clique para filtrar interessados Quer Estudar",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1 "+("D"===M?"text-white":"text-orange-700"),children:ht.filter(e=>"interested"===e.role&&"D"===e.interestedSituation).length}),l.jsx("div",{className:"text-sm font-semibold mb-1 "+("D"===M?"text-white":"text-orange-600"),children:"Quer Estudar"}),l.jsx("div",{className:"text-xs "+("D"===M?"text-white/90":"text-orange-500"),children:"Tipo D"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("E"===M?"bg-gradient-to-r from-gray-600 to-gray-700 text-white shadow-lg shadow-gray-500/25 border-0":"bg-gradient-to-r from-gray-50 to-gray-100 text-gray-700 border-gray-300/50 hover:from-gray-100 hover:to-gray-200 hover:border-gray-400"),onClick:()=>dt("E"===M?null:"E"),title:"Clique para filtrar interessados Contato Inicial",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1 "+("E"===M?"text-white":"text-gray-700"),children:ht.filter(e=>"interested"===e.role&&"E"===e.interestedSituation).length}),l.jsx("div",{className:"text-sm font-semibold mb-1 "+("E"===M?"text-white":"text-gray-600"),children:"Contato Inicial"}),l.jsx("div",{className:"text-xs "+("E"===M?"text-white/90":"text-gray-500"),children:"Tipo E"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("no-situation"===M?"bg-gradient-to-r from-yellow-600 to-yellow-700 text-white shadow-lg shadow-yellow-500/25 border-0":"bg-gradient-to-r from-yellow-50 to-yellow-100 text-yellow-700 border-yellow-300/50 hover:from-yellow-100 hover:to-yellow-200 hover:border-yellow-400"),onClick:()=>dt("no-situation"===M?null:"no-situation"),title:"Clique para filtrar interessados sem situação definida",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1 "+("no-situation"===M?"text-white":"text-yellow-700"),children:ht.filter(e=>"interested"===e.role&&!e.interestedSituation).length}),l.jsx("div",{className:"text-sm font-semibold mb-1 "+("no-situation"===M?"text-white":"text-yellow-600"),children:"Sem Situação Definida"}),l.jsx("div",{className:"text-xs "+("no-situation"===M?"text-white/90":"text-yellow-500"),children:"Precisa de Acompanhamento"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("total"===M?"bg-gradient-to-r from-red-600 to-red-700 text-white shadow-lg shadow-red-500/25 border-0":"bg-gradient-to-r from-red-50 to-red-100 text-red-700 border-red-300/50 hover:from-red-100 hover:to-red-200 hover:border-red-400"),onClick:()=>dt("total"===M?null:"total"),title:"Clique para filtrar todos os interessados",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-3 text-center relative z-10",children:[l.jsx("div",{className:"text-xl font-bold mb-1 "+("total"===M?"text-white":"text-red-700"),children:ht.filter(e=>"interested"===e.role).length}),l.jsx("div",{className:"text-sm font-semibold mb-1 "+("total"===M?"text-white":"text-red-600"),children:"Total de Interessados"}),l.jsx("div",{className:"text-xs "+("total"===M?"text-white/90":"text-red-500"),children:"Todos os Tipos"})]})]})]})]})]}),l.jsxs("div",{className:"space-y-4 mt-6 p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-200/50 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[l.jsx(X,{className:"h-5 w-5 text-purple-500 drop-shadow-sm"}),"Check-in Espiritual"]}),l.jsx(_,{variant:"outline",size:"sm",onClick:()=>$e(!qe),className:"h-7 px-3 text-xs flex items-center gap-1 bg-white/50 hover:bg-white/80 border-purple-300/50 hover:border-purple-400 transition-all duration-200",title:qe?"Esconder estatísticas de check-in espiritual":"Mostrar estatísticas de check-in espiritual",children:qe?l.jsxs(l.Fragment,{children:[l.jsx(ue,{className:"h-3 w-3"}),"Esconder"]}):l.jsxs(l.Fragment,{children:[l.jsx(te,{className:"h-3 w-3"}),"Mostrar"]})})]}),qe&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("score-1"===R?"bg-gradient-to-r from-red-600 to-red-700 text-white shadow-lg shadow-red-500/25 border-0":"bg-gradient-to-r from-red-50 to-red-100 text-red-700 border-red-300/50 hover:from-red-100 hover:to-red-200 hover:border-red-400"),onClick:()=>ct("score-1"===R?null:"score-1"),title:"Clique para filtrar usuários com score 1 (Distante)",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-2 text-center relative z-10",children:[l.jsx("div",{className:"text-lg mb-0.5",children:"🍃"}),l.jsx("div",{className:"text-lg font-bold mb-0.5 "+("score-1"===R?"text-white":"text-red-700"),children:(null==(t=null==(e=null==at?void 0:at.scoreGroups)?void 0:e[1])?void 0:t.count)||0}),l.jsx("div",{className:"text-xs font-semibold mb-0.5 "+("score-1"===R?"text-white":"text-red-600"),children:"Distante"}),l.jsx("div",{className:"text-xs "+("score-1"===R?"text-white/90":"text-red-500"),children:"Apocalipse 2:4"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("score-2"===R?"bg-gradient-to-r from-orange-600 to-orange-700 text-white shadow-lg shadow-orange-500/25 border-0":"bg-gradient-to-r from-orange-50 to-orange-100 text-orange-700 border-orange-300/50 hover:from-orange-100 hover:to-orange-200 hover:border-orange-400"),onClick:()=>ct("score-2"===R?null:"score-2"),title:"Clique para filtrar usuários com score 2 (Buscando)",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-2 text-center relative z-10",children:[l.jsx("div",{className:"text-lg mb-0.5",children:"🔍"}),l.jsx("div",{className:"text-lg font-bold mb-0.5 "+("score-2"===R?"text-white":"text-orange-700"),children:(null==(a=null==(s=null==at?void 0:at.scoreGroups)?void 0:s[2])?void 0:a.count)||0}),l.jsx("div",{className:"text-xs font-semibold mb-0.5 "+("score-2"===R?"text-white":"text-orange-600"),children:"Buscando"}),l.jsx("div",{className:"text-xs "+("score-2"===R?"text-white/90":"text-orange-500"),children:"Isaías 55:6"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("score-3"===R?"bg-gradient-to-r from-yellow-600 to-yellow-700 text-white shadow-lg shadow-yellow-500/25 border-0":"bg-gradient-to-r from-yellow-50 to-yellow-100 text-yellow-700 border-yellow-300/50 hover:from-yellow-100 hover:to-yellow-200 hover:border-yellow-400"),onClick:()=>ct("score-3"===R?null:"score-3"),title:"Clique para filtrar usuários com score 3 (Enraizando)",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-2 text-center relative z-10",children:[l.jsx("div",{className:"text-lg mb-0.5",children:"🌱"}),l.jsx("div",{className:"text-lg font-bold mb-0.5 "+("score-3"===R?"text-white":"text-yellow-700"),children:(null==(i=null==(r=null==at?void 0:at.scoreGroups)?void 0:r[3])?void 0:i.count)||0}),l.jsx("div",{className:"text-xs font-semibold mb-0.5 "+("score-3"===R?"text-white":"text-yellow-600"),children:"Enraizando"}),l.jsx("div",{className:"text-xs "+("score-3"===R?"text-white/90":"text-yellow-500"),children:"Salmo 1:2"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("score-4"===R?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-500/25 border-0":"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 border-blue-300/50 hover:from-blue-100 hover:to-blue-200 hover:border-blue-400"),onClick:()=>ct("score-4"===R?null:"score-4"),title:"Clique para filtrar usuários com score 4 (Frutificando)",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-2 text-center relative z-10",children:[l.jsx("div",{className:"text-lg mb-0.5",children:"🌳"}),l.jsx("div",{className:"text-xl font-bold mb-0.5 "+("score-4"===R?"text-white":"text-blue-700"),children:(null==(n=null==(o=null==at?void 0:at.scoreGroups)?void 0:o[4])?void 0:n.count)||0}),l.jsx("div",{className:"text-xs font-semibold mb-0.5 "+("score-4"===R?"text-white":"text-blue-600"),children:"Frutificando"}),l.jsx("div",{className:"text-xs "+("score-4"===R?"text-white/90":"text-blue-500"),children:"João 15:5"})]})]}),l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("score-5"===R?"bg-gradient-to-r from-green-600 to-green-700 text-white shadow-lg shadow-green-500/25 border-0":"bg-gradient-to-r from-green-50 to-green-100 text-green-700 border-green-300/50 hover:from-green-100 hover:to-green-200 hover:border-green-400"),onClick:()=>ct("score-5"===R?null:"score-5"),title:"Clique para filtrar usuários com score 5 (Intimidade)",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-2 text-center relative z-10",children:[l.jsx("div",{className:"text-lg mb-0.5",children:"✨"}),l.jsx("div",{className:"text-lg font-bold mb-0.5 "+("score-5"===R?"text-white":"text-green-700"),children:(null==(c=null==(d=null==at?void 0:at.scoreGroups)?void 0:d[5])?void 0:c.count)||0}),l.jsx("div",{className:"text-xs font-semibold mb-0.5 "+("score-5"===R?"text-white":"text-green-700"),children:"Intimidade"}),l.jsx("div",{className:"text-xs "+("score-5"===R?"text-white/90":"text-green-500"),children:"Gênesis 5:24"})]})]})]}),l.jsx("div",{className:"grid grid-cols-1 gap-3 mt-3",children:l.jsxs(G,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("no-checkin"===R?"bg-gradient-to-r from-gray-600 to-gray-700 text-white shadow-lg shadow-gray-500/25 border-0":"bg-gradient-to-r from-gray-50 to-gray-100 text-gray-700 border-gray-300/50 hover:from-gray-100 hover:to-gray-200 hover:border-gray-400"),onClick:()=>ct("no-checkin"===R?null:"no-checkin"),title:"Clique para filtrar usuários sem check-in espiritual",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs(W,{className:"p-2 text-center relative z-10",children:[l.jsx("div",{className:"text-lg font-bold mb-0.5 "+("no-checkin"===R?"text-white":"text-gray-700"),children:(null==at?void 0:at.usersWithoutCheckIn)||0}),l.jsx("div",{className:"text-xs font-semibold mb-0.5 "+("no-checkin"===R?"text-white":"text-gray-600"),children:"Sem Check-in"}),l.jsx("div",{className:"text-xs "+("no-checkin"===R?"text-white/90":"text-gray-500"),children:"Precisa de Acompanhamento"})]})]})})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),l.jsx(B,{placeholder:"Buscar por nome ou email...",value:v,onChange:e=>g(e.target.value),className:"pl-10","data-testid":"input-search"})]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("div",{className:"flex-1 min-w-[120px]",children:l.jsxs(re,{value:f,onValueChange:j,children:[l.jsx(ie,{"data-testid":"select-role-filter",children:l.jsx(oe,{placeholder:"Papel"})}),l.jsxs(le,{children:[l.jsx(ne,{value:"all",children:"Todos os papéis"}),l.jsx(ne,{value:"admin",children:"Administrador"}),l.jsx(ne,{value:"missionary",children:"Missionário"}),l.jsx(ne,{value:"member",children:"Membro"}),l.jsx(ne,{value:"interested",children:"Interessado"})]})]})}),l.jsx("div",{className:"flex-1 min-w-[120px]",children:l.jsxs(re,{value:b,onValueChange:N,children:[l.jsx(ie,{"data-testid":"select-status-filter",children:l.jsx(oe,{placeholder:"Status"})}),l.jsxs(le,{children:[l.jsx(ne,{value:"all",children:"Todos os status"}),l.jsx(ne,{value:"approved",children:"Aprovado"}),l.jsx(ne,{value:"pending",children:"Pendente"}),l.jsx(ne,{value:"rejected",children:"Rejeitado"})]})]})}),l.jsx("div",{className:"flex-1 min-w-[120px]",children:l.jsxs(re,{value:E,onValueChange:A,children:[l.jsx(ie,{"data-testid":"select-church-filter",children:l.jsx(oe,{placeholder:"Igreja"})}),l.jsxs(le,{children:[l.jsx(ne,{value:"all",children:"Todas as igrejas"}),rt.map(e=>l.jsx(ne,{value:e.name,children:e.name},e.id))]})]})}),l.jsx("div",{className:"flex-1 min-w-[120px]",children:l.jsxs(re,{value:q,onValueChange:V,children:[l.jsx(ie,{"data-testid":"select-missionary-profile-filter",children:l.jsx(oe,{placeholder:"Filtrar por role"})}),l.jsxs(le,{children:[l.jsx(ne,{value:"all",children:"Todos os roles"}),l.jsx(ne,{value:"missionary",children:"Missionários"}),l.jsx(ne,{value:"non-missionary",children:"Não missionários"})]})]})}),l.jsxs(he,{children:[l.jsx(xe,{asChild:!0,children:l.jsxs(_,{variant:"outline",size:"sm",className:"min-w-[140px]",children:["asc"===C?l.jsx(Ne,{className:"h-4 w-4 mr-1"}):l.jsx(Ke,{className:"h-4 w-4 mr-1"}),"name"===y&&"Nome","points"===y&&"Pontos","attendance"===y&&"Frequência","createdAt"===y&&"Data Cadastro","priority"===y&&"Prioridade"]})}),l.jsxs(pe,{align:"end",children:[l.jsxs(ve,{onClick:()=>{w("name"),k("asc")},children:[l.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Nome A-Z"]}),l.jsxs(ve,{onClick:()=>{w("name"),k("desc")},children:[l.jsx(Ke,{className:"h-4 w-4 mr-2"}),"Nome Z-A"]}),l.jsxs(ve,{onClick:()=>{w("points"),k("desc")},children:[l.jsx(Z,{className:"h-4 w-4 mr-2"}),"Maior Pontuação"]}),l.jsxs(ve,{onClick:()=>{w("points"),k("asc")},children:[l.jsx(Z,{className:"h-4 w-4 mr-2"}),"Menor Pontuação"]}),l.jsxs(ve,{onClick:()=>{w("attendance"),k("desc")},children:[l.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Maior Frequência"]}),l.jsxs(ve,{onClick:()=>{w("attendance"),k("asc")},children:[l.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Menor Frequência"]}),l.jsxs(ve,{onClick:()=>{w("createdAt"),k("desc")},children:[l.jsx(Re,{className:"h-4 w-4 mr-2"}),"Mais Recentes"]}),l.jsxs(ve,{onClick:()=>{w("createdAt"),k("asc")},children:[l.jsx(Re,{className:"h-4 w-4 mr-2"}),"Mais Antigos"]}),l.jsxs(ve,{onClick:()=>{w("priority"),k("asc")},children:[l.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Prioridade (Alta → Baixa)"]})]})]})]})]}),l.jsxs("div",{className:"space-y-3",children:["missionary"===(null==h?void 0:h.role)&&l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg border border-purple-200",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(X,{className:"h-4 w-4 text-purple-600"}),l.jsx("span",{className:"text-sm font-medium text-purple-800",children:"Visualizando apenas seus interessados vinculados"}),l.jsxs($,{variant:"secondary",className:"text-xs",children:[st.filter(e=>"active"===e.status).length," interessado",1!==st.filter(e=>"active"===e.status).length?"s":""]})]}),l.jsx("div",{className:"text-xs text-purple-600",children:"Para ver todos os interessados, solicite acesso ao administrador"})]}),P&&l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-blue-200",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Be,{className:"h-4 w-4 text-blue-600"}),l.jsxs("span",{className:"text-sm font-medium text-blue-800",children:["Mostrando usuários do ",mt()]}),l.jsxs($,{variant:"secondary",className:"text-xs",children:[ht.length," usuário",1!==ht.length?"s":""]})]}),l.jsx(_,{variant:"outline",size:"sm",onClick:()=>nt(null),className:"h-7 px-3 text-xs",children:"Ver Todos"})]}),ht.map(e=>l.jsx(bs,{user:e,onClick:()=>(Q(e),void ee(!0)),onApprove:()=>{return t=e.id,void xt.mutate(t);var t},onReject:()=>{return t=e.id,void pt.mutate(t);var t},onEdit:()=>(Q(e),void ae(!0)),onDelete:()=>(Ce(e),void ye(!0)),onView:()=>(Q(e),void ee(!0)),onScheduleVisit:()=>(Q(e),void ge(!0)),onMarkVisited:yt,onDisciple:()=>(Ee(e),void De(!0)),onDiscipleRequest:()=>(e=>{const t=it.find(t=>t.interestedId===e.id&&"pending"===t.status);t&&(We(t),He(t.adminNotes||""),Qe(!0))})(e),showActions:"admin"===(null==h?void 0:h.role)},e.id))]}),0===ht.length&&l.jsxs("div",{className:"text-center py-8","data-testid":"empty-state",children:[l.jsx(Y,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Nenhum usuário encontrado"}),l.jsx("p",{className:"text-muted-foreground",children:"Tente ajustar os filtros de busca."})]}),l.jsx(Ns,{user:L,isOpen:H,onClose:()=>ee(!1),onUpdate:gt}),l.jsx(ys,{user:L,isOpen:se,onClose:()=>ae(!1),onUpdate:gt}),l.jsx(ws,{user:L,isOpen:ce,onClose:()=>ge(!1)}),l.jsx(Ys,{open:fe,onOpenChange:ye,children:l.jsxs(Xs,{children:[l.jsxs(ea,{children:[l.jsx(sa,{children:"Confirmar exclusão"}),l.jsxs(aa,{children:['Tem certeza que deseja excluir o usuário "',null==we?void 0:we.name,'"? Esta ação não pode ser desfeita.']})]}),l.jsxs(ta,{children:[l.jsx(ia,{children:"Cancelar"}),l.jsx(ra,{onClick:()=>{we&&ft.mutate(we.id)},className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})}),l.jsx(Ys,{open:ke,onOpenChange:De,children:l.jsxs(Xs,{children:[l.jsxs(ea,{children:[l.jsx(sa,{children:"Solicitar Discipulado"}),l.jsxs(aa,{children:['Digite uma mensagem para solicitar o discipulado de "',null==Se?void 0:Se.name,'". Esta solicitação será enviada para aprovação do administrador.']})]}),l.jsx("div",{className:"grid gap-4 py-4",children:l.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[l.jsx("label",{htmlFor:"disciple-message",className:"text-right text-sm font-medium",children:"Mensagem:"}),l.jsx("textarea",{id:"disciple-message",value:Ae,onChange:e=>Pe(e.target.value),className:"col-span-3 min-h-[100px] p-3 border border-gray-300 rounded-md resize-none focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Digite sua mensagem de solicitação..."})]})}),l.jsxs(ta,{children:[l.jsx(ia,{children:"Cancelar"}),l.jsx(ra,{onClick:()=>{Se&&Ae.trim()&&jt.mutate({userId:Se.id,message:Ae.trim()})},disabled:!Ae.trim()||jt.isPending,className:"bg-blue-600 hover:bg-blue-700",children:jt.isPending?"Enviando...":"Enviar Solicitação"})]})]})}),Ve&&Je&&l.jsx(Ys,{open:Ve,onOpenChange:Qe,children:l.jsxs(Xs,{children:[l.jsxs(ea,{children:[l.jsx(sa,{children:"Autorizar Discipulado"}),l.jsx(aa,{children:"Aprove ou rejeite a solicitação de discipulado"})]}),l.jsx("div",{className:"grid gap-4 py-4",children:l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"Missionário:"}),l.jsx("div",{className:"font-medium",children:(null==(m=ot.find(e=>e.id===Je.missionaryId))?void 0:m.name)||`Usuário ${Je.missionaryId}`})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"Interessado:"}),l.jsx("div",{className:"font-medium",children:(null==(u=ot.find(e=>e.id===Je.interestedId))?void 0:u.name)||`Usuário ${Je.interestedId}`})]})]}),Je.notes&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"Observações do Missionário:"}),l.jsx("div",{className:"text-sm bg-muted/50 p-2 rounded mt-1",children:Je.notes})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium",children:"Notas do Administrador:"}),l.jsx("textarea",{value:Ye,onChange:e=>He(e.target.value),className:"w-full mt-1 p-2 border rounded-md",rows:3,placeholder:"Adicione observações sobre sua decisão..."})]})]})}),l.jsxs(ta,{children:[l.jsx(ia,{onClick:()=>Qe(!1),children:"Cancelar"}),"approved"===Je.status&&l.jsx(ra,{onClick:()=>(async e=>{try{const t=it.filter(t=>t.interestedId===e&&"approved"===t.status);for(const e of t)(await fetch(`/api/discipleship-requests/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"rejected",adminNotes:"Discipulado desvinculado pelo administrador - solicitação rejeitada automaticamente",processedBy:(null==h?void 0:h.id)||1})})).ok;if(!(await fetch(`/api/relationships/active/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Erro ao remover discipulado");const s=["discipleship-requests","all-discipleship-requests","relationships","all-relationships","users","my-interested","user-relationships"];s.forEach(e=>{p.invalidateQueries({queryKey:[e]})}),["discipleship-requests","all-discipleship-requests","relationships","all-relationships"].forEach(e=>{p.refetchQueries({queryKey:[e]})}),await new Promise(e=>setTimeout(e,500)),s.forEach(e=>{p.invalidateQueries({queryKey:[e]})}),x({title:"✅ Discipulado removido!",description:`O relacionamento foi removido e ${t.length} solicitações foram rejeitadas automaticamente.`})}catch(t){x({title:"❌ Erro ao remover",description:t.message||"Não foi possível remover o discipulado.",variant:"destructive"})}})(Je.interestedId),className:"bg-orange-600 hover:bg-orange-700",children:"Remover Discipulado"}),l.jsx(ra,{onClick:()=>bt("rejected"),className:"bg-red-600 hover:bg-red-700",children:"Rejeitar"}),l.jsx(ra,{onClick:()=>bt("approved"),className:"bg-green-600 hover:bg-green-700",children:"Aprovar"})]})]})})]})})}ia.displayName=Js.displayName;export{oa as default};
