import{j as e}from"./ui-CM4P41nz.js";import{r as s}from"./vendor-v6ZOr5pf.js";import{f as a,g as i,l as r,F as n,a1 as t,a2 as c,C as o,a as l,b as d,am as m,m as h,c as x,L as u,r as p,s as j,t as f,v as g,w as v,O as N,U as b,I as C,B as y,e as S}from"./index-BcdCo1jD.js";import{C as w}from"./checkbox-QiQlwI7b.js";import{S as D}from"./separator-b1SeGSwz.js";import{C as A,T as M}from"./target-BY1GXfuQ.js";import{U as T}from"./user-check-zUWgVa60.js";import{V as k}from"./vote-BULnpMTZ.js";import{S as P}from"./save-CZpwt1b5.js";import{P as E}from"./play-DubF1_mE.js";import"./charts-56rtB2he.js";function I(){const{user:I}=a(),{toast:F}=i(),[L,R]=s.useState([]),[O,$]=s.useState([]),[z,U]=s.useState(1),[q,J]=s.useState(!1),[V,B]=s.useState({churchId:0,churchName:"",voters:[],criteria:{faithfulness:{enabled:!0,punctual:!0,seasonal:!0,recurring:!0},attendance:{enabled:!0,punctual:!0,seasonal:!0,recurring:!0},churchTime:{enabled:!0,minimumMonths:12},positionLimit:{enabled:!0,maxPositions:2}},positions:["Primeiro Ancião(ã)","Ancião/Anciã Teen","Ancião/Anciã Jovem","Secretário(a)","Secretário(a) Associado(a)","Secretário(a) Teen","Tesoureiro(a)","Tesoureiro(a) Associado(a)","Tesoureiro(a) Teen","Patrimônio","Diáconos","Diácono(s) Teen","Primeiro Diácono","Diaconisas","Diaconisa(s) Teen","Primeira Diaconisa","Diretor(a)","Diretor(a) Associado(a)","Discípulo Teen","Ministério da Criança – Coordenador(a)","Ministério da Criança – Coordenador(a) Associado(a)","Ministério dos Adolescentes – Coordenador(a)","Ministério dos Adolescentes – Coordenador(a) Associado(a)","Ministério Jovem – Diretor(a)","Ministério Jovem – Diretor(a) Associado(a)","Clube de Aventureiros – Diretor(a)","Clube de Aventureiros – Diretor(a) Associado(a)","Clube de Aventureiros – Discípulo Teen","Clube de Desbravadores – Diretor(a)","Clube de Desbravadores – Diretor(a) Associado(a)","Clube de Desbravadores – Discípulo Teen","Professores(as) das Unidades: Bebês","Professores(as) das Unidades: Iniciantes","Professores(as) das Unidades: Infantis","Professores(as) das Unidades: Primários","Professores(as) das Unidades: Pré-adolescentes","Professores(as) das Unidades: Adolescentes","Secretário(a) Escola Sabatina","Diretor(a) Associado(a) Escola Sabatina","Discípulo Teen Escola Sabatina","Diretor(a) Ministério Pessoal","Diretor(a) Associado(a) Ministério Pessoal","Discípulo Teen Ministério Pessoal","Evangelismo – Diretor(a)","Evangelismo – Diretor(a) Associado(a)","Evangelismo – Secretário(a)","Evangelismo – Discípulo Teen","Coordenador(a) de Classes Bíblicas","Coordenador(a) de Interessados","Diretor(a) ASA","Diretor(a) Associado(a) ASA","Discípulo Teen ASA","Casal Diretor","Casal Associado","Discípulo Teen Ministério da Família","Diretora Ministério da Mulher","Diretora Associada Ministério da Mulher","Discípulo Teen Ministério da Mulher","Líder Ministério da Recepção","Equipe Ministério da Recepção","Diretor Ministério do Homem","Diretor Associado Ministério do Homem","Discípulo Teen Ministério do Homem","Diretor(a) Ministério da Saúde","Diretor(a) Associado(a) Ministério da Saúde","Discípulo Teen Ministério da Saúde","Diretor(a) Ministério das Possibilidades","Diretor(a) Associado(a) Ministério das Possibilidades","Discípulo Teen Ministério das Possibilidades","Diretor(a) Ministério da Música","Diretor(a) Associado(a) Ministério da Música","Discípulo Teen Ministério da Música","Diretor(a) Comunicação","Diretor(a) Associado(a) Comunicação","Social Media (redes sociais)","Discípulo Teen Comunicação","Diretor(a) Sonoplastia","Diretor(a) Associado(a) Sonoplastia","Equipe Sonoplastia"],status:"draft"}),[_,H]=s.useState(!0),[G,K]=s.useState(!1),[W,Z]=s.useState("");s.useEffect(()=>{(async()=>{H(!0);try{await Promise.all([Q(),X(),Y()])}finally{H(!1)}})()},[]);const Q=async()=>{try{const e=await fetch("/api/churches");if(e.ok){const s=await e.json();R(s||[])}else F({title:"Erro",description:"Erro ao carregar lista de igrejas",variant:"destructive"})}catch(e){F({title:"Erro",description:"Erro de conexão ao carregar igrejas",variant:"destructive"})}},X=async()=>{try{const e=await fetch("/api/users");if(e.ok){const s=(await e.json()||[]).filter(e=>e.role&&e.role.includes("member")&&("approved"===e.status||"pending"===e.status));$(s)}else F({title:"Erro",description:"Erro ao carregar lista de membros",variant:"destructive"})}catch(e){F({title:"Erro",description:"Erro de conexão ao carregar membros",variant:"destructive"})}},Y=async()=>{try{const e=await fetch("/api/elections/config",{headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(e.ok){const s=await e.json();if(s.error)return;if(s&&s.church_id){const e={id:s.id,churchId:s.church_id||0,churchName:s.church_name||"",voters:s.voters||[],criteria:{faithfulness:{enabled:s.criteria?.faithfulness?.enabled??!0,punctual:s.criteria?.faithfulness?.punctual??!1,seasonal:s.criteria?.faithfulness?.seasonal??!1,recurring:s.criteria?.faithfulness?.recurring??!1},attendance:{enabled:s.criteria?.attendance?.enabled??!0,punctual:s.criteria?.attendance?.punctual??!1,seasonal:s.criteria?.attendance?.seasonal??!1,recurring:s.criteria?.attendance?.recurring??!1},churchTime:{enabled:s.criteria?.churchTime?.enabled??!0,minimumMonths:s.criteria?.churchTime?.minimumMonths??12},positionLimit:{enabled:s.criteria?.positionLimit?.enabled??!0,maxPositions:s.criteria?.positionLimit?.maxPositions??2}},positions:s.positions||[],status:s.status||"draft"};B(e)}}else if(404!==e.status)throw new Error(`HTTP ${e.status}`)}catch(e){F({title:"Erro",description:"Erro ao carregar configuração de eleição",variant:"destructive"})}},ee=(e,s)=>{B(a=>{const i={...a};if(i.criteria||(i.criteria={faithfulness:{enabled:!0,punctual:!0,seasonal:!0,recurring:!0},attendance:{enabled:!0,threshold:75},churchTime:{enabled:!0,minimumMonths:12},positionLimit:{enabled:!0,maxPositions:2}}),e.includes(".")){const[a,r]=e.split(".");i.criteria[a]||(i.criteria[a]={}),i.criteria[a][r]=s}else i.criteria[e]=s;return i})},se=e=>{B(s=>({...s,positions:(s.positions||[]).includes(e)?(s.positions||[]).filter(s=>s!==e):[...s.positions||[],e]}))},ae=O.filter(e=>{const s=e.church===V.churchName||""===V.churchName,a=""===W||e.name.toLowerCase().includes(W.toLowerCase())||e.email.toLowerCase().includes(W.toLowerCase());return s&&a}),ie=O.filter(e=>V.voters?.includes(e.id)||!1);return _?e.jsx(r,{children:e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Carregando..."}),e.jsx("p",{className:"text-muted-foreground",children:"Preparando configuração de eleição"})]})}):"admin"!==I?.role?e.jsx(r,{children:e.jsxs("div",{className:"p-4 text-center",children:[e.jsx(A,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Acesso Restrito"}),e.jsx("p",{className:"text-muted-foreground",children:"Apenas administradores podem configurar eleições."})]})}):e.jsx(r,{children:e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(n,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Configuração de Nomeações"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure os parâmetros da nomeação de liderança"})]})]}),e.jsx("div",{className:"flex items-center justify-center space-x-4 mb-6",children:[1,2,3,4].map(s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium "+(z>=s?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"),children:s}),e.jsxs("span",{className:"ml-2 text-sm font-medium "+(z>=s?"text-blue-600":"text-gray-500"),children:[1===s&&"Igreja",2===s&&"Votantes",3===s&&"Critérios",4===s&&"Cargos"]}),s<4&&e.jsx("div",{className:"w-8 h-0.5 mx-2 "+(z>s?"bg-blue-600":"bg-gray-200")})]},s))}),q&&e.jsxs(t,{className:"mb-4",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsxs(c,{children:[e.jsx("strong",{children:"Configuração já existe!"})," Já existe uma configuração para esta igreja. Você pode editar a configuração existente ou criar uma nova."]})]}),e.jsxs("div",{className:"space-y-4",children:[1===z&&e.jsxs(o,{children:[e.jsxs(l,{children:[e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(m,{className:"h-5 w-5"}),"Seleção da Igreja"]}),e.jsx(h,{children:"Selecione qual igreja será feita a eleição de liderança"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"church",children:"Igreja"}),e.jsxs(p,{value:V.churchId?.toString()||"",onValueChange:async e=>{const s=L.find(s=>s.id?.toString()===e);if(s){B(e=>({...e,churchId:s.id,churchName:s.name}));try{const e=await fetch("/api/elections/configs",{headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(e.ok){const a=(await e.json()).find(e=>e.church_id===s.id);J(!!a)}}catch(a){}X(s.name)}},children:[e.jsx(j,{children:e.jsx(f,{placeholder:"Selecione uma igreja"})}),e.jsx(g,{children:L.map(s=>e.jsx(v,{value:s.id?.toString()||"",children:s.name},s.id))})]})]}),V.churchName&&e.jsxs(t,{children:[e.jsx(N,{className:"h-4 w-4"}),e.jsxs(c,{children:["Eleição será realizada na igreja: ",e.jsx("strong",{children:V.churchName})]})]})]})]}),2===z&&e.jsxs(o,{children:[e.jsxs(l,{children:[e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5"}),"Seleção de Votantes"]}),e.jsxs(h,{children:['Selecione quais membros da igreja "',V.churchName||"Selecione uma igreja",'" poderão votar na eleição']})]}),e.jsx(x,{className:"space-y-4",children:V.churchId?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"voter-search",children:"Buscar membros"}),e.jsx(C,{id:"voter-search",type:"text",placeholder:"Digite o nome ou email do membro para pesquisar...",value:W,onChange:e=>Z(e.target.value),className:"w-full"})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-muted-foreground",children:[e.jsxs("span",{children:[ae.length," membro(s) encontrado(s)"]}),e.jsxs("span",{children:[ie.length," votante(s) selecionado(s)"]})]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:ae.map(s=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(w,{id:`voter-${s.id}`,checked:V.voters?.includes(s.id)||!1,onCheckedChange:()=>{return e=s.id,void B(s=>({...s,voters:(s.voters||[]).includes(e)?(s.voters||[]).filter(s=>s!==e):[...s.voters||[],e]}));var e}}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[e.jsx("span",{className:"font-medium text-sm truncate",children:s.name}),e.jsx("span",{className:"text-xs text-muted-foreground truncate",children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[e.jsx(y,{variant:"secondary",className:"text-xs",children:s.role}),e.jsx(y,{variant:"approved"===s.status?"default":"outline",className:"text-xs",children:"approved"===s.status?"Ativo":"Pendente"}),e.jsx(y,{variant:"outline",className:"text-xs",children:s.church})]})]})})]},s.id))}),0===ae.length&&W&&e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"text-muted-foreground mb-2",children:[e.jsx(b,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsxs("p",{children:['Nenhum membro encontrado para "',W,'"']}),e.jsx("p",{className:"text-xs mt-1",children:"Tente usar um termo de busca diferente"})]})}),0===ae.length&&!W&&e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"text-muted-foreground mb-2",children:[e.jsx(b,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsxs("p",{children:['Nenhum membro encontrado para a igreja "',V.churchName,'"']}),e.jsx("p",{className:"text-xs mt-1",children:"Verifique se a igreja foi selecionada corretamente"})]})}),ae.length>0&&e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>{const e=ae.map(e=>e.id);B(s=>({...s,voters:e}))},className:"flex-1",children:"Selecionar Todos"}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>{B(e=>({...e,voters:[]}))},className:"flex-1",children:"Limpar Seleção"})]}),ie.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{children:["Votantes selecionados (",ie.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ie.map(s=>e.jsxs(y,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),s.name]},s.id))})]})]}):e.jsxs(t,{children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx(c,{children:'Selecione uma igreja na aba "Configuração Básica" para visualizar os membros disponíveis.'})]})})]}),3===z&&e.jsxs(o,{children:[e.jsxs(l,{children:[e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Critérios de Candidatos"]}),e.jsx(h,{children:"Defina os critérios que os candidatos devem atender"})]}),e.jsx(x,{className:"space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"faithfulness-enabled",checked:V.criteria?.faithfulness?.enabled||!1,onCheckedChange:e=>ee("faithfulness.enabled",e)}),e.jsx(u,{htmlFor:"faithfulness-enabled",className:"cursor-pointer",children:"Fidelidade nos dízimos e ofertas"})]})}),V.criteria?.faithfulness?.enabled&&e.jsxs("div",{className:"ml-6 space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(u,{className:"text-sm font-medium",children:"Tipos de fidelidade obrigatórios:"}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-blue-600",children:"P"})}),e.jsxs("div",{children:[e.jsx(u,{className:"font-medium text-sm",children:"Pontual"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Dízimos pagos no prazo"})]})]}),e.jsx(w,{id:"punctual",checked:V.criteria?.faithfulness?.punctual||!1,onCheckedChange:e=>ee("faithfulness.punctual",e)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-green-600",children:"S"})}),e.jsxs("div",{children:[e.jsx(u,{className:"font-medium text-sm",children:"Sazonal"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ofertas especiais e campanhas"})]})]}),e.jsx(w,{id:"seasonal",checked:V.criteria?.faithfulness?.seasonal||!1,onCheckedChange:e=>ee("faithfulness.seasonal",e)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-purple-600",children:"R"})}),e.jsxs("div",{children:[e.jsx(u,{className:"font-medium text-sm",children:"Recorrente"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Contribuições regulares"})]})]}),e.jsx(w,{id:"recurring",checked:V.criteria?.faithfulness?.recurring||!1,onCheckedChange:e=>ee("faithfulness.recurring",e)})]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx(u,{className:"text-sm font-medium text-blue-800",children:"Critérios Ativos:"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[V.criteria?.faithfulness?.punctual&&e.jsx(y,{variant:"secondary",className:"text-xs bg-blue-100 text-blue-700",children:"Pontual"}),V.criteria?.faithfulness?.seasonal&&e.jsx(y,{variant:"secondary",className:"text-xs bg-green-100 text-green-700",children:"Sazonal"}),V.criteria?.faithfulness?.recurring&&e.jsx(y,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:"Recorrente"}),!V.criteria?.faithfulness?.punctual&&!V.criteria?.faithfulness?.seasonal&&!V.criteria?.faithfulness?.recurring&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"Nenhum critério selecionado"})]})]})]})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"attendance-enabled",checked:V.criteria?.attendance?.enabled||!1,onCheckedChange:e=>ee("attendance.enabled",e)}),e.jsx(u,{htmlFor:"attendance-enabled",className:"cursor-pointer",children:"Presença regular (teveParticipacao)"})]}),V.criteria?.attendance?.enabled&&e.jsxs("div",{className:"ml-6 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Tipos de participação aceitos:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"attendance-punctual",checked:V.criteria?.attendance?.punctual||!1,onCheckedChange:e=>ee("attendance.punctual",e)}),e.jsx(u,{htmlFor:"attendance-punctual",className:"cursor-pointer text-sm",children:"Pontual (Recorrente)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"attendance-seasonal",checked:V.criteria?.attendance?.seasonal||!1,onCheckedChange:e=>ee("attendance.seasonal",e)}),e.jsx(u,{htmlFor:"attendance-seasonal",className:"cursor-pointer text-sm",children:"Sazonal (Sazonal + Recorrente)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"attendance-recurring",checked:V.criteria?.attendance?.recurring||!1,onCheckedChange:e=>ee("attendance.recurring",e)}),e.jsx(u,{htmlFor:"attendance-recurring",className:"cursor-pointer text-sm",children:"Recorrente (apenas Recorrente)"})]})]}),e.jsxs(t,{children:[e.jsx(A,{className:"h-4 w-4"}),e.jsxs(c,{className:"text-xs",children:[e.jsx("strong",{children:"Critérios de participação:"}),e.jsx("br",{}),"• ",e.jsx("strong",{children:"Pontual:"}),' Apenas membros com participação "Recorrente"',e.jsx("br",{}),"• ",e.jsx("strong",{children:"Sazonal:"}),' Membros com participação "Sazonal" ou "Recorrente"',e.jsx("br",{}),"• ",e.jsx("strong",{children:"Recorrente:"}),' Apenas membros com participação "Recorrente"',e.jsx("br",{}),"• ",e.jsx("strong",{children:"Exclusão:"}),' Membros com "Sem participação" são automaticamente excluídos']})]})]})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"church-time-enabled",checked:V.criteria?.churchTime?.enabled||!1,onCheckedChange:e=>ee("churchTime.enabled",e)}),e.jsx(u,{htmlFor:"church-time-enabled",className:"cursor-pointer",children:"Tempo mínimo de igreja"})]}),V.criteria?.churchTime?.enabled&&e.jsxs("div",{className:"ml-6 space-y-2",children:[e.jsx(u,{htmlFor:"minimumMonths",children:"Tempo mínimo em meses"}),e.jsx(C,{id:"minimumMonths",type:"number",min:"1",max:"120",value:V.criteria?.churchTime?.minimumMonths||12,onChange:e=>ee("churchTime.minimumMonths",parseInt(e.target.value))}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Membros com menos de ",V.criteria?.churchTime?.minimumMonths||12," meses na igreja não poderão ser candidatos"]})]})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:"position-limit-enabled",checked:V.criteria?.positionLimit?.enabled||!1,onCheckedChange:e=>ee("positionLimit.enabled",e)}),e.jsx(u,{htmlFor:"position-limit-enabled",className:"cursor-pointer",children:"Limite de cargos por pessoa"})]}),V.criteria?.positionLimit?.enabled&&e.jsxs("div",{className:"ml-6 space-y-2",children:[e.jsx(u,{htmlFor:"maxPositions",children:"Máximo de cargos por pessoa"}),e.jsx(C,{id:"maxPositions",type:"number",min:"1",max:"4",value:V.criteria?.positionLimit?.maxPositions||2,onChange:e=>ee("positionLimit.maxPositions",parseInt(e.target.value))}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Uma pessoa pode ser eleita para no máximo ",V.criteria?.positionLimit?.maxPositions||2," cargo(s)"]})]})]})]})})]}),4===z&&e.jsxs(o,{children:[e.jsxs(l,{children:[e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"Cargos para Eleição"]}),e.jsx(h,{children:"Selecione quais cargos serão eleitos organizados por categoria"})]}),e.jsxs(x,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("h3",{className:"font-semibold text-green-700",children:"ANCIÃOS / ANCIÃS / DIRETORES"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 ml-4",children:V.positions?.filter(e=>e.includes("Ancião")||e.includes("Secretário")||e.includes("Tesoureiro")||e.includes("Patrimônio")).map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:`position-${s}`,checked:!0,onCheckedChange:()=>se(s)}),e.jsx(u,{htmlFor:`position-${s}`,className:"cursor-pointer flex-1 text-sm",children:s})]},s))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),e.jsx("h3",{className:"font-semibold text-purple-700",children:"DIACONATO"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 ml-4",children:V.positions?.filter(e=>e.includes("Diácono")||e.includes("Diaconisa")).map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:`position-${s}`,checked:!0,onCheckedChange:()=>se(s)}),e.jsx(u,{htmlFor:`position-${s}`,className:"cursor-pointer flex-1 text-sm",children:s})]},s))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),e.jsx("h3",{className:"font-semibold text-orange-700",children:"MORDOMIA CRISTÃ"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 ml-4",children:V.positions?.filter(e=>e.includes("Mordomia")||"Diretor(a)"===e&&!e.includes("Ministério")||"Diretor(a) Associado(a)"===e||"Discípulo Teen"===e).map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:`position-${s}`,checked:!0,onCheckedChange:()=>se(s)}),e.jsx(u,{htmlFor:`position-${s}`,className:"cursor-pointer flex-1 text-sm",children:s})]},s))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx("div",{className:"w-3 h-3 bg-pink-500 rounded-full"}),e.jsx("h3",{className:"font-semibold text-pink-700",children:"NOVAS GERAÇÕES"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 ml-4",children:V.positions?.filter(e=>e.includes("Criança")||e.includes("Adolescentes")||e.includes("Jovem")||e.includes("Aventureiros")||e.includes("Desbravadores")).map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:`position-${s}`,checked:!0,onCheckedChange:()=>se(s)}),e.jsx(u,{htmlFor:`position-${s}`,className:"cursor-pointer flex-1 text-sm",children:s})]},s))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx("div",{className:"w-3 h-3 bg-indigo-500 rounded-full"}),e.jsx("h3",{className:"font-semibold text-indigo-700",children:"ESCOLA SABATINA"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 ml-4",children:V.positions?.filter(e=>e.includes("Professores")||e.includes("Escola Sabatina")).map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:`position-${s}`,checked:!0,onCheckedChange:()=>se(s)}),e.jsx(u,{htmlFor:`position-${s}`,className:"cursor-pointer flex-1 text-sm",children:s})]},s))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx("div",{className:"w-3 h-3 bg-teal-500 rounded-full"}),e.jsx("h3",{className:"font-semibold text-teal-700",children:"MINISTÉRIOS ESPECIALIZADOS"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 ml-4",children:V.positions?.filter(e=>e.includes("Ministério")||e.includes("ASA")||e.includes("Evangelismo")||e.includes("Classes Bíblicas")||e.includes("Interessados")||e.includes("Casal")||e.includes("Recepção")||e.includes("Possibilidades")||e.includes("Música")||e.includes("Comunicação")||e.includes("Sonoplastia")).map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{id:`position-${s}`,checked:!0,onCheckedChange:()=>se(s)}),e.jsx(u,{htmlFor:`position-${s}`,className:"cursor-pointer flex-1 text-sm",children:s})]},s))})]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-6 border-t",children:[e.jsx(S,{variant:"outline",onClick:()=>U(Math.max(1,z-1)),disabled:1===z,children:"Anterior"}),e.jsx("div",{className:"flex gap-3",children:z<4?e.jsx(S,{onClick:()=>U(Math.min(4,z+1)),disabled:!(()=>{switch(z){case 1:return V.churchId&&V.churchName;case 2:return V.voters&&V.voters.length>0;case 3:return!0;case 4:return V.positions&&V.positions.length>0;default:return!1}})(),children:"Próximo"}):e.jsxs(e.Fragment,{children:[e.jsxs(S,{onClick:async()=>{if(q)F({title:"Configuração já existe",description:"Já existe uma configuração para esta igreja. Use 'Editar' para modificar.",variant:"destructive"});else{K(!0);try{const e=await fetch("/api/elections/config",{method:"POST",headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"},body:JSON.stringify(V)});if(!e.ok)throw new Error("Erro ao salvar configuração");{const s=await e.json();J(!0),B(e=>({...e,id:s.id})),F({title:"Configuração salva",description:"Os parâmetros da nomeação foram salvos com sucesso."}),U(2)}}catch(e){F({title:"Erro",description:"Não foi possível salvar a configuração.",variant:"destructive"})}finally{K(!1)}}},disabled:G||q,variant:"outline",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),G?"Salvando...":"Salvar Configuração"]}),e.jsxs(S,{onClick:async()=>{if(V.voters&&0!==V.voters.length)if(V.positions&&0!==V.positions.length){H(!0);try{if(!(await fetch("/api/elections/start",{method:"POST",headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"},body:JSON.stringify({...V,configId:V.id})})).ok)throw new Error("Erro ao iniciar eleição");B(e=>({...e,status:"active"})),F({title:"Eleição iniciada",description:"A eleição foi iniciada com sucesso. Os votantes já podem acessar a página de votação."})}catch(e){F({title:"Erro",description:"Não foi possível iniciar a eleição.",variant:"destructive"})}finally{H(!1)}}else F({title:"Erro",description:"Selecione pelo menos um cargo.",variant:"destructive"});else F({title:"Erro",description:"Selecione pelo menos um votante.",variant:"destructive"})},disabled:_,variant:"default",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),_?"Iniciando...":"Iniciar Nomeação"]})]})})]}),"active"===V.status&&e.jsxs(t,{children:[e.jsx(N,{className:"h-4 w-4"}),e.jsxs(c,{children:[e.jsx("strong",{children:"Nomeação ativa!"})," Os votantes já podem acessar a página de votação."]})]})]})})}export{I as default};
