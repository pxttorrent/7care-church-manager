import{Z as e,P as t,_ as s,$ as a,a0 as r,a1 as i,a2 as o,j as n,k as l,b as d,a3 as c,c as m,u,e as x,A as h,d as p,g,a4 as f,a5 as v,a6 as j,a7 as b,a8 as N,D as y,C as w,n as C,a9 as D,aa as k,l as S,ab as E,ac as A,ad as z,ae as P}from"./ui-Dcxc0my-.js";import{r as I,R as O}from"./vendor-v6ZOr5pf.js";import{u as F}from"./useQuery-Boy_V7AT.js";import{c as T,g as M,e as R,U as q,B as $,L as V,I as _,f as B,N as L,j as U,h as K,X as Q,i as J,C as W,d as Y,y as G,F as H,O as Z,H as X,M as ee,Q as te,a as se,b as ae,s as re,t as ie,v as oe,w as ne,x as le,l as de,R as ce,o as me,W as ue,D as xe,z as he,A as pe,Y as ge}from"./index-kLixipXW.js";import{C as fe,B as ve,u as je}from"./useMutation-D4M-zFwg.js";import{u as be,A as Ne}from"./useUserPoints-DunCdDtX.js";import{A as ye,a as we,b as Ce}from"./avatar-De0eUN9F.js";import{M as De,d as ke,e as Se,f as Ee}from"./mount-icon-CWOJc24I.js";import{D as Ae,a as ze,b as Pe,c as Ie,d as Oe}from"./dialog-DD0-rGkz.js";import{S as Fe}from"./search-DtO8vbLL.js";import{T as Te,S as Me}from"./triangle-alert-Bei1Hhlt.js";import{C as Re}from"./clock-CJQtUt-X.js";import{M as qe}from"./map-pin-BbwXJnyK.js";import{T as $e}from"./trash-2-9a64bnZN.js";import{T as Ve}from"./textarea-CLhrzmXo.js";import{G as _e,M as Be}from"./mountain-B_kR6zmK.js";import{U as Le}from"./user-plus-D_A4i3g5.js";import"./charts-56rtB2he.js";import"./pointsCalculator-BwBrJ8sV.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=T("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),Ke=T("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),Qe=T("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),Je=T("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),We=T("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),Ye=T("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Ge=T("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),He=T("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ze=.999,Xe=/[\\\/_+.#"@\[\(\{&]/,et=/[\\\/_+.#"@\[\(\{&]/g,tt=/[\s-]/,st=/[\s-]/g;function at(e,t,s,a,r,i,o){if(i===t.length)return r===e.length?1:.99;var n=`${r},${i}`;if(void 0!==o[n])return o[n];for(var l,d,c,m,u=a.charAt(i),x=s.indexOf(u,r),h=0;x>=0;)(l=at(e,t,s,a,x+1,i+1,o))>h&&(x===r?l*=1:Xe.test(e.charAt(x-1))?(l*=.8,(c=e.slice(r,x-1).match(et))&&r>0&&(l*=Math.pow(Ze,c.length))):tt.test(e.charAt(x-1))?(l*=.9,(m=e.slice(r,x-1).match(st))&&r>0&&(l*=Math.pow(Ze,m.length))):(l*=.17,r>0&&(l*=Math.pow(Ze,x-r))),e.charAt(x)!==t.charAt(i)&&(l*=.9999)),(l<.1&&s.charAt(x-1)===a.charAt(i+1)||a.charAt(i+1)===a.charAt(i)&&s.charAt(x-1)!==a.charAt(i))&&(.1*(d=at(e,t,s,a,x+1,i+2,o))>l&&(l=.1*d)),l>h&&(h=l),x=s.indexOf(u,x+1);return o[n]=h,h}function rt(e){return e.toLowerCase().replace(st," ")}function it(e,t,s){return at(e=s&&s.length>0?""+(e+" "+s.join(" ")):e,t,rt(e),rt(t),0,0,{})}var ot='[cmdk-group=""]',nt='[cmdk-group-items=""]',lt='[cmdk-item=""]',dt=`${lt}:not([aria-disabled="true"])`,ct="cmdk-item-select",mt="data-value",ut=(e,t,s)=>it(e,t,s),xt=I.createContext(void 0),ht=()=>I.useContext(xt),pt=I.createContext(void 0),gt=()=>I.useContext(pt),ft=I.createContext(void 0),vt=I.forwardRef((s,a)=>{let r=It(()=>{var e,t;return{search:"",value:null!=(t=null!=(e=s.value)?e:s.defaultValue)?t:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),i=It(()=>new Set),o=It(()=>new Map),n=It(()=>new Map),l=It(()=>new Set),d=zt(s),{label:c,children:m,value:u,onValueChange:x,filter:h,shouldFilter:p,loop:g,disablePointerSelection:f=!1,vimBindings:v=!0,...j}=s,b=e(),N=e(),y=e(),w=I.useRef(null),C=Tt();Pt(()=>{if(void 0!==u){let e=u.trim();r.current.value=e,D.emit()}},[u]),Pt(()=>{C(6,P)},[]);let D=I.useMemo(()=>({subscribe:e=>(l.current.add(e),()=>l.current.delete(e)),snapshot:()=>r.current,setState:(e,t,s)=>{var a,i,o,n;if(!Object.is(r.current[e],t)){if(r.current[e]=t,"search"===e)z(),E(),C(1,A);else if("value"===e){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let e=document.getElementById(y);e?e.focus():null==(a=document.getElementById(b))||a.focus()}if(C(7,()=>{var e;r.current.selectedItemId=null==(e=O())?void 0:e.id,D.emit()}),s||C(5,P),void 0!==(null==(i=d.current)?void 0:i.value)){let e=null!=t?t:"";return void(null==(n=(o=d.current).onValueChange)||n.call(o,e))}}D.emit()}},emit:()=>{l.current.forEach(e=>e())}}),[]),k=I.useMemo(()=>({value:(e,t,s)=>{var a;t!==(null==(a=n.current.get(e))?void 0:a.value)&&(n.current.set(e,{value:t,keywords:s}),r.current.filtered.items.set(e,S(t,s)),C(2,()=>{E(),D.emit()}))},item:(e,t)=>(i.current.add(e),t&&(o.current.has(t)?o.current.get(t).add(e):o.current.set(t,new Set([e]))),C(3,()=>{z(),E(),r.current.value||A(),D.emit()}),()=>{n.current.delete(e),i.current.delete(e),r.current.filtered.items.delete(e);let t=O();C(4,()=>{z(),(null==t?void 0:t.getAttribute("id"))===e&&A(),D.emit()})}),group:e=>(o.current.has(e)||o.current.set(e,new Set),()=>{n.current.delete(e),o.current.delete(e)}),filter:()=>d.current.shouldFilter,label:c||s["aria-label"],getDisablePointerSelection:()=>d.current.disablePointerSelection,listId:b,inputId:y,labelId:N,listInnerRef:w}),[]);function S(e,t){var s,a;let i=null!=(a=null==(s=d.current)?void 0:s.filter)?a:ut;return e?i(e,r.current.search,t):0}function E(){if(!r.current.search||!1===d.current.shouldFilter)return;let e=r.current.filtered.items,t=[];r.current.filtered.groups.forEach(s=>{let a=o.current.get(s),r=0;a.forEach(t=>{let s=e.get(t);r=Math.max(s,r)}),t.push([s,r])});let s=w.current;F().sort((t,s)=>{var a,r;let i=t.getAttribute("id"),o=s.getAttribute("id");return(null!=(a=e.get(o))?a:0)-(null!=(r=e.get(i))?r:0)}).forEach(e=>{let t=e.closest(nt);t?t.appendChild(e.parentElement===t?e:e.closest(`${nt} > *`)):s.appendChild(e.parentElement===s?e:e.closest(`${nt} > *`))}),t.sort((e,t)=>t[1]-e[1]).forEach(e=>{var t;let s=null==(t=w.current)?void 0:t.querySelector(`${ot}[${mt}="${encodeURIComponent(e[0])}"]`);null==s||s.parentElement.appendChild(s)})}function A(){let e=F().find(e=>"true"!==e.getAttribute("aria-disabled")),t=null==e?void 0:e.getAttribute(mt);D.setState("value",t||void 0)}function z(){var e,t,s,a;if(!r.current.search||!1===d.current.shouldFilter)return void(r.current.filtered.count=i.current.size);r.current.filtered.groups=new Set;let l=0;for(let o of i.current){let i=S(null!=(t=null==(e=n.current.get(o))?void 0:e.value)?t:"",null!=(a=null==(s=n.current.get(o))?void 0:s.keywords)?a:[]);r.current.filtered.items.set(o,i),i>0&&l++}for(let[i,n]of o.current)for(let e of n)if(r.current.filtered.items.get(e)>0){r.current.filtered.groups.add(i);break}r.current.filtered.count=l}function P(){var e,t,s;let a=O();a&&((null==(e=a.parentElement)?void 0:e.firstChild)===a&&(null==(s=null==(t=a.closest(ot))?void 0:t.querySelector('[cmdk-group-heading=""]'))||s.scrollIntoView({block:"nearest"})),a.scrollIntoView({block:"nearest"}))}function O(){var e;return null==(e=w.current)?void 0:e.querySelector(`${lt}[aria-selected="true"]`)}function F(){var e;return Array.from((null==(e=w.current)?void 0:e.querySelectorAll(dt))||[])}function T(e){let t=F()[e];t&&D.setState("value",t.getAttribute(mt))}function M(e){var t;let s=O(),a=F(),r=a.findIndex(e=>e===s),i=a[r+e];null!=(t=d.current)&&t.loop&&(i=r+e<0?a[a.length-1]:r+e===a.length?a[0]:a[r+e]),i&&D.setState("value",i.getAttribute(mt))}function R(e){let t,s=O(),a=null==s?void 0:s.closest(ot);for(;a&&!t;)a=e>0?Et(a,ot):At(a,ot),t=null==a?void 0:a.querySelector(dt);t?D.setState("value",t.getAttribute(mt)):M(e)}let q=()=>T(F().length-1),$=e=>{e.preventDefault(),e.metaKey?q():e.altKey?R(1):M(1)},V=e=>{e.preventDefault(),e.metaKey?T(0):e.altKey?R(-1):M(-1)};return I.createElement(t.div,{ref:a,tabIndex:-1,...j,"cmdk-root":"",onKeyDown:e=>{var t;null==(t=j.onKeyDown)||t.call(j,e);let s=e.nativeEvent.isComposing||229===e.keyCode;if(!e.defaultPrevented&&!s)switch(e.key){case"n":case"j":v&&e.ctrlKey&&$(e);break;case"ArrowDown":$(e);break;case"p":case"k":v&&e.ctrlKey&&V(e);break;case"ArrowUp":V(e);break;case"Home":e.preventDefault(),T(0);break;case"End":e.preventDefault(),q();break;case"Enter":{e.preventDefault();let t=O();if(t){let e=new Event(ct);t.dispatchEvent(e)}}}}},I.createElement("label",{"cmdk-label":"",htmlFor:k.inputId,id:k.labelId,style:Rt},c),Mt(s,e=>I.createElement(pt.Provider,{value:D},I.createElement(xt.Provider,{value:k},e))))}),jt=I.forwardRef((s,a)=>{var r,i;let n=e(),l=I.useRef(null),d=I.useContext(ft),c=ht(),m=zt(s),u=null!=(i=null==(r=m.current)?void 0:r.forceMount)?i:null==d?void 0:d.forceMount;Pt(()=>{if(!u)return c.item(n,null==d?void 0:d.id)},[u]);let x=Ft(n,l,[s.value,s.children,l],s.keywords),h=gt(),p=Ot(e=>e.value&&e.value===x.current),g=Ot(e=>!(!u&&!1!==c.filter())||(!e.search||e.filtered.items.get(n)>0));function f(){var e,t;v(),null==(t=(e=m.current).onSelect)||t.call(e,x.current)}function v(){h.setState("value",x.current,!0)}if(I.useEffect(()=>{let e=l.current;if(e&&!s.disabled)return e.addEventListener(ct,f),()=>e.removeEventListener(ct,f)},[g,s.onSelect,s.disabled]),!g)return null;let{disabled:j,value:b,onSelect:N,forceMount:y,keywords:w,...C}=s;return I.createElement(t.div,{ref:o(l,a),...C,id:n,"cmdk-item":"",role:"option","aria-disabled":!!j,"aria-selected":!!p,"data-disabled":!!j,"data-selected":!!p,onPointerMove:j||c.getDisablePointerSelection()?void 0:v,onClick:j?void 0:f},s.children)}),bt=I.forwardRef((s,a)=>{let{heading:r,children:i,forceMount:n,...l}=s,d=e(),c=I.useRef(null),m=I.useRef(null),u=e(),x=ht(),h=Ot(e=>!(!n&&!1!==x.filter())||(!e.search||e.filtered.groups.has(d)));Pt(()=>x.group(d),[]),Ft(d,c,[s.value,s.heading,m]);let p=I.useMemo(()=>({id:d,forceMount:n}),[n]);return I.createElement(t.div,{ref:o(c,a),...l,"cmdk-group":"",role:"presentation",hidden:!h||void 0},r&&I.createElement("div",{ref:m,"cmdk-group-heading":"","aria-hidden":!0,id:u},r),Mt(s,e=>I.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?u:void 0},I.createElement(ft.Provider,{value:p},e))))}),Nt=I.forwardRef((e,s)=>{let{alwaysRender:a,...r}=e,i=I.useRef(null),n=Ot(e=>!e.search);return a||n?I.createElement(t.div,{ref:o(i,s),...r,"cmdk-separator":"",role:"separator"}):null}),yt=I.forwardRef((e,s)=>{let{onValueChange:a,...r}=e,i=null!=e.value,o=gt(),n=Ot(e=>e.search),l=Ot(e=>e.selectedItemId),d=ht();return I.useEffect(()=>{null!=e.value&&o.setState("search",e.value)},[e.value]),I.createElement(t.input,{ref:s,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":d.listId,"aria-labelledby":d.labelId,"aria-activedescendant":l,id:d.inputId,type:"text",value:i?e.value:n,onChange:e=>{i||o.setState("search",e.target.value),null==a||a(e.target.value)}})}),wt=I.forwardRef((e,s)=>{let{children:a,label:r="Suggestions",...i}=e,n=I.useRef(null),l=I.useRef(null),d=Ot(e=>e.selectedItemId),c=ht();return I.useEffect(()=>{if(l.current&&n.current){let e,t=l.current,s=n.current,a=new ResizeObserver(()=>{e=requestAnimationFrame(()=>{let e=t.offsetHeight;s.style.setProperty("--cmdk-list-height",e.toFixed(1)+"px")})});return a.observe(t),()=>{cancelAnimationFrame(e),a.unobserve(t)}}},[]),I.createElement(t.div,{ref:o(n,s),...i,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":d,"aria-label":r,id:c.listId},Mt(e,e=>I.createElement("div",{ref:o(l,c.listInnerRef),"cmdk-list-sizer":""},e)))}),Ct=I.forwardRef((e,t)=>{let{open:o,onOpenChange:n,overlayClassName:l,contentClassName:d,container:c,...m}=e;return I.createElement(s,{open:o,onOpenChange:n},I.createElement(a,{container:c},I.createElement(r,{"cmdk-overlay":"",className:l}),I.createElement(i,{"aria-label":e.label,"cmdk-dialog":"",className:d},I.createElement(vt,{ref:t,...m}))))}),Dt=I.forwardRef((e,s)=>Ot(e=>0===e.filtered.count)?I.createElement(t.div,{ref:s,...e,"cmdk-empty":"",role:"presentation"}):null),kt=I.forwardRef((e,s)=>{let{progress:a,children:r,label:i="Loading...",...o}=e;return I.createElement(t.div,{ref:s,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":a,"aria-valuemin":0,"aria-valuemax":100,"aria-label":i},Mt(e,e=>I.createElement("div",{"aria-hidden":!0},e)))}),St=Object.assign(vt,{List:wt,Item:jt,Input:yt,Group:bt,Separator:Nt,Dialog:Ct,Empty:Dt,Loading:kt});function Et(e,t){let s=e.nextElementSibling;for(;s;){if(s.matches(t))return s;s=s.nextElementSibling}}function At(e,t){let s=e.previousElementSibling;for(;s;){if(s.matches(t))return s;s=s.previousElementSibling}}function zt(e){let t=I.useRef(e);return Pt(()=>{t.current=e}),t}var Pt="undefined"==typeof window?I.useEffect:I.useLayoutEffect;function It(e){let t=I.useRef();return void 0===t.current&&(t.current=e()),t}function Ot(e){let t=gt(),s=()=>e(t.snapshot());return I.useSyncExternalStore(t.subscribe,s,s)}function Ft(e,t,s,a=[]){let r=I.useRef(),i=ht();return Pt(()=>{var o;let n=(()=>{var e;for(let t of s){if("string"==typeof t)return t.trim();if("object"==typeof t&&"current"in t)return t.current?null==(e=t.current.textContent)?void 0:e.trim():r.current}})(),l=a.map(e=>e.trim());i.value(e,n,l),null==(o=t.current)||o.setAttribute(mt,n),r.current=n}),r}var Tt=()=>{let[e,t]=I.useState(),s=It(()=>new Map);return Pt(()=>{s.current.forEach(e=>e()),s.current=new Map},[e]),(e,a)=>{s.current.set(e,a),t({})}};function Mt({asChild:e,children:t},s){return e&&I.isValidElement(t)?I.cloneElement(function(e){let t=e.type;return"function"==typeof t?t(e.props):"render"in t?t.render(e.props):e}(t),{ref:t.ref},s(t.props.children)):s(t)}var Rt={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const qt=I.forwardRef(({className:e,...t},s)=>n.jsx(St,{ref:s,className:M("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));qt.displayName=St.displayName;const $t=I.forwardRef(({className:e,...t},s)=>n.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[n.jsx(Fe,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),n.jsx(St.Input,{ref:s,className:M("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));$t.displayName=St.Input.displayName;const Vt=I.forwardRef(({className:e,...t},s)=>n.jsx(St.List,{ref:s,className:M("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));Vt.displayName=St.List.displayName;const _t=I.forwardRef((e,t)=>n.jsx(St.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));_t.displayName=St.Empty.displayName;const Bt=I.forwardRef(({className:e,...t},s)=>n.jsx(St.Group,{ref:s,className:M("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));Bt.displayName=St.Group.displayName;I.forwardRef(({className:e,...t},s)=>n.jsx(St.Separator,{ref:s,className:M("-mx-1 h-px bg-border",e),...t})).displayName=St.Separator.displayName;const Lt=I.forwardRef(({className:e,...t},s)=>n.jsx(St.Item,{ref:s,className:M("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...t}));Lt.displayName=St.Item.displayName;var Ut="Popover",[Kt,Qt]=m(Ut,[l]),Jt=l(),[Wt,Yt]=Kt(Ut),Gt=t=>{const{__scopePopover:s,children:a,open:r,defaultOpen:i,onOpenChange:o,modal:l=!1}=t,m=Jt(s),u=I.useRef(null),[x,h]=I.useState(!1),[p,g]=d({prop:r,defaultProp:i??!1,onChange:o,caller:Ut});return n.jsx(c,{...m,children:n.jsx(Wt,{scope:s,contentId:e(),triggerRef:u,open:p,onOpenChange:g,onOpenToggle:I.useCallback(()=>g(e=>!e),[g]),hasCustomAnchor:x,onCustomAnchorAdd:I.useCallback(()=>h(!0),[]),onCustomAnchorRemove:I.useCallback(()=>h(!1),[]),modal:l,children:a})})};Gt.displayName=Ut;var Ht="PopoverAnchor";I.forwardRef((e,t)=>{const{__scopePopover:s,...a}=e,r=Yt(Ht,s),i=Jt(s),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=r;return I.useEffect(()=>(o(),()=>l()),[o,l]),n.jsx(h,{...i,...a,ref:t})}).displayName=Ht;var Zt="PopoverTrigger",Xt=I.forwardRef((e,s)=>{const{__scopePopover:a,...r}=e,i=Yt(Zt,a),o=Jt(a),l=u(s,i.triggerRef),d=n.jsx(t.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":ms(i.open),...r,ref:l,onClick:x(e.onClick,i.onOpenToggle)});return i.hasCustomAnchor?d:n.jsx(h,{asChild:!0,...o,children:d})});Xt.displayName=Zt;var es="PopoverPortal",[ts,ss]=Kt(es,{forceMount:void 0}),as=e=>{const{__scopePopover:t,forceMount:s,children:a,container:r}=e,i=Yt(es,t);return n.jsx(ts,{scope:t,forceMount:s,children:n.jsx(p,{present:s||i.open,children:n.jsx(g,{asChild:!0,container:r,children:a})})})};as.displayName=es;var rs="PopoverContent",is=I.forwardRef((e,t)=>{const s=ss(rs,e.__scopePopover),{forceMount:a=s.forceMount,...r}=e,i=Yt(rs,e.__scopePopover);return n.jsx(p,{present:a||i.open,children:i.modal?n.jsx(ns,{...r,ref:t}):n.jsx(ls,{...r,ref:t})})});is.displayName=rs;var os=j("PopoverContent.RemoveScroll"),ns=I.forwardRef((e,t)=>{const s=Yt(rs,e.__scopePopover),a=I.useRef(null),r=u(t,a),i=I.useRef(!1);return I.useEffect(()=>{const e=a.current;if(e)return f(e)},[]),n.jsx(v,{as:os,allowPinchZoom:!0,children:n.jsx(ds,{...e,ref:r,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:x(e.onCloseAutoFocus,e=>{e.preventDefault(),i.current||s.triggerRef.current?.focus()}),onPointerDownOutside:x(e.onPointerDownOutside,e=>{const t=e.detail.originalEvent,s=0===t.button&&!0===t.ctrlKey,a=2===t.button||s;i.current=a},{checkForDefaultPrevented:!1}),onFocusOutside:x(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),ls=I.forwardRef((e,t)=>{const s=Yt(rs,e.__scopePopover),a=I.useRef(!1),r=I.useRef(!1);return n.jsx(ds,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(a.current||s.triggerRef.current?.focus(),t.preventDefault()),a.current=!1,r.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(a.current=!0,"pointerdown"===t.detail.originalEvent.type&&(r.current=!0));const i=t.target,o=s.triggerRef.current?.contains(i);o&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&r.current&&t.preventDefault()}})}),ds=I.forwardRef((e,t)=>{const{__scopePopover:s,trapFocus:a,onOpenAutoFocus:r,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:m,...u}=e,x=Yt(rs,s),h=Jt(s);return b(),n.jsx(N,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:r,onUnmountAutoFocus:i,children:n.jsx(y,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:m,onEscapeKeyDown:l,onPointerDownOutside:d,onFocusOutside:c,onDismiss:()=>x.onOpenChange(!1),children:n.jsx(w,{"data-state":ms(x.open),role:"dialog",id:x.contentId,...h,...u,ref:t,style:{...u.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),cs="PopoverClose";I.forwardRef((e,s)=>{const{__scopePopover:a,...r}=e,i=Yt(cs,a);return n.jsx(t.button,{type:"button",...r,ref:s,onClick:x(e.onClick,()=>i.onOpenChange(!1))})}).displayName=cs;function ms(e){return e?"open":"closed"}I.forwardRef((e,t)=>{const{__scopePopover:s,...a}=e,r=Jt(s);return n.jsx(C,{...r,...a,ref:t})}).displayName="PopoverArrow";var us=as,xs=is;const hs=Gt,ps=Xt,gs=I.forwardRef(({className:e,align:t="center",sideOffset:s=4,...a},r)=>n.jsx(us,{children:n.jsx(xs,{ref:r,align:t,sideOffset:s,className:M("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));gs.displayName=xs.displayName;const fs=({isOpen:e,onClose:t,onConfirm:s,userName:a,isLoading:r=!1,visitCount:i=0,lastVisitDate:o})=>{const[l,d]=I.useState("");I.useEffect(()=>{if(e){const e=new Date((new Date).toLocaleString("en-US",{timeZone:"America/Sao_Paulo"})),t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");d(`${t}-${s}-${a}`)}},[e]);const c=0===i,m=i>0;return n.jsx(Ae,{open:e,onOpenChange:e=>!e&&t(),children:n.jsxs(ze,{className:"sm:max-w-md","aria-describedby":"mark-visit-modal-description",children:[n.jsx("div",{id:"mark-visit-modal-description",className:"sr-only",children:c?"Formulário para registrar primeira visita realizada":"Formulário para registrar nova visita realizada"}),n.jsx(Pe,{children:n.jsxs(Ie,{className:"flex items-center gap-2",children:[n.jsx(R,{className:"h-5 w-5 text-blue-600"}),c?"Registrar Primeira Visita Realizada":"Registrar Nova Visita Realizada"]})}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:c?`Confirmar que a primeira visita ao membro <strong>${a}</strong> foi realizada.`:`Confirmar que uma nova visita ao membro <strong>${a}</strong> foi realizada.`}),m&&n.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(q,{className:"h-4 w-4 text-blue-600"}),n.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Histórico de Visitas"})]}),n.jsxs("div",{className:"space-y-1 text-xs text-blue-700",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:"Total de visitas:"}),n.jsxs($,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[i," visita",i>1?"s":""]})]}),o&&n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:"Última visita:"}),n.jsx("span",{className:"font-medium",children:(e=>{if(!e)return"";try{let t;return t=e.includes("T")||e.includes("Z")?new Date(e):new Date(e+"T00:00:00-03:00"),isNaN(t.getTime())?"Data inválida":t.toLocaleDateString("pt-BR")}catch(t){return"Data inválida"}})(o)})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"visit-date",children:c?"Data da Primeira Visita Realizada":"Data da Nova Visita Realizada"}),n.jsx(_,{id:"visit-date",type:"date",value:l,onChange:e=>d(e.target.value),className:"w-full",max:(new Date).toISOString().split("T")[0]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:c?"Esta será a primeira visita realizada registrada para este membro.":"Esta visita realizada será adicionada ao histórico existente."})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[n.jsxs(B,{variant:"outline",onClick:()=>{d(""),t()},disabled:r,children:[n.jsx(fe,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),n.jsxs(B,{onClick:()=>{l&&s(l)},disabled:!l||r,className:"bg-green-600 hover:bg-green-700",children:[n.jsx(L,{className:"h-4 w-4 mr-2"}),r?"Confirmando...":c?"Confirmar Primeira Visita Realizada":"Confirmar Nova Visita Realizada"]})]})]})]})})},vs=O.memo(({interestedId:e,currentDiscipuladores:t,potentialMissionaries:s,onDiscipuladoresChange:a})=>{const[r,i]=I.useState(!1),[o,l]=I.useState(!1),[d,c]=I.useState(null),{toast:m}=U(),u=I.useMemo(()=>s.filter(e=>!t.some(t=>t.missionaryId===e.id)),[s,t]),x=I.useCallback(async r=>{l(!0);try{const o=await fetch("/api/relationships",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({missionaryId:r,interestedId:e,notes:"Discipulador adicionado via interface"})});if(!o.ok)throw new Error("Erro ao adicionar discipulador");const n=await o.json(),l=s.find(e=>e.id===r),d={id:n.id,missionaryId:n.missionaryId,interestedId:n.interestedId,status:n.status,assignedAt:n.assignedAt,notes:n.notes,missionaryName:l?.name||"Nome não encontrado",missionaryEmail:l?.email||"",missionaryPhone:l?.phone||""},c=[...t,d];a(c),m({title:"Discipulador adicionado",description:`${l?.name} foi adicionado como discipulador.`}),i(!1)}catch(o){m({title:"Erro",description:"Não foi possível adicionar o discipulador.",variant:"destructive"})}finally{l(!1)}},[e,t,s,a,m]),h=I.useCallback(async e=>{c(e);try{if(!(await fetch(`/api/relationships/${e}`,{method:"DELETE"})).ok)throw new Error("Erro ao remover discipulador");const s=t.filter(t=>t.id!==e);a(s),m({title:"Discipulador removido",description:"O discipulador foi removido com sucesso."})}catch(s){m({title:"Erro",description:"Não foi possível remover o discipulador.",variant:"destructive"})}finally{c(null)}},[t,a,m]);return n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ve,{className:"h-4 w-4 text-blue-500"}),n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Discipuladores"})]}),n.jsxs(hs,{open:r,onOpenChange:i,children:[n.jsx(ps,{asChild:!0,children:n.jsx(B,{size:"sm",variant:"ghost",className:"h-5 w-5 p-0 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-full",disabled:o||0===u.length,title:"Adicionar discipulador",children:n.jsx("span",{className:"text-sm font-bold",children:"+"})})}),n.jsxs(gs,{className:"w-80 p-0 z-50",side:"bottom",align:"end",children:[n.jsxs("div",{className:"flex justify-between items-center p-2 border-b",children:[n.jsx("span",{className:"text-sm font-medium",children:"Adicionar Discipulador"}),n.jsx(B,{variant:"ghost",size:"sm",onClick:()=>i(!1),className:"h-6 w-6 p-0",children:"✕"})]}),n.jsxs(qt,{children:[n.jsx($t,{placeholder:"Digite o nome do membro..."}),n.jsxs(Vt,{children:[n.jsx(_t,{children:0===u.length?"Todos os membros já são discipuladores":"Nenhum membro encontrado."}),n.jsx(Bt,{children:u.map(e=>n.jsxs(Lt,{value:e.name,onSelect:()=>x(e.id),disabled:o,children:[n.jsx(K,{className:"mr-2 h-4 w-4 opacity-0"}),n.jsx("span",{className:"flex-1",children:e.name}),"approved"!==e.status&&n.jsx($,{variant:"outline",className:"ml-2 text-xs",children:e.status})]},e.id))})]})]})]})]})]}),0===t.length?n.jsx("div",{className:"text-sm text-gray-500 italic",children:"Nenhum discipulador atribuído"}):n.jsx("div",{className:"flex flex-wrap gap-1",children:t.map(e=>n.jsxs("div",{className:"flex items-center gap-0.5 px-1 py-0.5 bg-blue-50 border border-blue-200 rounded-sm hover:bg-blue-100 transition-colors",children:[n.jsx("div",{className:"w-0.5 h-0.5 bg-blue-500 rounded-full"}),n.jsx("span",{className:"text-[10px] font-medium text-blue-800",title:e.missionaryName,children:e.missionaryName.split(" ")[0]}),n.jsx(B,{size:"sm",variant:"ghost",className:"h-3 w-3 p-0 hover:bg-blue-200 hover:text-blue-800",onClick:()=>h(e.id),disabled:d===e.id,title:"Remover discipulador",children:d===e.id?n.jsx("div",{className:"animate-spin rounded-full h-1.5 w-1.5 border-b-2 border-current"}):n.jsx(Q,{className:"h-1.5 w-1.5"})})]},e.id))})]})});vs.displayName="DiscipuladoresManager";const js=({user:e,onClick:t,onApprove:s,onReject:a,onEdit:r,onDelete:i,onView:o,onScheduleVisit:l,onWhatsApp:d,onMarkVisited:c,onDisciple:m,onDiscipleRequest:u,showActions:x=!0,relationshipsData:h=[]})=>{const[p,g]=I.useState(!1),[f,v]=I.useState(!1),[j,b]=I.useState(!1),[N,y]=I.useState([]),[w,C]=I.useState([]),[D,k]=I.useState(!1),[S,E]=I.useState(!1),{toast:A}=U(),{user:z}=J(),[P,O]=I.useState(!1),[F,T]=I.useState(null),[q,V]=I.useState(!1),[_,Q]=I.useState(!1),[se,ae]=I.useState([]),[re,ie]=I.useState(0),[oe,ne]=I.useState(e);I.useEffect(()=>{ne(e),V(!1)},[e]),I.useEffect(()=>{if(e?.extraData)try{let t;t="string"==typeof e.extraData?JSON.parse(e.extraData):e.extraData,b(!0===t.visited)}catch(t){b(!1)}else b(!1)},[e?.extraData]),I.useEffect(()=>{e?.id&&"admin"===z?.role?(async()=>{try{const t=await fetch(`/api/emotional-checkins/user/${e.id}`);if(t.ok){const e=await t.json();e&&e.length>0?T(e[0]):T(null)}else T(null)}catch(t){T(null)}})():T(null)},[e?.id,z?.role]);const le=()=>{if(oe?.profilePhoto)return String(oe.profilePhoto).startsWith("http")?oe.profilePhoto:`/uploads/${oe.profilePhoto}`};I.useEffect(()=>{"interested"===oe.role&&oe.id&&!q&&(V(!0),Promise.all([de(),ce()]).catch(e=>{}))},[oe.role,oe.id,q]);const de=I.useCallback(async()=>{try{const[e,t]=await Promise.all([fetch("/api/users?role=member"),fetch("/api/missionary-profiles/users")]);if(e.ok&&t.ok){const s=await e.json(),a=await t.json(),r=[...s,...a].filter((e,t,s)=>t===s.findIndex(t=>t.id===e.id));y(r)}}catch(e){}},[]),ce=I.useCallback(async()=>{try{const e=await fetch(`/api/relationships?interestedId=${oe.id}`);if(e.ok){const t=await e.json();C(t)}}catch(e){}},[oe.id]),me=I.useCallback(e=>{C(e)},[]),ue=e=>{if(!e)return"Não definido";switch(e){case"A":return"Pronto para o Batismo";case"B":return"Detalhes Pessoais (Decidido ao Batismo)";case"C":return"Estudando a Bíblia";case"D":return"Quer Estudar a Bíblia";case"E":return"Contato Inicial";default:return"Não definido"}},xe=async e=>{const t="none"===e?null:e;if(t!==oe.interestedSituation){k(!0);try{if(!(await fetch(`/api/users/${oe.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({interestedSituation:t})})).ok)throw new Error("Erro ao atualizar situação");ne(e=>({...e,interestedSituation:t})),window.dispatchEvent(new CustomEvent("user-updated",{detail:{userId:oe.id,type:"situation-changed",situation:t}})),A({title:"✅ Situação atualizada",description:`Situação de ${oe.name} alterada para "${t?ue(t):"Não definida"}"`})}catch(s){A({title:"❌ Erro ao atualizar situação",description:"Não foi possível atualizar a situação. Tente novamente.",variant:"destructive"})}finally{k(!1)}}},he=e=>{switch(e){case 1:return{emoji:"🍃",label:"Distante",color:"bg-red-100 text-red-800"};case 2:return{emoji:"🔍",label:"Buscando",color:"bg-orange-100 text-orange-800"};case 3:return{emoji:"🌱",label:"Enraizando",color:"bg-yellow-100 text-yellow-800"};case 4:return{emoji:"🍃",label:"Frutificando",color:"bg-blue-100 text-blue-800"};case 5:return{emoji:"✨",label:"Intimidade",color:"bg-green-100 text-green-800"};default:return null}},pe="pending"===oe.status?{level:"high",label:"Pendente",color:"border-yellow-500 bg-yellow-50"}:(oe.points||0)<300?{level:"high",label:"Abaixo do Monte Sinai",color:"border-orange-500 bg-orange-50"}:(oe.attendance||0)<50?{level:"medium",label:"Baixa Frequência",color:"border-blue-500 bg-blue-50"}:oe.isApproved?{level:"low",label:"Normal",color:"border-green-500 bg-green-50"}:{level:"medium",label:"Não Aprovado",color:"border-purple-500 bg-purple-50"},ge=()=>{if(j)return!0;try{if(oe.extraData){let e;e="string"==typeof oe.extraData?JSON.parse(oe.extraData):oe.extraData;return!0===e.visited}return!1}catch(e){return!1}},fe=()=>{try{if(oe.extraData){let e;e="string"==typeof oe.extraData?JSON.parse(oe.extraData):oe.extraData;return e.visitCount||0}return 0}catch(e){return 0}},ve=()=>{try{if(oe.extraData){let e;return e="string"==typeof oe.extraData?JSON.parse(oe.extraData):oe.extraData,e.lastVisitDate}return null}catch{return null}},je=e=>{if(!e)return"";try{let t;return t=e.includes("T")||e.includes("Z")?new Date(e):new Date(e+"T00:00:00-03:00"),isNaN(t.getTime())?"Data inválida":t.toLocaleDateString("pt-BR")}catch(t){return"Data inválida"}},be=async()=>{try{const e=await fetch(`/api/visits/user/${oe.id}/reset`,{method:"DELETE"});if(!e.ok){await e.json();throw new Error("Erro ao zerar visitas")}await e.json();b(!1),ne(e=>({...e,extraData:{..."string"==typeof e.extraData?JSON.parse(e.extraData):e.extraData||{},visited:!1,visitCount:0,lastVisitDate:null}})),A({title:"🔄 Contador de visitas zerado",description:`Todas as visitas de ${oe.name} foram removidas.`})}catch(e){A({title:"❌ Erro ao zerar visitas",description:"Não foi possível zerar o contador. Tente novamente.",variant:"destructive"})}},Ne=e=>{if(!e)return!1;const t=e.replace(/\D/g,"");return t.length>=10&&t.length<=11},Fe=()=>{if(ge()||j)g(!0);else{const t=(()=>{const e=new Date((new Date).toLocaleString("en-US",{timeZone:"America/Sao_Paulo"}));return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`})();b(!0);const s=fe(),a={..."string"==typeof oe.extraData?JSON.parse(oe.extraData):oe.extraData||{},visited:!0,lastVisitDate:t,visitCount:s+1};ne(e=>({...e,extraData:a})),A({title:"✅ Visita realizada registrada!",description:`Primeira visita para ${oe.name} foi marcada como realizada. Visitômetro atualizado.`});try{c?.(oe.id,!0,t)}catch(e){b(!1),ne(e=>({...e,extraData:{..."string"==typeof oe.extraData?JSON.parse(oe.extraData):oe.extraData||{},visited:!1,visitCount:s}})),A({title:"❌ Erro ao marcar visita",description:"Não foi possível marcar a visita. Tente novamente.",variant:"destructive"})}}};return n.jsxs(W,{className:`transition-all duration-200 border-l-4 ${pe.color} ${ge()?"border-green-200 bg-green-50/30":""}`,"data-testid":`card-user-${oe.id}`,children:[n.jsx(Y,{className:"p-4",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[n.jsxs("div",{className:"relative "+("admin"===z?.role&&le()?"cursor-zoom-in":""),onClick:e=>{"admin"===z?.role&&le()&&(e.stopPropagation(),O(!0))},title:"admin"===z?.role&&le()?"Ver foto":void 0,role:"admin"===z?.role&&le()?"button":void 0,children:[n.jsxs(ye,{className:"h-12 w-12",children:[n.jsx(we,{src:le(),className:"h-full w-full object-cover"}),n.jsx(Ce,{className:"bg-primary text-primary-foreground",children:oe.name?.charAt(0)||"U"})]}),(()=>{try{if(oe.extraData){let e;return e="string"==typeof oe.extraData?JSON.parse(oe.extraData):oe.extraData,!0===e.phoneWarning}return!1}catch{return!1}})()&&n.jsx("div",{className:"absolute -top-1 -right-1 bg-yellow-500 rounded-full p-1",title:"Telefone inválido durante importação",children:n.jsx(Te,{className:"h-3 w-3 text-white"})})]}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"font-medium text-foreground truncate","data-testid":`text-username-${oe.id}`,children:oe.name}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx($,{className:(e=>{switch(e){case"admin":return"bg-red-500 text-white";case"missionary":return"bg-blue-500 text-white";case"member":return"bg-green-500 text-white";case"interested":return"bg-yellow-500 text-white";default:return"bg-gray-500 text-white"}})(oe.role),"data-testid":`badge-role-${oe.id}`,children:(e=>{switch(e){case"admin":return"Administrador";case"missionary":return"Missionário";case"member":return"Membro";case"interested":return"Interessado";default:return"Desconhecido"}})(oe.role)}),"member"===oe.role&&!(!h||!oe)&&h.some(e=>e.missionaryId===oe.id&&"active"===e.status)&&n.jsx($,{className:"bg-blue-500 text-white","data-testid":`badge-missionary-${oe.id}`,children:"Missionário"})]}),"pending"===oe.status&&n.jsx($,{variant:"secondary",className:`${(e=>{switch(e){case"approved":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"rejected":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}})(oe.status)} cursor-pointer hover:opacity-80 transition-opacity`,"data-testid":`badge-status-${oe.id}`,onClick:e=>{e.stopPropagation(),s?.()},title:"Clique para aprovar",children:(e=>{switch(e){case"approved":return"Aprovado";case"pending":return"Pendente";case"rejected":return"Rejeitado";default:return"Desconhecido"}})(oe.status)}),"interested"===oe.role&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(hs,{open:S,children:[n.jsx(ps,{asChild:!0,children:n.jsxs(B,{variant:"ghost",role:"combobox",className:"h-6 w-auto min-w-[140px] text-xs border-0 bg-transparent p-0 hover:bg-transparent",disabled:D,onClick:e=>{e.stopPropagation(),E(!S)},children:[oe.interestedSituation?ue(oe.interestedSituation):"Selecionar situação",n.jsx(Qe,{className:"ml-2 h-3 w-3 shrink-0 opacity-50"})]})}),n.jsxs(gs,{className:"w-64 p-0 z-50",side:"bottom",align:"start",children:[n.jsxs("div",{className:"flex justify-between items-center p-2 border-b",children:[n.jsx("span",{className:"text-sm font-medium",children:"Selecionar Situação"}),n.jsx(B,{variant:"ghost",size:"sm",onClick:()=>E(!1),className:"h-6 w-6 p-0",children:"✕"})]}),n.jsxs(qt,{children:[n.jsx($t,{placeholder:"Digite para buscar situação..."}),n.jsxs(Vt,{children:[n.jsx(_t,{children:"Nenhuma situação encontrada."}),n.jsxs(Bt,{children:[n.jsxs(Lt,{value:"none",onSelect:()=>{xe("none"),E(!1)},children:[n.jsx(K,{className:M("mr-2 h-4 w-4",oe.interestedSituation?"opacity-0":"opacity-100")}),"Selecionar situação"]}),n.jsxs(Lt,{value:"A",onSelect:()=>{xe("A"),E(!1)},children:[n.jsx(K,{className:M("mr-2 h-4 w-4","A"===oe.interestedSituation?"opacity-100":"opacity-0")}),"A - Pronto para o Batismo"]}),n.jsxs(Lt,{value:"B",onSelect:()=>{xe("B"),E(!1)},children:[n.jsx(K,{className:M("mr-2 h-4 w-4","B"===oe.interestedSituation?"opacity-100":"opacity-0")}),"B - Detalhes Pessoais (Decidido ao Batismo)"]}),n.jsxs(Lt,{value:"C",onSelect:()=>{xe("C"),E(!1)},children:[n.jsx(K,{className:M("mr-2 h-4 w-4","C"===oe.interestedSituation?"opacity-100":"opacity-0")}),"C - Estudando a Bíblia"]}),n.jsxs(Lt,{value:"D",onSelect:()=>{xe("D"),E(!1)},children:[n.jsx(K,{className:M("mr-2 h-4 w-4","D"===oe.interestedSituation?"opacity-100":"opacity-0")}),"D - Quer Estudar a Bíblia"]}),n.jsxs(Lt,{value:"E",onSelect:()=>{xe("E"),E(!1)},children:[n.jsx(K,{className:M("mr-2 h-4 w-4","E"===oe.interestedSituation?"opacity-100":"opacity-0")}),"E - Contato Inicial"]})]})]})]})]})]}),n.jsx($,{className:`${(e=>{if(!e)return"bg-gray-100 text-gray-800";switch(e){case"A":return"bg-green-100 text-green-800";case"B":return"bg-blue-100 text-blue-800";case"C":return"bg-purple-100 text-purple-800";case"D":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}})(oe.interestedSituation)} text-xs px-2 py-0`,title:ue(oe.interestedSituation),children:oe.interestedSituation||"Não definida"})]}),"admin"===z?.role&&oe.hasPendingDiscipleRequest&&n.jsxs($,{className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-200 cursor-pointer",onClick:e=>{e.stopPropagation(),u?.()},title:"Clique para autorizar discipulado",children:[n.jsx(Re,{className:"h-3 w-3 mr-1"}),"Autorizar"]})]}),n.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(G,{className:"h-3 w-3"}),n.jsx("span",{className:"truncate","data-testid":`text-first-access-${oe.id}`,children:n.jsx("strong",{children:(e=>{if(!e)return"";const t=e.trim().split(" ");if(1===t.length)return t[0].toLowerCase();return`${t[0].toLowerCase()}.${t[t.length-1].toLowerCase()}`})(oe.name)})})]}),"interested"===oe.role&&n.jsx("div",{className:"mt-2",children:n.jsx(vs,{interestedId:oe.id,currentDiscipuladores:w,potentialMissionaries:N,onDiscipuladoresChange:me})}),oe.phone&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(H,{className:"h-3 w-3"}),n.jsx("span",{"data-testid":`text-phone-${oe.id}`,children:oe.phone})]}),oe.church&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(qe,{className:"h-3 w-3"}),n.jsx("span",{className:"truncate","data-testid":`text-church-${oe.id}`,children:oe.church})]}),oe.address&&n.jsxs("div",{className:"flex items-start gap-1",children:[n.jsx(qe,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),n.jsx("div",{className:"flex-1 min-w-0",children:n.jsx("div",{className:"text-sm text-muted-foreground break-words","data-testid":`text-address-${oe.id}`,children:oe.address})})]}),void 0!==oe.points&&n.jsxs("div",{className:"flex items-center gap-2 mt-2 pt-2 border-t border-gray-100",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Z,{className:"h-3 w-3 text-yellow-500"}),n.jsxs("span",{className:"text-xs font-medium",children:[oe.points||0," pts"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(De,{iconType:ke(oe.points||0),className:"h-3 w-3"}),n.jsx("span",{className:"text-xs font-medium",title:Ee(oe.points||0),children:Se(oe.points||0)})]})]}),"admin"===z?.role&&n.jsxs("div",{className:"flex items-center gap-2 mt-2 pt-2 border-t border-gray-100",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(X,{className:"h-3 w-3 text-pink-500"}),n.jsx("span",{className:"text-xs font-medium",children:"Check-in Espiritual:"})]}),F?n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"text-lg",children:he(F.emotionalScore)?.emoji}),n.jsx($,{className:`${he(F.emotionalScore)?.color} text-xs px-2 py-0`,children:he(F.emotionalScore)?.label}),F.prayerRequest&&n.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[n.jsx(ee,{className:"h-3 w-3 text-blue-500"}),n.jsx("span",{className:"text-xs text-blue-600",children:"Pedido de oração"})]})]}):n.jsx($,{className:"bg-gray-100 text-gray-600 text-xs px-2 py-0",children:"Não realizado"})]})]}),ge()&&n.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs",children:[n.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[n.jsx(L,{className:"h-3 w-3"}),n.jsx("span",{children:"Visitado"})]}),fe()>1&&n.jsxs($,{variant:"secondary",className:"text-xs px-1 py-0 bg-green-100 text-green-700",children:[fe()," visitas"]}),ve()&&n.jsxs("span",{className:"text-muted-foreground",children:["Última: ",je(ve())]})]})]})]}),x&&n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-1",onClick:e=>e.stopPropagation(),children:[n.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[n.jsx(B,{size:"sm",variant:"ghost",disabled:f,className:`h-8 w-8 p-0 transition-all duration-200 ${ge()?"text-green-600 hover:text-green-700 bg-green-50 hover:bg-green-100 border border-green-200":"text-blue-600 hover:text-blue-700"} ${f?"opacity-50 cursor-not-allowed":""}`,onClick:e=>{e.stopPropagation(),(()=>{const e=Date.now();e-re<500?be():Fe(),ie(e)})()},title:ge()?"🖱️ Clique: nova visita | ⚡ Duplo clique: zerar contador":"Marcar visita como realizada",children:f?n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):ge()?n.jsx(Ye,{className:"h-4 w-4"}):n.jsx(He,{className:"h-4 w-4"})}),fe()>1&&n.jsxs($,{variant:"secondary",className:"text-xs px-1 py-0 bg-green-100 text-green-700 border border-green-200 cursor-pointer hover:bg-green-200 transition-colors",onClick:e=>{e.stopPropagation(),(async e=>{try{const t=await fetch(`/api/visits/user/${e}`);if(t.ok){const e=await t.json();ae(e)}else ae([])}catch(t){ae([])}})(oe.id),Q(!0)},title:"Clique para ver histórico de visitas",children:[fe(),"x"]}),n.jsx(B,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-green-600 hover:text-green-700",onClick:e=>{e.stopPropagation(),o?.()},title:"Visualizar detalhes",children:n.jsx(te,{className:"h-4 w-4"})})]}),n.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[n.jsx(B,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-purple-600 hover:text-purple-700",onClick:e=>{e.stopPropagation(),l?.()},title:"Agendar visita futura",children:n.jsx(R,{className:"h-4 w-4"})}),Ne(oe.phone)&&n.jsx(B,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-green-600 hover:text-green-700",onClick:e=>{e.stopPropagation(),(()=>{if(Ne(oe.phone)){const e=oe.phone.replace(/\D/g,""),t=`Olá ${oe.name}! Como você está?`,s=`https://wa.me/55${e}?text=${encodeURIComponent(t)}`;window.open(s,"_blank")}})()},title:"Enviar WhatsApp",children:n.jsx(ee,{className:"h-4 w-4"})}),n.jsx(B,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",onClick:e=>{e.stopPropagation(),i?.()},title:"Excluir usuário",children:n.jsx($e,{className:"h-4 w-4"})})]})]})]})}),n.jsx(fs,{isOpen:p,onClose:()=>g(!1),onConfirm:async e=>{v(!0);try{await(c?.(oe.id,!0,e)),g(!1),b(!0);const t=fe(),s={..."string"==typeof oe.extraData?JSON.parse(oe.extraData):oe.extraData||{},visited:!0,lastVisitDate:e,visitCount:t+1};ne(e=>({...e,extraData:s}));const a=0===t?"primeira visita":"nova visita";A({title:"✅ Visita realizada registrada!",description:`${a.charAt(0).toUpperCase()+a.slice(1)} para ${oe.name} foi marcada como realizada em ${je(e)}. Visitômetro atualizado.`})}catch(t){b(!1),A({title:"❌ Erro ao marcar visita",description:"Não foi possível marcar a visita. Tente novamente.",variant:"destructive"})}finally{v(!1)}},userName:oe.name,isLoading:f,visitCount:fe(),lastVisitDate:ve()}),n.jsx(Ae,{open:P,onOpenChange:O,children:n.jsxs(ze,{className:"sm:max-w-xl",children:[n.jsxs(Pe,{children:[n.jsxs(Ie,{children:["Foto de ",oe.name]}),n.jsx(Oe,{children:"Visualização ampliada da foto de perfil."})]}),le()?n.jsx("img",{src:le(),alt:`Foto de ${oe.name}`,className:"w-full h-auto max-h-[80vh] object-contain rounded-md"}):n.jsx("div",{className:"text-sm text-muted-foreground",children:"Este usuário ainda não possui foto de perfil."})]})}),n.jsx(Ae,{open:_,onOpenChange:Q,children:n.jsxs(ze,{className:"sm:max-w-md",children:[n.jsxs(Pe,{children:[n.jsxs(Ie,{className:"flex items-center gap-2",children:[n.jsx(R,{className:"h-5 w-5 text-blue-600"}),"Histórico de Visitas - ",oe.name]}),n.jsx(Oe,{children:"Todas as visitas realizadas para este usuário."})]}),n.jsxs("div",{className:"space-y-4",children:[se.length>0?n.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:se.map((e,t)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),n.jsxs("span",{className:"text-sm font-medium",children:["Visita #",se.length-t]})]}),n.jsx("div",{className:"text-sm text-muted-foreground",children:je(e.visit_date)})]},e.id||t))}):n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(R,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhuma visita registrada"})]}),n.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[n.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total: ",se.length," visita",1!==se.length?"s":""]}),n.jsx(B,{variant:"outline",onClick:()=>Q(!1),children:"Fechar"})]})]})]})})]})},bs=({user:e,isOpen:t,onClose:s,onUpdate:a})=>{const[r,i]=I.useState({}),[o,l]=I.useState({}),[d,c]=I.useState(!1);if(!e)return null;const m=(e,t)=>{i(t=>({...t,[e]:!0})),l(s=>({...s,[e]:t}))},u=(t,s,u,x="text",h)=>{const p=r[t],g=p?o[t]:u;return p?n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-sm font-medium",children:s}),n.jsxs("div",{className:"flex gap-2",children:["textarea"===x?n.jsx(Ve,{value:g||"",onChange:e=>l(s=>({...s,[t]:e.target.value})),className:"flex-1",rows:3}):"select"===x?n.jsxs(re,{value:g||"",onValueChange:e=>l(s=>({...s,[t]:e})),children:[n.jsx(ie,{className:"flex-1",children:n.jsx(oe,{placeholder:"Selecione..."})}),n.jsx(ne,{children:h?.map(e=>n.jsx(le,{value:e,children:e},e))})]}):n.jsx(_,{value:g||"",onChange:e=>l(s=>({...s,[t]:e.target.value})),className:"flex-1"}),n.jsx(B,{size:"sm",variant:"ghost",onClick:()=>(async t=>{const s=o[t];c(!0);try{await a(e.id,{[t]:s}),i(e=>({...e,[t]:!1})),l(e=>{const s={...e};return delete s[t],s})}catch(r){}finally{c(!1)}})(t),disabled:d,className:"h-8 w-8 p-0 text-green-600 hover:text-green-700",children:n.jsx(K,{className:"h-4 w-4"})}),n.jsx(B,{size:"sm",variant:"ghost",onClick:()=>(e=>{i(t=>({...t,[e]:!1})),l(t=>{const s={...t};return delete s[e],s})})(t),disabled:d,className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:n.jsx(Q,{className:"h-4 w-4"})})]})]}):n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"text-sm font-medium",children:s}),n.jsx(B,{size:"sm",variant:"ghost",onClick:()=>m(t,u),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700",children:n.jsx(Ge,{className:"h-3 w-3"})})]}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u||"Não informado"})]})},x=e=>{if(!e)return null;try{const t=e.toString().trim().replace(/['"]/g,"");if(!isNaN(e)&&"number"==typeof e){const t=new Date(1900,0,1),s=e-2,a=new Date(t.getTime()+24*s*60*60*1e3);if(!isNaN(a.getTime())&&a.getFullYear()>1900)return a}if(t.includes("/")){const e=t.split("/");if(3===e.length){const[t,s,a]=e,r=parseInt(t),i=parseInt(s);let o=parseInt(a);if(o<100&&(o+=o<50?2e3:1900),r>=1&&r<=31&&i>=1&&i<=12&&o>=1900&&o<=2100){const e=new Date(o,i-1,r);if(e.getDate()===r&&e.getMonth()===i-1&&e.getFullYear()===o)return e}}}if(t.includes("-")&&t.match(/^\d{1,2}-\d{1,2}-\d{4}$/)){const e=t.split("-"),[s,a,r]=e,i=parseInt(s),o=parseInt(a),n=parseInt(r);if(i>=1&&i<=31&&o>=1&&o<=12&&n>=1900&&n<=2100){const e=new Date(n,o-1,i);if(e.getDate()===i&&e.getMonth()===o-1&&e.getFullYear()===n)return e}}if(t.match(/^\d{4}-\d{2}-\d{2}$/)){const e=new Date(t);if(!isNaN(e.getTime())&&e.getFullYear()>1900)return e}if(t.match(/^\d{4}\/\d{2}\/\d{2}$/)){const e=t.split("/"),[s,a,r]=e,i=parseInt(s),o=parseInt(a),n=parseInt(r);if(i>=1900&&i<=2100&&o>=1&&o<=12&&n>=1&&n<=31){const e=new Date(i,o-1,n);if(e.getDate()===n&&e.getMonth()===o-1&&e.getFullYear()===i)return e}}if(t.includes(".")&&t.match(/^\d{1,2}\.\d{1,2}\.\d{4}$/)){const e=t.split("."),[s,a,r]=e,i=parseInt(s),o=parseInt(a),n=parseInt(r);if(i>=1&&i<=31&&o>=1&&o<=12&&n>=1900&&n<=2100){const e=new Date(n,o-1,i);if(e.getDate()===i&&e.getMonth()===o-1&&e.getFullYear()===n)return e}}if(t.includes(".")&&t.match(/^\d{1,2}\.\d{1,2}\.\d{2}$/)){const e=t.split("."),[s,a,r]=e,i=parseInt(s),o=parseInt(a);let n=parseInt(r);if(n+=n<50?2e3:1900,i>=1&&i<=31&&o>=1&&o<=12&&n>=1900&&n<=2100){const e=new Date(n,o-1,i);if(e.getDate()===i&&e.getMonth()===o-1&&e.getFullYear()===n)return e}}if(t.includes("-")&&t.includes("/")){const e=t.match(/^(\d{1,2}\/\d{1,2})-\d{1,2}\/\d{1,2}\/(\d{4})$/);if(e){const t=e[1]+"/"+e[2];return x(t)}}if(t.includes("-")&&t.includes("/")&&!t.match(/\d{4}/)){const e=t.match(/^(\d{1,2}\/\d{1,2})-\d{1,2}\/\d{1,2}$/);if(e){const t=(new Date).getFullYear(),s=e[1]+"/"+t;return x(s)}}if(t.match(/^\d{1,2}\/\d{1,2}$/)){const e=(new Date).getFullYear();return x(t+"/"+e)}const s=new Date(e);return!isNaN(s.getTime())&&s.getFullYear()>1900?s:null}catch(t){return null}},h=e=>{if(!e)return"Não informado";const t=x(e);return t?Math.floor(((new Date).getTime()-t.getTime())/315576e5)+" anos":"Não informado"},p=e=>{if(!e)return"Não informado";const t=x(e);return t?t.toLocaleDateString("pt-BR"):"Não informado"},g=(()=>{try{const t=e.extra_data||e.extraData;return t&&"string"==typeof t?JSON.parse(t):t&&"object"==typeof t?t:{}}catch(t){return{}}})(),f=e=>{switch(e){case"admin":return"Administrador";case"missionary":return"Missionário";case"member":return"Membro";case"interested":return"Interessado";default:return"Desconhecido"}},v=e=>{switch(e){case"single":return"Solteiro(a)";case"married":return"Casado(a)";case"divorced":return"Divorciado(a)";case"widowed":return"Viúvo(a)";default:return"Não informado"}},j=()=>e.departments?"string"==typeof e.departments?e.departments.split(",").map(e=>e.trim()).filter(e=>e):Array.isArray(e.departments)?e.departments:[]:[],b=()=>{try{if(e.extraData&&"string"==typeof e.extraData){const t=JSON.parse(e.extraData);return t.phoneWarning?{hasWarning:!0,originalPhone:t.originalPhone}:{hasWarning:!1}}return{hasWarning:!1}}catch{return{hasWarning:!1}}};return n.jsx(Ae,{open:t,onOpenChange:e=>!e&&s(),children:n.jsxs(ze,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[n.jsxs(Pe,{children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs(Ie,{className:"flex items-center gap-3",children:[n.jsxs(ye,{className:"h-12 w-12",children:[n.jsx(we,{src:e.profilePhoto}),n.jsx(Ce,{className:"bg-primary text-primary-foreground",children:e.name?.charAt(0)||"U"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xl font-bold",children:e.name}),n.jsx("div",{className:"text-sm text-muted-foreground",children:e.email})]}),n.jsx($,{variant:"outline",className:"ml-2",children:f(e.role)})]})}),n.jsx(Oe,{children:"Informações detalhadas do membro"})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs(W,{className:"shadow-divine",children:[n.jsx(se,{children:n.jsxs(ae,{className:"flex items-center gap-2",children:[n.jsx(G,{className:"h-5 w-5"}),"Informações Básicas"]})}),n.jsx(Y,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsx("div",{children:u("church","Igreja",e.church)}),n.jsx("div",{children:u("name","Nome",e.name)}),n.jsx("div",{children:u("church_code","Código",e.church_code||e.churchCode)}),n.jsxs("div",{children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsx("label",{className:"text-sm font-medium",children:"Tipo"})}),n.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:n.jsx($,{variant:"secondary",children:f(e.role)})})]}),n.jsx("div",{children:u("extraData.sexo","Sexo",g.sexo)}),n.jsxs("div",{children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsx("label",{className:"text-sm font-medium",children:"Idade"})}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.idade||(e=>{if(!e)return"Não informado";const t=x(e);return t?Math.floor(((new Date).getTime()-t.getTime())/315576e5)+" anos":"Não informado"})(e.birth_date||e.birthDate)})]}),n.jsxs("div",{children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsx("label",{className:"text-sm font-medium",children:"Nascimento"})}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:(e=>{if(!e)return"Não informado";const t=x(e);return t?t.toLocaleDateString("pt-BR"):"Não informado"})(e.birth_date||e.birthDate)})]}),n.jsx("div",{children:u("extraData.engajamento","Engajamento",g.engajamento)}),n.jsx("div",{children:u("extraData.classificacao","Classificação",g.classificacao)}),n.jsxs("div",{children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsx("label",{className:"text-sm font-medium",children:"Estado Civil"})}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:v(e.civil_status||e.civilStatus)})]}),n.jsxs("div",{children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsx("label",{className:"text-sm font-medium",children:"Ocupação"})}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.occupation||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsx("label",{className:"text-sm font-medium",children:"Educação"})}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.education||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsx("label",{className:"text-sm font-medium",children:"Status"})}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:n.jsx($,{variant:"approved"===e.status?"default":"secondary",children:"approved"===e.status?"Aprovado":"pending"===e.status?"Pendente":"Recusado"})})]})]})})]}),n.jsxs(W,{className:"shadow-divine",children:[n.jsx(se,{children:n.jsxs(ae,{className:"flex items-center gap-2",children:[n.jsx(_e,{className:"h-5 w-5"}),"Dízimos e Ofertas"]})}),n.jsx(Y,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Classificação"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.level||"Iniciante"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Dizimista"}),n.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:n.jsx($,{variant:e.is_donor||e.isDonor?"default":"secondary",children:g.dizimistaType||(e.is_donor||e.isDonor?"Sim":"Não")})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"É Dizimista (DB)"}),n.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:n.jsx($,{variant:e.is_tither||e.isTither?"default":"secondary",children:e.is_tither||e.isTither?"Sim":"Não"})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"É Doador"}),n.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:n.jsx($,{variant:e.is_donor||e.isDonor?"default":"secondary",children:e.is_donor||e.isDonor?"Sim":"Não"})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Dízimos - 12m"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.dizimos12m||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Último dízimo - 12m"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:p(g.ultimoDizimo)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Valor dízimo - 12m"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.valorDizimo||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Número de meses s/ dizimar"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.numeroMesesSemDizimar||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Dizimista antes do últ. dízimo"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.dizimistaAntesUltimoDizimo||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Ofertante"}),n.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:n.jsx($,{variant:e.isOffering?"default":"secondary",children:g.ofertanteType||(e.isOffering?"Sim":"Não")})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Ofertas - 12m"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.ofertas12m||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Última oferta - 12m"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:p(g.ultimaOferta)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Valor oferta - 12m"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.valorOferta||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Número de meses s/ ofertar"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.numeroMesesSemOfertar||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Ofertante antes da últ. oferta"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.ofertanteAntesUltimaOferta||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Último movimento"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.ultimoMovimento||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Data do último movimento"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:p(g.dataUltimoMovimento)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Tipo de entrada"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.tipoEntrada||"Não informado"})]})]})})]}),n.jsxs(W,{className:"shadow-divine",children:[n.jsx(se,{children:n.jsxs(ae,{className:"flex items-center gap-2",children:[n.jsx(X,{className:"h-5 w-5"}),"Batismo e Vida Espiritual"]})}),n.jsx(Y,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Tempo de batismo"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:h(e.baptism_date||e.baptismDate)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Batismo"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:p(e.baptism_date||e.baptismDate)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Tempo de batismo"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.tempoBatismo||h(e.baptism_date||e.baptismDate)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Localidade do batismo"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.localidadeBatismo||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Batizado por"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.batizadoPor||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Idade no Batismo"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.idadeBatismo||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Tempo de batismo - anos"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:h(e.baptism_date||e.baptismDate)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Religião anterior"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.previousReligion||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Como conheceu a IASD"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.comoConheceu||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Fator decisivo"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.fatorDecisivo||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Como estudou a Bíblia"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.comoEstudou||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Tipo de Entrada"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.tipoEntrada||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Instrutor bíblico"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.biblicalInstructor||g.instrutorBiblico||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Instrutor bíblico 2"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.instrutorBiblico2||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Tem cargo"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.temCargo||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Teen"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.teen||"Não informado"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"text-sm font-medium",children:"Departamentos e cargos"}),n.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:j().length>0?j().map((e,t)=>n.jsx($,{variant:"secondary","data-testid":`badge-department-${t}`,children:e},t)):n.jsx("span",{className:"text-sm text-muted-foreground",children:"Nenhum departamento"})})]})]})})]}),n.jsxs(W,{className:"shadow-divine",children:[n.jsx(se,{children:n.jsxs(ae,{className:"flex items-center gap-2",children:[n.jsx(q,{className:"h-5 w-5"}),"Informações Familiares"]})}),n.jsx(Y,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Nome da mãe"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.nomeMae||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Nome do pai"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.nomePai||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Estado civil"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:v(e.civilStatus)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Data de casamento"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:p(g.dataCasamento)})]})]})})]}),n.jsxs(W,{className:"shadow-divine",children:[n.jsx(se,{children:n.jsxs(ae,{className:"flex items-center gap-2",children:[n.jsx(We,{className:"h-5 w-5"}),"Educação e Profissão"]})}),n.jsx(Y,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Grau de educação"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.education||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Ocupação"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.occupation||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Endereço Completo"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.address||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Religião Anterior"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.previous_religion||e.previousReligion||("Família/parentes"===g.comoConheceu?"Nenhuma":"Não informado")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Instrutor Bíblico"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.biblical_instructor||e.biblicalInstructor||g.batizadoPor||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Primeiro Acesso"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:n.jsx($,{variant:e.first_access||e.firstAccess?"default":"secondary",children:e.first_access||e.firstAccess?"Sim":"Não"})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Aluno educação Adv."}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.alunoEducacao||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Parentesco p/ c/ aluno"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.parentesco||"Não informado"})]})]})})]}),n.jsxs(W,{className:"shadow-divine",children:[n.jsx(se,{children:n.jsxs(ae,{className:"flex items-center gap-2",children:[n.jsx(H,{className:"h-5 w-5"}),"Contato e Endereço"]})}),n.jsx(Y,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:["Celular",b().hasWarning&&n.jsx(Te,{className:"h-4 w-4 text-yellow-500"})]}),n.jsx(B,{size:"sm",variant:"ghost",onClick:()=>m("phone",e.phone),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700",children:n.jsx(Ge,{className:"h-3 w-3"})})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.phone||"Não informado"}),b().hasWarning&&n.jsxs("div",{className:"flex items-center gap-2 mt-1 p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded-md",children:[n.jsx(Te,{className:"h-4 w-4 text-yellow-600"}),n.jsxs("div",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:[n.jsx("strong",{children:"Telefone original:"})," ",b().originalPhone,n.jsx("br",{}),n.jsx("span",{className:"text-muted-foreground",children:"Telefone muito curto durante a importação"})]})]})]})]}),n.jsx("div",{children:u("email","Email",e.email)}),n.jsx("div",{children:u("extraData.cidadeEstado","Cidade e Estado",g.cidadeEstado)}),n.jsx("div",{children:u("extraData.bairro","Bairro",g.bairro)}),n.jsx("div",{className:"md:col-span-2",children:u("address","Endereço",e.address,"textarea")}),n.jsx("div",{children:u("extraData.cidadeNascimento","Cidade de nascimento",g.cidadeNascimento)}),n.jsx("div",{children:u("extraData.estadoNascimento","Estado de nascimento",g.estadoNascimento)}),n.jsx("div",{children:u("cpf","CPF",e.cpf)}),n.jsxs("div",{children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsx("label",{className:"text-sm font-medium",children:"CPF válido"})}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.cpfValido||"Não informado"})]})]})})]}),n.jsxs(W,{className:"shadow-divine",children:[n.jsx(se,{children:n.jsxs(ae,{className:"flex items-center gap-2",children:[n.jsx(Z,{className:"h-5 w-5"}),"Escola Sabatina"]})}),n.jsx(Y,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Nome da unidade"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.nomeUnidade||g.cidadeEstado||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Matriculado na ES"}),n.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:n.jsx($,{variant:e.isEnrolledES?"default":"secondary",children:e.isEnrolledES?"Sim":"Não"})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Tem lição"}),n.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:n.jsx($,{variant:e.hasLesson?"default":"secondary",children:e.hasLesson?"Sim":"Não"})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Período ES"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.esPeriod||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Comunhão"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.comunhao||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Missão"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.missao||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Estudo bíblico"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.estudoBiblico||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Batizou alguém"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.batizouAlguem||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Disc. pós batismal"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.discPosBatismal||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Total presença no cartão"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.presencaTotal||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Presença no quiz local"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.presencaQuizLocal||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Presença no quiz outra unidade"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.presencaQuizOutraUnidade||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Presença no quiz online"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.presencaQuizOnline||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Total de presença"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.attendance||g.totalPresenca||g.dizimos12m||0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Teve participação"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.teveParticipacao||"Não informado"})]})]})})]}),n.jsxs(W,{className:"shadow-divine",children:[n.jsx(se,{children:n.jsxs(ae,{className:"flex items-center gap-2",children:[n.jsx(Ke,{className:"h-5 w-5"}),"Colaboração e Outros"]})}),n.jsx(Y,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Campo - colaborador"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.campoColaborador||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Área - colaborador"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.areaColaborador||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Estabelecimento - colaborador"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.estabelecimentoColaborador||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Função - colaborador"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.funcaoColaborador||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Campos vazios/inválidos"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.camposVazios||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Nome dos campos vazios no ACMS"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.nomeCamposVazios||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Pontos"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.points||0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Nível"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.level||"Iniciante"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Frequência"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.attendance||0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Pontuação"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.points||0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Código (extra)"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.codigo||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Bairro"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.bairro||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Cidade/Estado"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.cidadeEstado||"Não informado"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Valor Dízimo"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.valorDizimo?`R$ ${g.valorDizimo}`:"Não informado"})]})]})})]}),e.observations&&n.jsxs(W,{className:"shadow-divine",children:[n.jsx(se,{children:n.jsxs(ae,{className:"flex items-center gap-2",children:[n.jsx(Te,{className:"h-5 w-5"}),"Observações"]})}),n.jsx(Y,{children:n.jsx("p",{className:"text-sm text-muted-foreground",children:e.observations})})]})]}),n.jsx("div",{className:"flex justify-end gap-2 mt-6",children:n.jsxs(B,{variant:"outline",onClick:s,"data-testid":"button-close",children:[n.jsx(Q,{className:"h-4 w-4 mr-2"}),"Fechar"]})})]})})},Ns=({user:e,isOpen:t,onClose:s,onUpdate:a})=>{const{toast:r}=U(),i=de(),[o,l]=I.useState({name:e?.name||"",email:e?.email||"",phone:e?.phone||"",role:e?.role||"interested",status:e?.status||"pending",church:e?.church||"",birthDate:e?.birthDate?new Date(e.birthDate).toISOString().split("T")[0]:"",civilStatus:e?.civilStatus||"",occupation:e?.occupation||"",education:e?.education||"",address:e?.address||"",observations:e?.observations||""}),d=je({mutationFn:({userId:e,data:t})=>fetch(`/api/users/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(e=>e.json()),onSuccess:()=>{i.invalidateQueries({queryKey:["/api/users"]}),window.dispatchEvent(new CustomEvent("user-updated")),r({title:"Usuário atualizado",description:"As informações do usuário foram atualizadas com sucesso."}),s()},onError:()=>{r({title:"Erro",description:"Erro ao atualizar usuário. Tente novamente.",variant:"destructive"})}}),c=(e,t)=>{l(s=>({...s,[e]:t}))};return e?n.jsx(Ae,{open:t,onOpenChange:e=>!e&&s(),children:n.jsxs(ze,{className:"max-w-2xl max-h-[90vh] overflow-y-auto","aria-describedby":"edit-user-modal-description",children:[n.jsx("div",{id:"edit-user-modal-description",className:"sr-only",children:"Formulário para editar informações do usuário"}),n.jsx(Pe,{children:n.jsxs(Ie,{children:["Editar Usuário - ",e.name]})}),n.jsxs("form",{onSubmit:t=>{t.preventDefault(),e?.id&&d.mutate({userId:e.id,data:o})},className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"name",children:"Nome Completo *"}),n.jsx(_,{id:"name",value:o.name,onChange:e=>c("name",e.target.value),required:!0})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"email",children:"Email *"}),n.jsx(_,{id:"email",type:"email",value:o.email,onChange:e=>c("email",e.target.value),required:!0})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"phone",children:"Telefone"}),n.jsx(_,{id:"phone",value:o.phone,onChange:e=>c("phone",e.target.value),placeholder:"(11) 99999-9999"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"birthDate",children:"Data de Nascimento"}),n.jsx(_,{id:"birthDate",type:"date",value:o.birthDate,onChange:e=>c("birthDate",e.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"role",children:"Função"}),n.jsxs(re,{value:o.role,onValueChange:e=>c("role",e),children:[n.jsx(ie,{children:n.jsx(oe,{})}),n.jsxs(ne,{children:[n.jsx(le,{value:"admin",children:"Administrador"}),n.jsx(le,{value:"missionary",children:"Missionário"}),n.jsx(le,{value:"member",children:"Membro"}),n.jsx(le,{value:"interested",children:"Interessado"})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"status",children:"Status"}),n.jsxs(re,{value:o.status,onValueChange:e=>c("status",e),children:[n.jsx(ie,{children:n.jsx(oe,{})}),n.jsxs(ne,{children:[n.jsx(le,{value:"approved",children:"Aprovado"}),n.jsx(le,{value:"pending",children:"Pendente"}),n.jsx(le,{value:"rejected",children:"Rejeitado"})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"church",children:"Igreja"}),n.jsx(_,{id:"church",value:o.church,onChange:e=>c("church",e.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"civilStatus",children:"Estado Civil"}),n.jsxs(re,{value:o.civilStatus,onValueChange:e=>c("civilStatus",e),children:[n.jsx(ie,{children:n.jsx(oe,{})}),n.jsxs(ne,{children:[n.jsx(le,{value:"single",children:"Solteiro(a)"}),n.jsx(le,{value:"married",children:"Casado(a)"}),n.jsx(le,{value:"divorced",children:"Divorciado(a)"}),n.jsx(le,{value:"widowed",children:"Viúvo(a)"})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"occupation",children:"Profissão"}),n.jsx(_,{id:"occupation",value:o.occupation,onChange:e=>c("occupation",e.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"education",children:"Escolaridade"}),n.jsx(_,{id:"education",value:o.education,onChange:e=>c("education",e.target.value)})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"address",children:"Endereço"}),n.jsx(Ve,{id:"address",value:o.address,onChange:e=>c("address",e.target.value),placeholder:"Rua, número, bairro, cidade, estado",rows:3})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"observations",children:"Observações"}),n.jsx(Ve,{id:"observations",value:o.observations,onChange:e=>c("observations",e.target.value),placeholder:"Observações sobre o usuário...",rows:3})]}),n.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[n.jsx(B,{type:"button",variant:"outline",onClick:s,children:"Cancelar"}),n.jsx(B,{type:"submit",disabled:d.isPending,children:d.isPending?"Salvando...":"Salvar Alterações"})]})]})]})}):null},ys=({user:e,isOpen:t,onClose:s})=>{const{toast:a}=U(),r=de(),[i,o]=I.useState({title:`Visita - ${e?.name||"Usuário"}`,description:"",scheduledAt:"",scheduledTime:"",notes:""}),l=je({mutationFn:async t=>{const s=await fetch("/api/calendar/events",{method:"POST",body:JSON.stringify({events:[{title:`Visita - ${e?.name}`,description:t.notes||`Visita agendada para ${e?.name}`,startDate:t.scheduledAt+"T"+t.scheduledTime,endDate:t.scheduledAt+"T"+t.scheduledTime,category:"Visitas",location:e?.address||"",maxAttendees:2}]}),headers:{"Content-Type":"application/json"}}),a=await s.json();if(!s.ok)throw new Error(a.error||"Erro ao criar evento no calendário");try{const e=await fetch("/api/google-drive/process-pending",{method:"POST",headers:{"Content-Type":"application/json"}});await e.json()}catch(r){}return a},onSuccess:()=>{r.invalidateQueries({queryKey:["/api/calendar/events"]}),r.invalidateQueries({queryKey:["events"]}),a({title:"Visita agendada",description:"A visita foi agendada com sucesso na agenda e sincronizada com a planilha."}),s()},onError:e=>{a({title:"Erro",description:`Erro ao agendar visita: ${e.message}`,variant:"destructive"})}}),d=(e,t)=>{o(s=>({...s,[e]:t}))};return e?n.jsx(Ae,{open:t,onOpenChange:e=>!e&&s(),children:n.jsxs(ze,{className:"max-w-sm","aria-describedby":"schedule-visit-modal-description",children:[n.jsx("div",{id:"schedule-visit-modal-description",className:"sr-only",children:"Formulário para agendar visita ao membro"}),n.jsx(Pe,{children:n.jsxs(Ie,{className:"flex items-center gap-2 text-lg",children:[n.jsx(R,{className:"h-5 w-5"}),"Agendar Visita"]})}),n.jsxs("form",{onSubmit:e=>{e.preventDefault(),i.scheduledAt&&i.scheduledTime?l.mutate(i):a({title:"Data e hora obrigatórias",description:"Por favor, selecione uma data e hora para a visita.",variant:"destructive"})},className:"space-y-4",children:[n.jsxs("div",{className:"bg-muted/30 p-3 rounded-lg",children:[n.jsx("h4",{className:"font-medium text-sm mb-2",children:"Visitando:"}),n.jsxs("div",{className:"text-sm space-y-1",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Nome:"})," ",e.name]}),e.phone&&n.jsxs("p",{children:[n.jsx("strong",{children:"Telefone:"})," ",e.phone]}),e.address&&n.jsxs("p",{children:[n.jsx("strong",{children:"Endereço:"})," ",e.address]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"scheduledAt",className:"text-sm",children:"Data"}),n.jsx(_,{id:"scheduledAt",type:"date",value:i.scheduledAt,onChange:e=>d("scheduledAt",e.target.value),required:!0,className:"h-9"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"scheduledTime",className:"text-sm",children:"Hora"}),n.jsx(_,{id:"scheduledTime",type:"time",value:i.scheduledTime,onChange:e=>d("scheduledTime",e.target.value),required:!0,className:"h-9"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(V,{htmlFor:"notes",className:"text-sm",children:"Observações"}),n.jsx(Ve,{id:"notes",value:i.notes,onChange:e=>d("notes",e.target.value),placeholder:"Motivo da visita, objetivos...",rows:2,className:"text-sm"})]}),n.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[n.jsx(B,{type:"button",variant:"outline",onClick:s,size:"sm",children:"Cancelar"}),n.jsx(B,{type:"submit",disabled:l.isPending,className:"bg-purple-600 hover:bg-purple-700",size:"sm",children:l.isPending?"Agendando...":"Agendar"})]})]})]})}):null};var ws="AlertDialog",[Cs,Ds]=m(ws,[D]),ks=D(),Ss=e=>{const{__scopeAlertDialog:t,...a}=e,r=ks(t);return n.jsx(s,{...r,...a,modal:!0})};Ss.displayName=ws;I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,...a}=e,r=ks(s);return n.jsx(P,{...r,...a,ref:t})}).displayName="AlertDialogTrigger";var Es=e=>{const{__scopeAlertDialog:t,...s}=e,r=ks(t);return n.jsx(a,{...r,...s})};Es.displayName="AlertDialogPortal";var As=I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,...a}=e,i=ks(s);return n.jsx(r,{...i,...a,ref:t})});As.displayName="AlertDialogOverlay";var zs="AlertDialogContent",[Ps,Is]=Cs(zs),Os=S("AlertDialogContent"),Fs=I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,children:a,...r}=e,o=ks(s),l=I.useRef(null),d=u(t,l),c=I.useRef(null);return n.jsx(k,{contentName:zs,titleName:Ts,docsSlug:"alert-dialog",children:n.jsx(Ps,{scope:s,cancelRef:c,children:n.jsxs(i,{role:"alertdialog",...o,...r,ref:d,onOpenAutoFocus:x(r.onOpenAutoFocus,e=>{e.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[n.jsx(Os,{children:a}),n.jsx(Bs,{contentRef:l})]})})})});Fs.displayName=zs;var Ts="AlertDialogTitle",Ms=I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,...a}=e,r=ks(s);return n.jsx(E,{...r,...a,ref:t})});Ms.displayName=Ts;var Rs="AlertDialogDescription",qs=I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,...a}=e,r=ks(s);return n.jsx(A,{...r,...a,ref:t})});qs.displayName=Rs;var $s=I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,...a}=e,r=ks(s);return n.jsx(z,{...r,...a,ref:t})});$s.displayName="AlertDialogAction";var Vs="AlertDialogCancel",_s=I.forwardRef((e,t)=>{const{__scopeAlertDialog:s,...a}=e,{cancelRef:r}=Is(Vs,s),i=ks(s),o=u(t,r);return n.jsx(z,{...i,...a,ref:o})});_s.displayName=Vs;var Bs=({contentRef:e})=>{const t=`\`${zs}\` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the \`${zs}\` by passing a \`${Rs}\` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${zs}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return I.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))},[t,e]),null},Ls=As,Us=Fs,Ks=$s,Qs=_s,Js=Ms,Ws=qs;const Ys=Ss,Gs=Es,Hs=I.forwardRef(({className:e,...t},s)=>n.jsx(Ls,{className:M("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:s}));Hs.displayName=Ls.displayName;const Zs=I.forwardRef(({className:e,...t},s)=>n.jsxs(Gs,{children:[n.jsx(Hs,{}),n.jsx(Us,{ref:s,className:M("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));Zs.displayName=Us.displayName;const Xs=({className:e,...t})=>n.jsx("div",{className:M("flex flex-col space-y-2 text-center sm:text-left",e),...t});Xs.displayName="AlertDialogHeader";const ea=({className:e,...t})=>n.jsx("div",{className:M("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});ea.displayName="AlertDialogFooter";const ta=I.forwardRef(({className:e,...t},s)=>n.jsx(Js,{ref:s,className:M("text-lg font-semibold",e),...t}));ta.displayName=Js.displayName;const sa=I.forwardRef(({className:e,...t},s)=>n.jsx(Ws,{ref:s,className:M("text-sm text-muted-foreground",e),...t}));sa.displayName=Ws.displayName;const aa=I.forwardRef(({className:e,...t},s)=>n.jsx(Ks,{ref:s,className:M(ce(),e),...t}));aa.displayName=Ks.displayName;const ra=I.forwardRef(({className:e,...t},s)=>n.jsx(Qs,{ref:s,className:M(ce({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));function ia(){const{user:e}=J();be();const{toast:t}=U(),s=de(),[a,r]=I.useState(""),[i,o]=I.useState("all"),[l,d]=I.useState("all"),[c,m]=I.useState("name"),[u,x]=I.useState("asc"),[h,p]=I.useState("all"),[g,f]=I.useState("all"),[v,j]=I.useState(null),[b,N]=I.useState(null),[y,w]=I.useState(null),[C,D]=I.useState("all"),[k,S]=I.useState(null),[E,A]=I.useState(!1),[z,P]=I.useState(!1),[O,T]=I.useState(!1),[M,R]=I.useState(!1),[q,V]=I.useState(null),[K,Q]=I.useState(!1),[H,ee]=I.useState(null),[se,ae]=I.useState(""),[ce,fe]=I.useState(!0),[ve,ye]=I.useState(!0),[we,Ce]=I.useState(!0),[De,ke]=I.useState(!1),[Se,Ee]=I.useState(null),[Ae,ze]=I.useState(""),{data:Pe,isLoading:Ie,error:Oe}=F({queryKey:["/api/users/with-points"],queryFn:async()=>{try{const e=await fetch("/api/users/with-points");if(!e.ok)throw new Error("Falha ao carregar usuários");const t=await e.json();return Array.isArray(t)?t:[]}catch(e){try{const e=await fetch("/api/users");if(e.ok){const t=await e.json();return Array.isArray(t)?t:[]}}catch(t){}return[]}},refetchOnWindowFocus:!0,refetchOnMount:!0,staleTime:3e5,gcTime:6e5}),qe=Array.isArray(Pe)?Pe:[],{data:$e=[]}=F({queryKey:["all-relationships"],queryFn:async()=>{const e=await fetch("/api/relationships");if(!e.ok)throw new Error("Erro ao buscar relacionamentos");return e.json()},enabled:!0}),Ve=Array.isArray($e)?$e:[],{data:_e}=F({queryKey:["/api/spiritual-checkins/scores"],queryFn:async()=>{const e=await fetch("/api/spiritual-checkins/scores");if(!e.ok)throw new Error("Failed to fetch spiritual check-ins");return e.json()},staleTime:6e4}),{data:Ke=[]}=F({queryKey:["churches"],queryFn:async()=>{const e=await fetch("/api/churches");if(!e.ok)throw new Error("Erro ao buscar igrejas");return e.json()}}),{data:Qe=[]}=F({queryKey:["discipleship-requests"],queryFn:async()=>{const e=await fetch("/api/discipleship-requests");if(!e.ok)throw new Error("Erro ao buscar solicitações de discipulado");return e.json()}}),We=qe.map(e=>({...e,hasPendingDiscipleRequest:Qe.some(t=>t.interestedId===e.id&&"pending"===t.status)})),Ye=e=>"pending"===e.status?1:(e.points||0)<300?2:(e.attendance||0)<50?3:e.isApproved?5:4,Ge=e=>{j(e),e&&(r(""),o("all"),d("all"),f("all"),p("all"),D("all"),N(null))},He=e=>{N(e),e&&(r(""),o("all"),d("all"),f("all"),p("all"),D("all"),j(null),w(null))},Ze=e=>{w(e),e&&(r(""),o("all"),d("all"),f("all"),p("all"),D("all"),j(null),N(null))},Xe=()=>{if(!v)return null;return{vale:"Vale do Jordão",sinai:"Monte Sinai",nebo:"Monte Nebo",moria:"Monte Moriá",carmelo:"Monte Carmelo",hermon:"Monte Hermon",siao:"Monte Sião",oliveiras:"Monte das Oliveiras",topo:"O Topo"}[v]},et=t=>{if("missionary"===e?.role)return We.filter(e=>{if("interested"!==e.role)return!1;if(!(Ve||[]).some(t=>t.interestedId===e.id&&"active"===t.status))return!1;const s=e.points||0;switch(t){case"vale":return s>=0&&s<300;case"sinai":return s>=300&&s<400;case"nebo":return s>=400&&s<500;case"moria":return s>=500&&s<600;case"carmelo":return s>=600&&s<700;case"hermon":return s>=700&&s<800;case"siao":return s>=800&&s<900;case"oliveiras":return s>=900&&s<1e3;case"topo":return s>=1e3;default:return!1}}).length;{const e=e=>e.points||0;switch(t){case"vale":return We.filter(t=>e(t)>=0&&e(t)<300).length;case"sinai":return We.filter(t=>e(t)>=300&&e(t)<400).length;case"nebo":return We.filter(t=>e(t)>=400&&e(t)<500).length;case"moria":return We.filter(t=>e(t)>=500&&e(t)<600).length;case"carmelo":return We.filter(t=>e(t)>=600&&e(t)<700).length;case"hermon":return We.filter(t=>e(t)>=700&&e(t)<800).length;case"siao":return We.filter(t=>e(t)>=800&&e(t)<900).length;case"oliveiras":return We.filter(t=>e(t)>=900&&e(t)<1e3).length;case"topo":return We.filter(t=>e(t)>=1e3).length;default:return 0}}},tt=We.filter(t=>{const s=t.name&&"string"==typeof t.name&&t.name.toLowerCase().includes(a.toLowerCase())||t.email&&"string"==typeof t.email&&t.email.toLowerCase().includes(a.toLowerCase());let r=!i||"all"===i||t.role===i;if("missionary"===i){const e=(Ve||[]).some(e=>e.missionaryId===t.id&&"active"===e.status);r="missionary"===t.role||"member"===t.role&&e}const o=!l||"all"===l||t.status===l,n="all"===g||t.church===g;let d=!0;"missionary"===C?d="missionary"===t.role:"non-missionary"===C&&(d="missionary"!==t.role);let c=!0;if(v){const e=t.points||0;switch(v){case"vale":c=e>=0&&e<300;break;case"sinai":c=e>=300&&e<400;break;case"nebo":c=e>=400&&e<500;break;case"moria":c=e>=500&&e<600;break;case"carmelo":c=e>=600&&e<700;break;case"hermon":c=e>=700&&e<800;break;case"siao":c=e>=800&&e<900;break;case"oliveiras":c=e>=900&&e<1e3;break;case"topo":c=e>=1e3;break;default:c=!0}}let m=!0;b&&(m="no-situation"===b?"interested"===t.role&&!t.interestedSituation:"total"===b?"interested"===t.role:"interested"===t.role&&t.interestedSituation===b);let u=!0;if(y)switch(y){case"score-1":u=1===t.emotionalScore;break;case"score-2":u=2===t.emotionalScore;break;case"score-3":u=3===t.emotionalScore;break;case"score-4":u=4===t.emotionalScore;break;case"score-5":u=5===t.emotionalScore;break;case"no-checkin":u=!t.emotionalScore;break;default:u=!0}let x=!0;if("missionary"===e?.role)if("interested"===t.role){x=(Ve||[]).some(e=>e.interestedId===t.id&&"active"===e.status)}else x=t.id===e.id;return s&&r&&o&&n&&c&&m&&u&&d&&x}).sort((e,t)=>{let s,a;switch(c){case"name":default:s=e.name.toLowerCase(),a=t.name.toLowerCase();break;case"points":s=e.points||0,a=t.points||0;break;case"attendance":s=e.attendance||0,a=t.attendance||0;break;case"createdAt":s=new Date(e.createdAt||0),a=new Date(t.createdAt||0);break;case"priority":s=Ye(e),a=Ye(t)}return"asc"===u?s>a?1:-1:s<a?1:-1}),st=je({mutationFn:e=>fetch(`/api/users/${e}/approve`,{method:"POST"}).then(e=>e.json()),onSuccess:()=>{s.invalidateQueries({queryKey:["/api/users/with-points"]}),window.dispatchEvent(new CustomEvent("user-approved")),t({title:"Usuário aprovado",description:"O usuário foi aprovado com sucesso."})}}),at=je({mutationFn:e=>fetch(`/api/users/${e}/reject`,{method:"POST"}).then(e=>e.json()),onSuccess:()=>{s.invalidateQueries({queryKey:["/api/users/with-points"]}),window.dispatchEvent(new CustomEvent("user-rejected")),t({title:"Usuário rejeitado",description:"O usuário foi rejeitado.",variant:"destructive"})}}),rt=je({mutationFn:({userId:e,data:t})=>fetch(`/api/users/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(e=>e.json()),onSuccess:()=>{s.invalidateQueries({queryKey:["/api/users/with-points"]}),window.dispatchEvent(new CustomEvent("user-updated")),t({title:"Usuário atualizado",description:"As informações do usuário foram atualizadas com sucesso."})}}),it=(e,t)=>{rt.mutate({userId:e,data:t}),S(e=>e?{...e,...t}:null)},ot=je({mutationFn:async e=>{const t=await fetch(`/api/users/${e}`,{method:"DELETE"});if(!t.ok)throw new Error("Failed to delete user");return t.json()},onSuccess:()=>{s.invalidateQueries({queryKey:["/api/users/with-points"]}),t({title:"✅ Usuário excluído",description:"Usuário excluído com sucesso!"}),R(!1),V(null)},onError:e=>{t({title:"❌ Erro ao excluir usuário",description:e.message||"Não foi possível excluir o usuário.",variant:"destructive"})}}),nt=je({mutationFn:async({userId:e,message:t})=>{const s=await fetch(`/api/users/${e}/disciple`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t})});if(!s.ok){const e=await s.json();throw new Error(e.error||"Failed to disciple user")}return s.json()},onSuccess:()=>{s.invalidateQueries({queryKey:["/api/users"]}),t({title:"✅ Solicitação enviada",description:"Solicitação de discipulado enviada com sucesso!"}),Q(!1),ee(null),ae("")},onError:e=>{t({title:"❌ Erro ao solicitar discipulado",description:e.message||"Não foi possível enviar a solicitação.",variant:"destructive"})}}),lt=async a=>{if(Se)try{if(!(await fetch(`/api/discipleship-requests/${Se.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a,adminNotes:Ae.trim(),processedBy:e?.id||1})})).ok)throw new Error("Erro ao processar solicitação");s.invalidateQueries({queryKey:["discipleship-requests"]}),s.invalidateQueries({queryKey:["relationships"]}),ke(!1),Ee(null),ze(""),t({title:"✅ Solicitação processada!",description:`A solicitação foi ${"approved"===a?"aprovada":"rejeitada"} com sucesso.`})}catch(r){t({title:"❌ Erro ao processar",description:r.message||"Não foi possível processar a solicitação.",variant:"destructive"})}},{markVisit:dt}=(()=>{const e=de(),t=je({mutationFn:async({userId:e,visitDate:t})=>{const s=await fetch(`/api/users/${e}/visit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitDate:t})});if(!s.ok){const e=await s.json();throw new Error(e.error||"Erro ao marcar visita")}return s.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["/api/dashboard/stats"]}),e.invalidateQueries({queryKey:["/api/dashboard/visits"]}),e.invalidateQueries({queryKey:["/api/dashboard"]}),e.invalidateQueries({queryKey:["dashboard"]}),e.refetchQueries({queryKey:["/api/dashboard/visits"]})}});return{markVisit:t.mutate,isMarkingVisit:t.isPending,markVisitError:t.error}})(),ct=async(e,t,s)=>{s&&dt({userId:e,visitDate:s})},mt=qe.filter(e=>"pending"===e.status).length;return Ie?n.jsx(me,{children:n.jsx("div",{className:"p-4 space-y-4",children:n.jsx("div",{className:"flex items-center justify-center py-8",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),n.jsx("p",{className:"text-muted-foreground",children:"Carregando usuários..."})]})})})}):Oe?n.jsx(me,{children:n.jsx("div",{className:"p-4 space-y-4",children:n.jsx("div",{className:"flex items-center justify-center py-8",children:n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-destructive",children:"Erro ao carregar usuários"}),n.jsx(B,{onClick:()=>s.invalidateQueries({queryKey:["/api/users"]}),className:"mt-2",children:"Tentar novamente"})]})})})}):n.jsx(me,{children:n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(G,{className:"h-6 w-6 text-primary"}),n.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"missionary"===e?.role?"Meus Interessados":"Usuários"}),mt>0&&n.jsxs($,{variant:"destructive",className:"ml-2","data-testid":"badge-pending-count",children:[mt," pendente",mt>1?"s":""]}),"missionary"===e?.role&&n.jsxs($,{variant:"secondary",className:"ml-2",children:[(Ve||[]).filter(e=>"active"===e.status).length," vinculado",1!==(Ve||[]).filter(e=>"active"===e.status).length?"s":""]})]}),n.jsx("div",{className:"flex items-center gap-2",children:"admin"===e?.role&&n.jsx(n.Fragment,{children:n.jsxs(B,{size:"sm",className:"bg-primary hover:bg-primary-dark","data-testid":"button-new-user",children:[n.jsx(Le,{className:"h-4 w-4 mr-1"}),"Novo"]})})})]}),n.jsx("div",{className:"flex flex-wrap gap-4 mt-6 p-4 bg-gradient-to-r from-slate-50 to-gray-50 rounded-xl border border-slate-200/50 shadow-sm",children:"admin"===e?.role?n.jsxs(n.Fragment,{children:[n.jsxs($,{variant:"admin"===i?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("admin"===i?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-500/25 border-0":"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 border-blue-300/50 hover:from-blue-100 hover:to-blue-200 hover:border-blue-400"),onClick:()=>o("admin"===i?"all":"admin"),"data-testid":"stat-admin",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsx(Me,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),n.jsx("span",{className:"font-semibold tracking-wide",children:"Administradores"}),n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:qe.filter(e=>"admin"===e.role).length})]}),n.jsxs($,{variant:"member"===i?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("member"===i?"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white shadow-lg shadow-emerald-500/25 border-0":"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 border-emerald-300/50 hover:from-emerald-100 hover:to-emerald-200 hover:border-emerald-400"),onClick:()=>o("member"===i?"all":"member"),"data-testid":"stat-member",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsx(G,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),n.jsx("span",{className:"font-semibold tracking-wide",children:"Membros"}),n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:qe.filter(e=>"member"===e.role).length})]}),n.jsxs($,{variant:"missionary"===i?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("missionary"===i?"bg-gradient-to-r from-violet-600 to-violet-700 text-white shadow-lg shadow-violet-500/25 border-0":"bg-gradient-to-r from-violet-50 to-violet-100 text-violet-700 border-violet-300/50 hover:from-violet-100 hover:to-violet-200 hover:border-violet-400"),onClick:()=>o("missionary"===i?"all":"missionary"),"data-testid":"stat-missionary",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsx(X,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),n.jsx("span",{className:"font-semibold tracking-wide",children:"Missionários"}),n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:qe.filter(e=>{const t=(Ve||[]).some(t=>t.missionaryId===e.id&&"active"===t.status);return"missionary"===e.role||"member"===e.role&&t}).length})]}),n.jsxs($,{variant:"interested"===i?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("interested"===i?"bg-gradient-to-r from-amber-600 to-amber-700 text-white shadow-lg shadow-amber-500/25 border-0":"bg-gradient-to-r from-amber-50 to-amber-100 text-amber-700 border-amber-300/50 hover:from-amber-100 hover:to-amber-200 hover:border-amber-400"),onClick:()=>o("interested"===i?"all":"interested"),"data-testid":"stat-interested",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsx(Z,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),n.jsx("span",{className:"font-semibold tracking-wide",children:"Interessados"}),n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:qe.filter(e=>"interested"===e.role).length})]})]}):"missionary"===e?.role?n.jsxs(n.Fragment,{children:[n.jsxs($,{variant:"outline",className:"group relative bg-gradient-to-r from-violet-50 to-violet-100 text-violet-700 border-violet-300/50 cursor-default shadow-sm hover:shadow-md transition-all duration-300","data-testid":"stat-my-interested",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-400/10 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsx(X,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),n.jsx("span",{className:"font-semibold tracking-wide",children:"Meus Interessados"}),n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-violet-200/50 rounded-full text-sm font-bold",children:(Ve||[]).filter(e=>"active"===e.status).length})]}),n.jsxs($,{variant:"outline",className:"group relative bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 border-emerald-300/50 cursor-default shadow-sm hover:shadow-md transition-all duration-300","data-testid":"stat-studying",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/10 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsx(L,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),n.jsx("span",{className:"font-semibold tracking-wide",children:"Estudando"}),n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-emerald-200/50 rounded-full text-sm font-bold",children:tt.filter(e=>"C"===e.interestedSituation).length})]}),n.jsxs($,{variant:"outline",className:"group relative bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 border-blue-300/50 cursor-default shadow-sm hover:shadow-md transition-all duration-300","data-testid":"stat-ready-baptism",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/10 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsx(Z,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),n.jsx("span",{className:"font-semibold tracking-wide",children:"Pronto Batismo"}),n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-blue-200/50 rounded-full text-sm font-bold",children:tt.filter(e=>"A"===e.interestedSituation).length})]}),n.jsxs($,{variant:"outline",className:"group relative bg-gradient-to-r from-amber-50 to-amber-100 text-amber-700 border-amber-300/50 cursor-default shadow-sm hover:shadow-md transition-all duration-300","data-testid":"stat-new-contacts",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-400/10 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsx(Te,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),n.jsx("span",{className:"font-semibold tracking-wide",children:"Novos Contatos"}),n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-amber-200/50 rounded-full text-sm font-bold",children:tt.filter(e=>"E"===e.interestedSituation).length})]})]}):n.jsxs(n.Fragment,{children:[n.jsxs($,{variant:"admin"===i?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("admin"===i?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-500/25 border-0":"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 border-blue-300/50 hover:from-blue-100 hover:to-blue-200 hover:border-blue-400"),onClick:()=>o("admin"===i?"all":"admin"),"data-testid":"stat-admin",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsx(Me,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),n.jsx("span",{className:"font-semibold tracking-wide",children:"Administradores"}),n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:qe.filter(e=>"admin"===e.role).length})]}),n.jsxs($,{variant:"member"===i?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("member"===i?"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white shadow-lg shadow-emerald-500/25 border-0":"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 border-emerald-300/50 hover:from-emerald-100 hover:to-emerald-200 hover:border-emerald-400"),onClick:()=>o("member"===i?"all":"member"),"data-testid":"stat-member",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsx(G,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),n.jsx("span",{className:"font-semibold tracking-wide",children:"Membros"}),n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:qe.filter(e=>"member"===e.role).length})]}),n.jsxs($,{variant:"missionary"===i?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("missionary"===i?"bg-gradient-to-r from-violet-600 to-violet-700 text-white shadow-lg shadow-violet-500/25 border-0":"bg-gradient-to-r from-violet-50 to-violet-100 text-violet-700 border-violet-300/50 hover:from-violet-100 hover:to-violet-200 hover:border-violet-400"),onClick:()=>o("missionary"===i?"all":"missionary"),"data-testid":"stat-missionary",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsx(X,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),n.jsx("span",{className:"font-semibold tracking-wide",children:"Missionários"}),n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:qe.filter(e=>{const t=(Ve||[]).some(t=>t.missionaryId===e.id&&"active"===t.status);return"missionary"===e.role||"member"===e.role&&t}).length})]}),n.jsxs($,{variant:"interested"===i?"default":"outline",className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("interested"===i?"bg-gradient-to-r from-amber-600 to-amber-700 text-white shadow-lg shadow-amber-500/25 border-0":"bg-gradient-to-r from-amber-50 to-amber-100 text-amber-700 border-amber-300/50 hover:from-amber-100 hover:to-amber-200 hover:border-amber-400"),onClick:()=>o("interested"===i?"all":"interested"),"data-testid":"stat-interested",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-400/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsx(Z,{className:"h-4 w-4 mr-2 drop-shadow-sm"}),n.jsx("span",{className:"font-semibold tracking-wide",children:"Interessados"}),n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded-full text-sm font-bold",children:qe.filter(e=>"interested"===e.role).length})]})]})}),n.jsxs("div",{className:"space-y-4 mt-6 p-4 bg-gradient-to-r from-slate-50 to-gray-50 rounded-xl border border-slate-200/50 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[n.jsx(Z,{className:"h-5 w-5 text-yellow-500 drop-shadow-sm"}),"missionary"===e?.role?"Meus Interessados por Montes e Estatísticas":"Usuários por Montes e Estatísticas"]}),n.jsx(B,{variant:"outline",size:"sm",onClick:()=>fe(!ce),className:"h-7 px-3 text-xs flex items-center gap-1 bg-white/50 hover:bg-white/80 border-slate-300/50 hover:border-slate-400 transition-all duration-200",title:ce?"Esconder filtros e estatísticas":"Mostrar filtros e estatísticas",children:ce?n.jsxs(n.Fragment,{children:[n.jsx(ue,{className:"h-3 w-3"}),"Esconder"]}):n.jsxs(n.Fragment,{children:[n.jsx(te,{className:"h-3 w-3"}),"Mostrar"]})}),v&&n.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[n.jsxs($,{variant:"secondary",className:"text-xs bg-blue-100 text-blue-700 border-blue-300",children:["Filtrado: ",Xe()]}),n.jsx(B,{variant:"outline",size:"sm",onClick:()=>Ge(null),className:"h-7 px-3 text-xs bg-white/50 hover:bg-white/80 border-slate-300/50 hover:border-slate-400 transition-all duration-200",children:"Limpar Filtro"})]})]}),ce&&n.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-9 gap-3",children:[n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("vale"===v?"bg-gradient-to-r from-gray-600 to-gray-700 text-white shadow-lg shadow-gray-500/25 border-0":"bg-gradient-to-r from-gray-50 to-gray-100 text-gray-700 border-gray-300/50 hover:from-gray-100 hover:to-gray-200 hover:border-gray-400"),onClick:()=>Ge("vale"===v?null:"vale"),title:"Clique para filtrar usuários deste monte",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1",children:et("vale")}),n.jsx("div",{className:"text-sm font-semibold mb-1",children:"Vale"}),n.jsx("div",{className:"text-xs opacity-80",children:"0-299 pts"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("sinai"===v?"bg-gradient-to-r from-orange-600 to-orange-700 text-white shadow-lg shadow-orange-500/25 border-0":"bg-gradient-to-r from-orange-50 to-orange-100 text-orange-700 border-orange-300/50 hover:from-orange-100 hover:to-orange-200 hover:border-orange-400"),onClick:()=>Ge("sinai"===v?null:"sinai"),children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1",children:et("sinai")}),n.jsx("div",{className:"text-sm font-semibold mb-1",children:"Sinai"}),n.jsx("div",{className:"text-xs opacity-80",children:"300-399 pts"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("nebo"===v?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-500/25 border-0":"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 border-blue-300/50 hover:from-blue-100 hover:to-blue-200 hover:border-blue-400"),onClick:()=>Ge("nebo"===v?null:"nebo"),children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1",children:et("nebo")}),n.jsx("div",{className:"text-sm font-semibold mb-1",children:"Nebo"}),n.jsx("div",{className:"text-xs opacity-80",children:"400-499 pts"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("moria"===v?"bg-gradient-to-r from-purple-600 to-purple-700 text-white shadow-lg shadow-purple-500/25 border-0":"bg-gradient-to-r from-purple-50 to-purple-100 text-purple-700 border-purple-300/50 hover:from-purple-100 hover:to-purple-200 hover:border-purple-400"),onClick:()=>Ge("moria"===v?null:"moria"),children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1",children:et("moria")}),n.jsx("div",{className:"text-sm font-semibold mb-1",children:"Moriá"}),n.jsx("div",{className:"text-xs opacity-80",children:"500-599 pts"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("carmelo"===v?"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white shadow-lg shadow-emerald-500/25 border-0":"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 border-emerald-300/50 hover:from-emerald-100 hover:to-emerald-200 hover:border-emerald-400"),onClick:()=>Ge("carmelo"===v?null:"carmelo"),children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1",children:et("carmelo")}),n.jsx("div",{className:"text-sm font-semibold mb-1",children:"Carmelo"}),n.jsx("div",{className:"text-xs opacity-80",children:"600-699 pts"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("hermon"===v?"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white shadow-lg shadow-indigo-500/25 border-0":"bg-gradient-to-r from-indigo-50 to-indigo-100 text-indigo-700 border-indigo-300/50 hover:from-indigo-100 hover:to-indigo-200 hover:border-indigo-400"),onClick:()=>Ge("hermon"===v?null:"hermon"),children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1",children:et("hermon")}),n.jsx("div",{className:"text-sm font-semibold mb-1",children:"Hermon"}),n.jsx("div",{className:"text-xs opacity-80",children:"700-799 pts"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("siao"===v?"bg-gradient-to-r from-red-600 to-red-700 text-white shadow-lg shadow-red-500/25 border-0":"bg-gradient-to-r from-red-50 to-red-100 text-red-700 border-red-300/50 hover:from-red-100 hover:to-red-200 hover:border-red-400"),onClick:()=>Ge("siao"===v?null:"siao"),children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1",children:et("siao")}),n.jsx("div",{className:"text-sm font-semibold mb-1",children:"Sião"}),n.jsx("div",{className:"text-xs opacity-80",children:"800-899 pts"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("oliveiras"===v?"bg-gradient-to-r from-yellow-600 to-yellow-700 text-white shadow-lg shadow-yellow-500/25 border-0":"bg-gradient-to-r from-yellow-50 to-yellow-100 text-yellow-700 border-yellow-300/50 hover:from-yellow-100 hover:to-yellow-200 hover:border-yellow-400"),onClick:()=>Ge("oliveiras"===v?null:"oliveiras"),children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1",children:et("oliveiras")}),n.jsx("div",{className:"text-sm font-semibold mb-1",children:"Oliveiras"}),n.jsx("div",{className:"text-xs opacity-80",children:"900-999 pts"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("topo"===v?"bg-gradient-to-r from-amber-600 to-amber-700 text-white shadow-lg shadow-amber-500/25 border-0":"bg-gradient-to-r from-amber-50 to-amber-100 text-amber-700 border-amber-300/50 hover:from-amber-100 hover:to-amber-200 hover:border-amber-400"),onClick:()=>Ge("topo"===v?null:"topo"),children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1",children:et("topo")}),n.jsx("div",{className:"text-sm font-semibold mb-1",children:"O Topo"}),n.jsx("div",{className:"text-xs opacity-80",children:"1000+ pts"})]})]})]}),ce&&n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs(W,{className:"group relative bg-gradient-to-r from-blue-50 to-blue-100 border-blue-300/50 hover:shadow-md transition-all duration-300",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/10 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold text-blue-700 mb-1",children:tt.filter(e=>(e.points||0)>0).length}),n.jsx("div",{className:"text-sm font-semibold text-blue-600 mb-1",children:"Com Pontos"}),n.jsxs("div",{className:"text-xs text-blue-500",children:[tt.length>0?(tt.filter(e=>(e.points||0)>0).length/tt.length*100).toFixed(1):"0","%"]})]})]}),n.jsxs(W,{className:"group relative bg-gradient-to-r from-emerald-50 to-emerald-100 border-emerald-300/50 hover:shadow-md transition-all duration-300",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/10 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold text-emerald-700 mb-1",children:tt.filter(e=>(e.points||0)>0).length>0?Math.round(tt.reduce((e,t)=>e+(t.points||0),0)/tt.filter(e=>(e.points||0)>0).length):0}),n.jsx("div",{className:"text-sm font-semibold text-emerald-600 mb-1",children:"Média"}),n.jsx("div",{className:"text-xs text-emerald-500",children:"Por Usuário"})]})]}),n.jsxs(W,{className:"group relative bg-gradient-to-r from-indigo-50 to-indigo-100 border-indigo-300/50 hover:shadow-md transition-all duration-300",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-400/10 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold text-indigo-700 mb-1",children:tt.length>0?Math.max(...tt.map(e=>e.points||0)):0}),n.jsx("div",{className:"text-sm font-semibold text-indigo-600 mb-1",children:"Maior"}),n.jsx("div",{className:"text-xs text-indigo-500",children:"Recorde"})]})]})]})]}),n.jsxs("div",{className:"space-y-4 mt-6 p-4 bg-gradient-to-r from-slate-50 to-gray-50 rounded-xl border border-slate-200/50 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[n.jsx(X,{className:"h-5 w-5 text-red-500 drop-shadow-sm"}),"Situação dos Interessados"]}),n.jsx(B,{variant:"outline",size:"sm",onClick:()=>ye(!ve),className:"h-7 px-3 text-xs flex items-center gap-1 bg-white/50 hover:bg-white/80 border-slate-300/50 hover:border-slate-400 transition-all duration-200",title:ve?"Esconder estatísticas dos interessados":"Mostrar estatísticas dos interessados",children:ve?n.jsxs(n.Fragment,{children:[n.jsx(ue,{className:"h-3 w-3"}),"Esconder"]}):n.jsxs(n.Fragment,{children:[n.jsx(te,{className:"h-3 w-3"}),"Mostrar"]})})]}),ve&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("A"===b?"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white shadow-lg shadow-emerald-500/25 border-0":"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 border-emerald-300/50 hover:from-emerald-100 hover:to-emerald-200 hover:border-emerald-400"),onClick:()=>He("A"===b?null:"A"),title:"Clique para filtrar interessados Pronto para Batismo",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1 "+("A"===b?"text-white":"text-emerald-700"),children:tt.filter(e=>"interested"===e.role&&"A"===e.interestedSituation).length}),n.jsx("div",{className:"text-sm font-semibold mb-1 "+("A"===b?"text-white":"text-emerald-600"),children:"Pronto para Batismo"}),n.jsx("div",{className:"text-xs "+("A"===b?"text-white/90":"text-emerald-500"),children:"Tipo A"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("B"===b?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-500/25 border-0":"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 border-blue-300/50 hover:from-blue-100 hover:to-blue-200 hover:border-blue-400"),onClick:()=>He("B"===b?null:"B"),title:"Clique para filtrar interessados Detalhes Pessoais",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1 "+("B"===b?"text-white":"text-blue-700"),children:tt.filter(e=>"interested"===e.role&&"B"===e.interestedSituation).length}),n.jsx("div",{className:"text-sm font-semibold mb-1 "+("B"===b?"text-white":"text-blue-600"),children:"Detalhes Pessoais"}),n.jsx("div",{className:"text-xs "+("B"===b?"text-white/90":"text-blue-500"),children:"Tipo B"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("C"===b?"bg-gradient-to-r from-violet-600 to-violet-700 text-white shadow-lg shadow-violet-500/25 border-0":"bg-gradient-to-r from-violet-50 to-violet-100 text-violet-700 border-violet-300/50 hover:from-violet-100 hover:to-violet-200 hover:border-violet-400"),onClick:()=>He("C"===b?null:"C"),title:"Clique para filtrar interessados Estudando Bíblia",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1 "+("C"===b?"text-white":"text-violet-700"),children:tt.filter(e=>"interested"===e.role&&"C"===e.interestedSituation).length}),n.jsx("div",{className:"text-sm font-semibold mb-1 "+("C"===b?"text-white":"text-violet-600"),children:"Estudando Bíblia"}),n.jsx("div",{className:"text-xs "+("C"===b?"text-white/90":"text-violet-500"),children:"Tipo C"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("D"===b?"bg-gradient-to-r from-orange-600 to-orange-700 text-white shadow-lg shadow-orange-500/25 border-0":"bg-gradient-to-r from-orange-50 to-orange-100 text-orange-700 border-orange-300/50 hover:from-orange-100 hover:to-orange-200 hover:border-orange-400"),onClick:()=>He("D"===b?null:"D"),title:"Clique para filtrar interessados Quer Estudar",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1 "+("D"===b?"text-white":"text-orange-700"),children:tt.filter(e=>"interested"===e.role&&"D"===e.interestedSituation).length}),n.jsx("div",{className:"text-sm font-semibold mb-1 "+("D"===b?"text-white":"text-orange-600"),children:"Quer Estudar"}),n.jsx("div",{className:"text-xs "+("D"===b?"text-white/90":"text-orange-500"),children:"Tipo D"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("E"===b?"bg-gradient-to-r from-gray-600 to-gray-700 text-white shadow-lg shadow-gray-500/25 border-0":"bg-gradient-to-r from-gray-50 to-gray-100 text-gray-700 border-gray-300/50 hover:from-gray-100 hover:to-gray-200 hover:border-gray-400"),onClick:()=>He("E"===b?null:"E"),title:"Clique para filtrar interessados Contato Inicial",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1 "+("E"===b?"text-white":"text-gray-700"),children:tt.filter(e=>"interested"===e.role&&"E"===e.interestedSituation).length}),n.jsx("div",{className:"text-sm font-semibold mb-1 "+("E"===b?"text-white":"text-gray-600"),children:"Contato Inicial"}),n.jsx("div",{className:"text-xs "+("E"===b?"text-white/90":"text-gray-500"),children:"Tipo E"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("no-situation"===b?"bg-gradient-to-r from-yellow-600 to-yellow-700 text-white shadow-lg shadow-yellow-500/25 border-0":"bg-gradient-to-r from-yellow-50 to-yellow-100 text-yellow-700 border-yellow-300/50 hover:from-yellow-100 hover:to-yellow-200 hover:border-yellow-400"),onClick:()=>He("no-situation"===b?null:"no-situation"),title:"Clique para filtrar interessados sem situação definida",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1 "+("no-situation"===b?"text-white":"text-yellow-700"),children:tt.filter(e=>"interested"===e.role&&!e.interestedSituation).length}),n.jsx("div",{className:"text-sm font-semibold mb-1 "+("no-situation"===b?"text-white":"text-yellow-600"),children:"Sem Situação Definida"}),n.jsx("div",{className:"text-xs "+("no-situation"===b?"text-white/90":"text-yellow-500"),children:"Precisa de Acompanhamento"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("total"===b?"bg-gradient-to-r from-red-600 to-red-700 text-white shadow-lg shadow-red-500/25 border-0":"bg-gradient-to-r from-red-50 to-red-100 text-red-700 border-red-300/50 hover:from-red-100 hover:to-red-200 hover:border-red-400"),onClick:()=>He("total"===b?null:"total"),title:"Clique para filtrar todos os interessados",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-3 text-center relative z-10",children:[n.jsx("div",{className:"text-xl font-bold mb-1 "+("total"===b?"text-white":"text-red-700"),children:tt.filter(e=>"interested"===e.role).length}),n.jsx("div",{className:"text-sm font-semibold mb-1 "+("total"===b?"text-white":"text-red-600"),children:"Total de Interessados"}),n.jsx("div",{className:"text-xs "+("total"===b?"text-white/90":"text-red-500"),children:"Todos os Tipos"})]})]})]})]})]}),n.jsxs("div",{className:"space-y-4 mt-6 p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-200/50 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[n.jsx(X,{className:"h-5 w-5 text-purple-500 drop-shadow-sm"}),"Check-in Espiritual"]}),n.jsx(B,{variant:"outline",size:"sm",onClick:()=>Ce(!we),className:"h-7 px-3 text-xs flex items-center gap-1 bg-white/50 hover:bg-white/80 border-purple-300/50 hover:border-purple-400 transition-all duration-200",title:we?"Esconder estatísticas de check-in espiritual":"Mostrar estatísticas de check-in espiritual",children:we?n.jsxs(n.Fragment,{children:[n.jsx(ue,{className:"h-3 w-3"}),"Esconder"]}):n.jsxs(n.Fragment,{children:[n.jsx(te,{className:"h-3 w-3"}),"Mostrar"]})})]}),we&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("score-1"===y?"bg-gradient-to-r from-red-600 to-red-700 text-white shadow-lg shadow-red-500/25 border-0":"bg-gradient-to-r from-red-50 to-red-100 text-red-700 border-red-300/50 hover:from-red-100 hover:to-red-200 hover:border-red-400"),onClick:()=>Ze("score-1"===y?null:"score-1"),title:"Clique para filtrar usuários com score 1 (Distante)",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-2 text-center relative z-10",children:[n.jsx("div",{className:"text-lg mb-0.5",children:"🍃"}),n.jsx("div",{className:"text-lg font-bold mb-0.5 "+("score-1"===y?"text-white":"text-red-700"),children:_e?.scoreGroups?.[1]?.count||0}),n.jsx("div",{className:"text-xs font-semibold mb-0.5 "+("score-1"===y?"text-white":"text-red-600"),children:"Distante"}),n.jsx("div",{className:"text-xs "+("score-1"===y?"text-white/90":"text-red-500"),children:"Apocalipse 2:4"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("score-2"===y?"bg-gradient-to-r from-orange-600 to-orange-700 text-white shadow-lg shadow-orange-500/25 border-0":"bg-gradient-to-r from-orange-50 to-orange-100 text-orange-700 border-orange-300/50 hover:from-orange-100 hover:to-orange-200 hover:border-orange-400"),onClick:()=>Ze("score-2"===y?null:"score-2"),title:"Clique para filtrar usuários com score 2 (Buscando)",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-2 text-center relative z-10",children:[n.jsx("div",{className:"text-lg mb-0.5",children:"🔍"}),n.jsx("div",{className:"text-lg font-bold mb-0.5 "+("score-2"===y?"text-white":"text-orange-700"),children:_e?.scoreGroups?.[2]?.count||0}),n.jsx("div",{className:"text-xs font-semibold mb-0.5 "+("score-2"===y?"text-white":"text-orange-600"),children:"Buscando"}),n.jsx("div",{className:"text-xs "+("score-2"===y?"text-white/90":"text-orange-500"),children:"Isaías 55:6"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("score-3"===y?"bg-gradient-to-r from-yellow-600 to-yellow-700 text-white shadow-lg shadow-yellow-500/25 border-0":"bg-gradient-to-r from-yellow-50 to-yellow-100 text-yellow-700 border-yellow-300/50 hover:from-yellow-100 hover:to-yellow-200 hover:border-yellow-400"),onClick:()=>Ze("score-3"===y?null:"score-3"),title:"Clique para filtrar usuários com score 3 (Enraizando)",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-2 text-center relative z-10",children:[n.jsx("div",{className:"text-lg mb-0.5",children:"🌱"}),n.jsx("div",{className:"text-lg font-bold mb-0.5 "+("score-3"===y?"text-white":"text-yellow-700"),children:_e?.scoreGroups?.[3]?.count||0}),n.jsx("div",{className:"text-xs font-semibold mb-0.5 "+("score-3"===y?"text-white":"text-yellow-600"),children:"Enraizando"}),n.jsx("div",{className:"text-xs "+("score-3"===y?"text-white/90":"text-yellow-500"),children:"Salmo 1:2"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("score-4"===y?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-500/25 border-0":"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 border-blue-300/50 hover:from-blue-100 hover:to-blue-200 hover:border-blue-400"),onClick:()=>Ze("score-4"===y?null:"score-4"),title:"Clique para filtrar usuários com score 4 (Frutificando)",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-2 text-center relative z-10",children:[n.jsx("div",{className:"text-lg mb-0.5",children:"🌳"}),n.jsx("div",{className:"text-xl font-bold mb-0.5 "+("score-4"===y?"text-white":"text-blue-700"),children:_e?.scoreGroups?.[4]?.count||0}),n.jsx("div",{className:"text-xs font-semibold mb-0.5 "+("score-4"===y?"text-white":"text-blue-600"),children:"Frutificando"}),n.jsx("div",{className:"text-xs "+("score-4"===y?"text-white/90":"text-blue-500"),children:"João 15:5"})]})]}),n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("score-5"===y?"bg-gradient-to-r from-green-600 to-green-700 text-white shadow-lg shadow-green-500/25 border-0":"bg-gradient-to-r from-green-50 to-green-100 text-green-700 border-green-300/50 hover:from-green-100 hover:to-green-200 hover:border-green-400"),onClick:()=>Ze("score-5"===y?null:"score-5"),title:"Clique para filtrar usuários com score 5 (Intimidade)",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-2 text-center relative z-10",children:[n.jsx("div",{className:"text-lg mb-0.5",children:"✨"}),n.jsx("div",{className:"text-lg font-bold mb-0.5 "+("score-5"===y?"text-white":"text-green-700"),children:_e?.scoreGroups?.[5]?.count||0}),n.jsx("div",{className:"text-xs font-semibold mb-0.5 "+("score-5"===y?"text-white":"text-green-700"),children:"Intimidade"}),n.jsx("div",{className:"text-xs "+("score-5"===y?"text-white/90":"text-green-500"),children:"Gênesis 5:24"})]})]})]}),n.jsx("div",{className:"grid grid-cols-1 gap-3 mt-3",children:n.jsxs(W,{className:"group relative cursor-pointer transition-all duration-300 ease-out transform hover:scale-105 hover:shadow-lg "+("no-checkin"===y?"bg-gradient-to-r from-gray-600 to-gray-700 text-white shadow-lg shadow-gray-500/25 border-0":"bg-gradient-to-r from-gray-50 to-gray-100 text-gray-700 border-gray-300/50 hover:from-gray-100 hover:to-gray-200 hover:border-gray-400"),onClick:()=>Ze("no-checkin"===y?null:"no-checkin"),title:"Clique para filtrar usuários sem check-in espiritual",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-400/20 to-transparent rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n.jsxs(Y,{className:"p-2 text-center relative z-10",children:[n.jsx("div",{className:"text-lg font-bold mb-0.5 "+("no-checkin"===y?"text-white":"text-gray-700"),children:_e?.usersWithoutCheckIn||0}),n.jsx("div",{className:"text-xs font-semibold mb-0.5 "+("no-checkin"===y?"text-white":"text-gray-600"),children:"Sem Check-in"}),n.jsx("div",{className:"text-xs "+("no-checkin"===y?"text-white/90":"text-gray-500"),children:"Precisa de Acompanhamento"})]})]})})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),n.jsx(_,{placeholder:"Buscar por nome ou email...",value:a,onChange:e=>r(e.target.value),className:"pl-10","data-testid":"input-search"})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("div",{className:"flex-1 min-w-[120px]",children:n.jsxs(re,{value:i,onValueChange:o,children:[n.jsx(ie,{"data-testid":"select-role-filter",children:n.jsx(oe,{placeholder:"Papel"})}),n.jsxs(ne,{children:[n.jsx(le,{value:"all",children:"Todos os papéis"}),n.jsx(le,{value:"admin",children:"Administrador"}),n.jsx(le,{value:"missionary",children:"Missionário"}),n.jsx(le,{value:"member",children:"Membro"}),n.jsx(le,{value:"interested",children:"Interessado"})]})]})}),n.jsx("div",{className:"flex-1 min-w-[120px]",children:n.jsxs(re,{value:l,onValueChange:d,children:[n.jsx(ie,{"data-testid":"select-status-filter",children:n.jsx(oe,{placeholder:"Status"})}),n.jsxs(ne,{children:[n.jsx(le,{value:"all",children:"Todos os status"}),n.jsx(le,{value:"approved",children:"Aprovado"}),n.jsx(le,{value:"pending",children:"Pendente"}),n.jsx(le,{value:"rejected",children:"Rejeitado"})]})]})}),n.jsx("div",{className:"flex-1 min-w-[120px]",children:n.jsxs(re,{value:g,onValueChange:f,children:[n.jsx(ie,{"data-testid":"select-church-filter",children:n.jsx(oe,{placeholder:"Igreja"})}),n.jsxs(ne,{children:[n.jsx(le,{value:"all",children:"Todas as igrejas"}),Ke.map(e=>n.jsx(le,{value:e.name,children:e.name},e.id))]})]})}),n.jsx("div",{className:"flex-1 min-w-[120px]",children:n.jsxs(re,{value:C,onValueChange:D,children:[n.jsx(ie,{"data-testid":"select-missionary-profile-filter",children:n.jsx(oe,{placeholder:"Filtrar por role"})}),n.jsxs(ne,{children:[n.jsx(le,{value:"all",children:"Todos os roles"}),n.jsx(le,{value:"missionary",children:"Missionários"}),n.jsx(le,{value:"non-missionary",children:"Não missionários"})]})]})}),n.jsxs(xe,{children:[n.jsx(he,{asChild:!0,children:n.jsxs(B,{variant:"outline",size:"sm",className:"min-w-[140px]",children:["asc"===u?n.jsx(Ne,{className:"h-4 w-4 mr-1"}):n.jsx(Ue,{className:"h-4 w-4 mr-1"}),"name"===c&&"Nome","points"===c&&"Pontos","attendance"===c&&"Frequência","createdAt"===c&&"Data Cadastro","priority"===c&&"Prioridade"]})}),n.jsxs(pe,{align:"end",children:[n.jsxs(ge,{onClick:()=>{m("name"),x("asc")},children:[n.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Nome A-Z"]}),n.jsxs(ge,{onClick:()=>{m("name"),x("desc")},children:[n.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Nome Z-A"]}),n.jsxs(ge,{onClick:()=>{m("points"),x("desc")},children:[n.jsx(Z,{className:"h-4 w-4 mr-2"}),"Maior Pontuação"]}),n.jsxs(ge,{onClick:()=>{m("points"),x("asc")},children:[n.jsx(Z,{className:"h-4 w-4 mr-2"}),"Menor Pontuação"]}),n.jsxs(ge,{onClick:()=>{m("attendance"),x("desc")},children:[n.jsx(Je,{className:"h-4 w-4 mr-2"}),"Maior Frequência"]}),n.jsxs(ge,{onClick:()=>{m("attendance"),x("asc")},children:[n.jsx(Je,{className:"h-4 w-4 mr-2"}),"Menor Frequência"]}),n.jsxs(ge,{onClick:()=>{m("createdAt"),x("desc")},children:[n.jsx(Re,{className:"h-4 w-4 mr-2"}),"Mais Recentes"]}),n.jsxs(ge,{onClick:()=>{m("createdAt"),x("asc")},children:[n.jsx(Re,{className:"h-4 w-4 mr-2"}),"Mais Antigos"]}),n.jsxs(ge,{onClick:()=>{m("priority"),x("asc")},children:[n.jsx(Te,{className:"h-4 w-4 mr-2"}),"Prioridade (Alta → Baixa)"]})]})]})]})]}),n.jsxs("div",{className:"space-y-3",children:["missionary"===e?.role&&n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg border border-purple-200",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(X,{className:"h-4 w-4 text-purple-600"}),n.jsx("span",{className:"text-sm font-medium text-purple-800",children:"Visualizando apenas seus interessados vinculados"}),n.jsxs($,{variant:"secondary",className:"text-xs",children:[(Ve||[]).filter(e=>"active"===e.status).length," interessado",1!==(Ve||[]).filter(e=>"active"===e.status).length?"s":""]})]}),n.jsx("div",{className:"text-xs text-purple-600",children:"Para ver todos os interessados, solicite acesso ao administrador"})]}),v&&n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-blue-200",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Be,{className:"h-4 w-4 text-blue-600"}),n.jsxs("span",{className:"text-sm font-medium text-blue-800",children:["Mostrando usuários do ",Xe()]}),n.jsxs($,{variant:"secondary",className:"text-xs",children:[tt.length," usuário",1!==tt.length?"s":""]})]}),n.jsx(B,{variant:"outline",size:"sm",onClick:()=>Ge(null),className:"h-7 px-3 text-xs",children:"Ver Todos"})]}),tt.map(t=>n.jsx(js,{user:t,onClick:()=>(S(t),void A(!0)),onApprove:()=>{return e=t.id,void st.mutate(e);var e},onReject:()=>{return e=t.id,void at.mutate(e);var e},onEdit:()=>(S(t),void P(!0)),onDelete:()=>(V(t),void R(!0)),onView:()=>(S(t),void A(!0)),onScheduleVisit:()=>(S(t),void T(!0)),onMarkVisited:ct,onDisciple:()=>(ee(t),void Q(!0)),onDiscipleRequest:()=>(e=>{const t=Qe.find(t=>t.interestedId===e.id&&"pending"===t.status);t&&(Ee(t),ze(t.adminNotes||""),ke(!0))})(t),showActions:"admin"===e?.role,relationshipsData:Ve},t.id))]}),0===tt.length&&n.jsxs("div",{className:"text-center py-8","data-testid":"empty-state",children:[n.jsx(G,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Nenhum usuário encontrado"}),n.jsx("p",{className:"text-muted-foreground",children:"Tente ajustar os filtros de busca."})]}),n.jsx(bs,{user:k,isOpen:E,onClose:()=>A(!1),onUpdate:it}),n.jsx(Ns,{user:k,isOpen:z,onClose:()=>P(!1),onUpdate:it}),n.jsx(ys,{user:k,isOpen:O,onClose:()=>T(!1)}),n.jsx(Ys,{open:M,onOpenChange:R,children:n.jsxs(Zs,{children:[n.jsxs(Xs,{children:[n.jsx(ta,{children:"Confirmar exclusão"}),n.jsxs(sa,{children:['Tem certeza que deseja excluir o usuário "',q?.name,'"? Esta ação não pode ser desfeita.']})]}),n.jsxs(ea,{children:[n.jsx(ra,{children:"Cancelar"}),n.jsx(aa,{onClick:()=>{q&&ot.mutate(q.id)},className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})}),n.jsx(Ys,{open:K,onOpenChange:Q,children:n.jsxs(Zs,{children:[n.jsxs(Xs,{children:[n.jsx(ta,{children:"Solicitar Discipulado"}),n.jsxs(sa,{children:['Digite uma mensagem para solicitar o discipulado de "',H?.name,'". Esta solicitação será enviada para aprovação do administrador.']})]}),n.jsx("div",{className:"grid gap-4 py-4",children:n.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[n.jsx("label",{htmlFor:"disciple-message",className:"text-right text-sm font-medium",children:"Mensagem:"}),n.jsx("textarea",{id:"disciple-message",value:se,onChange:e=>ae(e.target.value),className:"col-span-3 min-h-[100px] p-3 border border-gray-300 rounded-md resize-none focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Digite sua mensagem de solicitação..."})]})}),n.jsxs(ea,{children:[n.jsx(ra,{children:"Cancelar"}),n.jsx(aa,{onClick:()=>{H&&se.trim()&&nt.mutate({userId:H.id,message:se.trim()})},disabled:!se.trim()||nt.isPending,className:"bg-blue-600 hover:bg-blue-700",children:nt.isPending?"Enviando...":"Enviar Solicitação"})]})]})}),De&&Se&&n.jsx(Ys,{open:De,onOpenChange:ke,children:n.jsxs(Zs,{children:[n.jsxs(Xs,{children:[n.jsx(ta,{children:"Autorizar Discipulado"}),n.jsx(sa,{children:"Aprove ou rejeite a solicitação de discipulado"})]}),n.jsx("div",{className:"grid gap-4 py-4",children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium text-muted-foreground",children:"Missionário:"}),n.jsx("div",{className:"font-medium",children:We.find(e=>e.id===Se.missionaryId)?.name||`Usuário ${Se.missionaryId}`})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium text-muted-foreground",children:"Interessado:"}),n.jsx("div",{className:"font-medium",children:We.find(e=>e.id===Se.interestedId)?.name||`Usuário ${Se.interestedId}`})]})]}),Se.notes&&n.jsxs("div",{children:[n.jsx("span",{className:"font-medium text-muted-foreground",children:"Observações do Missionário:"}),n.jsx("div",{className:"text-sm bg-muted/50 p-2 rounded mt-1",children:Se.notes})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Notas do Administrador:"}),n.jsx("textarea",{value:Ae,onChange:e=>ze(e.target.value),className:"w-full mt-1 p-2 border rounded-md",rows:3,placeholder:"Adicione observações sobre sua decisão..."})]})]})}),n.jsxs(ea,{children:[n.jsx(ra,{onClick:()=>ke(!1),children:"Cancelar"}),"approved"===Se.status&&n.jsx(aa,{onClick:()=>(async a=>{try{const r=Qe.filter(e=>e.interestedId===a&&"approved"===e.status);for(const t of r)(await fetch(`/api/discipleship-requests/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"rejected",adminNotes:"Discipulado desvinculado pelo administrador - solicitação rejeitada automaticamente",processedBy:e?.id||1})})).ok;if(!(await fetch(`/api/relationships/active/${a}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Erro ao remover discipulado");const i=["discipleship-requests","all-discipleship-requests","relationships","all-relationships","users","my-interested","user-relationships"];i.forEach(e=>{s.invalidateQueries({queryKey:[e]})}),["discipleship-requests","all-discipleship-requests","relationships","all-relationships"].forEach(e=>{s.refetchQueries({queryKey:[e]})}),await new Promise(e=>setTimeout(e,500)),i.forEach(e=>{s.invalidateQueries({queryKey:[e]})}),t({title:"✅ Discipulado removido!",description:`O relacionamento foi removido e ${r.length} solicitações foram rejeitadas automaticamente.`})}catch(r){t({title:"❌ Erro ao remover",description:r.message||"Não foi possível remover o discipulado.",variant:"destructive"})}})(Se.interestedId),className:"bg-orange-600 hover:bg-orange-700",children:"Remover Discipulado"}),n.jsx(aa,{onClick:()=>lt("rejected"),className:"bg-red-600 hover:bg-red-700",children:"Rejeitar"}),n.jsx(aa,{onClick:()=>lt("approved"),className:"bg-green-600 hover:bg-green-700",children:"Aprovar"})]})]})})]})})}ra.displayName=Qs.displayName;export{ia as default};
