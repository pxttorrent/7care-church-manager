import{c as a,i as e}from"./index-DtHhSAMi.js";import{r as t}from"./vendor-Ber6wfih.js";import{P as o}from"./pointsCalculator-BT49x4k-.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=a("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),i=()=>{const{user:a}=e(),[s,i]=t.useState(null),[r,n]=t.useState(!0),[c,u]=t.useState(null),[l,m]=t.useState(null);t.useEffect(()=>{(async()=>{try{const a=await fetch("/api/system/points-config");if(a.ok){const e=await a.json();m(e)}}catch(a){}})()},[]);const d=async()=>{var e,t,s,r,c;if(null==a?void 0:a.id)try{n(!0),u(null);const m=await fetch(`/api/users/${a.id}/points-details`);if(!m.ok)throw new Error(`Erro ao carregar dados de pontuação: ${m.status}`);const d=await m.json();if(d.userData||(d.userData={engajamento:"Baixo",classificacao:"A resgatar",dizimista:"Não dizimista",ofertante:"Não ofertante",tempoBatismo:0,cargos:[],nomeUnidade:null,temLicao:!1,comunhao:0,missao:0,estudoBiblico:0,totalPresenca:0,batizouAlguem:!1,discipuladoPosBatismo:0,cpfValido:!1,camposVaziosACMS:!1}),d.userData.actualPoints=d.points,l){const a=d.points,o={engajamento:d.userData.engajamento?d.userData.engajamento.toLowerCase().includes("baixo")?l.engajamento.baixo:d.userData.engajamento.toLowerCase().includes("médio")||d.userData.engajamento.toLowerCase().includes("medio")?l.engajamento.medio:d.userData.engajamento.toLowerCase().includes("alto")?l.engajamento.alto:0:0,classificacao:d.userData.classificacao?d.userData.classificacao.toLowerCase().includes("frequente")?l.classificacao.frequente:l.classificacao.naoFrequente:0,dizimista:d.userData.dizimista?d.userData.dizimista.toLowerCase().includes("não dizimista")||d.userData.dizimista.toLowerCase().includes("nao dizimista")?l.dizimista.naoDizimista:d.userData.dizimista.toLowerCase().includes("pontual")?l.dizimista.pontual:d.userData.dizimista.toLowerCase().includes("sazonal")?l.dizimista.sazonal:d.userData.dizimista.toLowerCase().includes("recorrente")?l.dizimista.recorrente:0:0,ofertante:d.userData.ofertante?d.userData.ofertante.toLowerCase().includes("não ofertante")||d.userData.ofertante.toLowerCase().includes("nao ofertante")?l.ofertante.naoOfertante:d.userData.ofertante.toLowerCase().includes("pontual")?l.ofertante.pontual:d.userData.ofertante.toLowerCase().includes("sazonal")?l.ofertante.sazonal:d.userData.ofertante.toLowerCase().includes("recorrente")?l.ofertante.recorrente:0:0,tempoBatismo:d.userData.tempoBatismo?d.userData.tempoBatismo>=2&&d.userData.tempoBatismo<5?l.tempoBatismo.doisAnos:d.userData.tempoBatismo>=5&&d.userData.tempoBatismo<10?l.tempoBatismo.cincoAnos:d.userData.tempoBatismo>=10&&d.userData.tempoBatismo<20?l.tempoBatismo.dezAnos:d.userData.tempoBatismo>=20&&d.userData.tempoBatismo<30?l.tempoBatismo.vinteAnos:d.userData.tempoBatismo>=30?l.tempoBatismo.maisVinte:0:0,cargos:d.userData.cargos&&d.userData.cargos.length>0?1===d.userData.cargos.length?l.cargos.umCargo:2===d.userData.cargos.length?l.cargos.doisCargos:l.cargos.tresOuMais:0,nomeUnidade:d.userData.nomeUnidade?l.nomeUnidade.comUnidade:0,temLicao:d.userData.temLicao?l.temLicao.comLicao:0,comunhao:(null==(e=d.userData.escolaSabatina)?void 0:e.comunhao)?d.userData.escolaSabatina.comunhao*l.escolaSabatina.comunhao:0,missao:(null==(t=d.userData.escolaSabatina)?void 0:t.missao)?d.userData.escolaSabatina.missao*l.escolaSabatina.missao:0,estudoBiblico:(null==(s=d.userData.escolaSabatina)?void 0:s.estudoBiblico)?d.userData.escolaSabatina.estudoBiblico*l.escolaSabatina.estudoBiblico:0,totalPresenca:void 0!==d.userData.totalPresenca?d.userData.totalPresenca>=0&&d.userData.totalPresenca<=3?l.totalPresenca.zeroATres:d.userData.totalPresenca>=4&&d.userData.totalPresenca<=7?l.totalPresenca.quatroASete:l.totalPresenca.oitoATreze:0,batizouAlguem:(null==(r=d.userData.escolaSabatina)?void 0:r.batizouAlguem)?l.escolaSabatina.batizouAlguem:0,discipuladoPosBatismo:(null==(c=d.userData.escolaSabatina)?void 0:c.discipuladoPosBatismo)?d.userData.escolaSabatina.discipuladoPosBatismo*l.escolaSabatina.discipuladoPosBatismo:0,cpfValido:d.userData.cpfValido?l.cpfValido.valido:0,camposVaziosACMS:!1===d.userData.camposVaziosACMS?l.camposVaziosACMS.completos:0};i({...d,breakdown:o,total:a}),d.userData.actualPoints=a}else{const{total:a,breakdown:e}=o.calculateDetailedPoints(d.userData);i({...d,breakdown:e,total:a}),d.userData.actualPoints=d.points}}catch(m){u(m instanceof Error?m.message:"Erro desconhecido")}finally{n(!1)}else n(!1)};t.useEffect(()=>{d()},[null==a?void 0:a.id,l]);return{data:s,isLoading:r,error:c,refetch:()=>{d()}}};export{s as A,i as u};
